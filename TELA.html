
<todasAsMusicas>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->

<musica>
	<nome>...</nome>
	<tom>C</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>72</tempo>
	<ritmo>1</ritmo>
	<url></url>
	<intro>

	</intro>
<cifra>

</cifra>
</musica>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<!-- -------------------------------------------------------------------------------------------------------------------------------- -->

<musica>
	<nome>Nada Além do Sangue</nome>
	<tom>C</tom>
	<rolagem>200</rolagem>
	<delay>0</delay>
	<tempo>72</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=8JOvwxAZ-zo</url>
	<intro>
C  Am7(11)  G  F9   C  F9/A  G
	</intro>
<cifra>
     C               Am7(11)         C
Teu sangue leva-me além a todas as alturas
                 Am7(11)
Onde ouço a tua voz
                G               F9
Fala de tua justiça pela minha vida
                     C     F9/A  G
Jesus, este é o teu sangue

      C               Am7(11)             C
Tua cruz mostra tua graça fala do amor do Pai
                  Am7(11)
Que prepara para nós
                G                      F9
Um caminho para Ele onde posso me achegar
              C     F9/A  G
Somente pelo sangue

--

  C
Que nos lava dos pecados
Am7(11)
E nos traz restauração
 G
Nada além do sangue
 F9                     C    F9/A  G
Nada além do sangue de Jesus

  C
Que nos faz brancos como a neve
  Am7(11)
Aceitos como amigos de Deus
 G
Nada além do sangue
 F9                     C    F9/A  G
Nada além do sangue de Jesus

C  F9/A  G

      C               Am7(11)             C
Tua cruz mostra tua graça fala do amor do Pai
                  Am7(11)
Que prepara para nós
                G                      F9
Um caminho para Ele onde posso me achegar
              C     F9/A  G
Somente pelo sangue

  C
Que nos lava dos pecados
Am7(11)
E nos traz restauração
 G
Nada além do sangue
 F9                     C    F9/A  G
Nada além do sangue de Jesus

  C
Que nos faz brancos como a neve
  Am7(11)
Aceitos como amigos de Deus
 G
Nada além do sangue
 F9                     C    F9/A  G
Nada além do sangue de Jesus

C
Eu sou livre
Am7(11)
Eu sou livre
 G
Nada além do sangue
 F9                     C    F9/A  G
Nada além do sangue de Jesus

C
Eu sou livre
Am7(11)
Eu sou livre
 G
Nada além do sangue
 F9                     C    F9/A  G
Nada além do sangue de Jesus
</cifra>
</musica>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->


<musica>
	<nome>Ele Continua Sendo Bom</nome>
	<tom>G</tom>
	<rolagem>200</rolagem>
	<delay>0</delay>
	<tempo>72</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=z1EaLRPXo7Q</url>
	<intro>
G  C  G  C
	</intro>
<cifra>
                  G                              C
Um dia a gente aprende a confiar em um Deus que faz milagres
                 Em7                    C
Que ouve a nossa oração, que se faz presente aqui
                  G                          C
Um dia a gente aprende a dar um passo só de cada vez
             Em7              C
Mas sem duvidar, mas sem duvidar

              G           G/F               C/E        Cm/Eb
Que Ele continua sendo bom,    que Ele continua sendo Deus
           G           G/F               C/E        Cm/Eb
Ele continua sendo bom,    que Ele continua sendo Deus

G  C  G  C
               G                       C
Então chega o dia de viver tudo que se aprendeu
         Em7                   C
E a enxergar até o que não se pode ver
             G                          C
Chega o dia de entender, até ouvir um "não" de Deus
             Em7              C
Mas sem duvidar, mas sem duvidar

            G  G/F          C/E    Cm/Eb
Que Ele cotinua    que Ele continua
         G           G/F               C/E        Cm/Eb
Ele continua sendo bom,    que Ele continua sendo Deus
         G           G/F               C/E        Cm/Eb
Ele continua sendo bom,    que Ele continua sendo Deus
          G           G/F               C/E        Cm/Eb
Ele continua sendo bom,    que Ele continua sendo Deus
</cifra>
</musica>


<!-- -------------------------------------------------------------------------------------------------------------------------------- -->



<musica>
	<nome>Porque Ele Vive</nome>
	<tom>A</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>95</tempo>
	<ritmo>1</ritmo>
	<url>https://youtu.be/jmqJxxGdtNQ</url>
	<intro>
A9   D
A9   E

	</intro>
<cifra>
A9          A9  E
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
          A9            E
Está nas mãos do meu Jesus
            A9
Que vivo está
--
                        D
Deus enviou seu Filho amado
         A9             Bm  E
Pra perdoar, pra me salvar
            A9            D
Na cruz morreu por meus pecados
Bm      A9/C#  F#m              E/G#    D
   Mas ressur_giu e vivo com o Pai está
--
            A9
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
Bm    A9/C#  F#m           E/G#
   Está nas mãos do meu Jesus
            G    E
Que vivo está

...
            A9            D
E quando enfim, chegar a hora
          A9            Bm  E
Em que a morte enfrentarei
             A9           D
Sem medo, então, terei vitória
Bm    A9/C#   F#m             E/G#
   Verei na Glória, ao meu Jesus
            D
Que vivo está
--
            A9
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
Bm    A/C#   F#m           E/G#
   Está nas mãos do meu Jesus
            G
Que vivo está
--
            A9
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
Bm    A/C#   F#m           E/G#
   Está nas mãos do meu Jesus
            D  A9/C#  A9
Que vivo está
</cifra>
</musica>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->





<musica>
	<nome>Tempos Melhores</nome>
	<tom>D</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>72</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=_WpLhbXcLQQ</url>
	<intro>
Bm  A/C#  G
	</intro>
<cifra>
 D
És o Deus deste lugar
              A/C#
O Rei deste povo
                 Bm
Senhor desta nação
    G
Tu és
--
 D
És a luz na escuridão
                   A/C#
Esperança ao perdido
             Bm
A paz ao cansado
    G
Tu és
--
 Bm     A           G
Não há outro igual a Ti
 Bm     A           G   A
Não há outro igual a Ti
--
 G
Tempos melhores estão por vir
 A                        D  A/C#  G
Obras maiores se farão neste lugar
 G
Tempos melhores estão por vir
 A                        D  A/C#  G
Obras maiores se farão neste lugar
--
 G
Tempos melhores estão por vir
 A                        D  A/C#  G
Obras maiores se farão neste lugar
 G
Tempos melhores estão por vir
 A
Obras maiores se farão aqui

</cifra>
</musica>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->

<musica>
	<nome>Me Derramar</nome>
	<tom>G</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>42</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=3gjtTVr4yfc&t=153s</url>
	<intro>
G  D/F#  Em  C
	</intro>
<cifra>
C      G    D/F#
Eis-me aqui outra vez
  Em                 C
Diante de Ti abro o meu coração
      G          D/F#
Meu clamor Tu escutas
   Em               C
E fazes cair as barreiras em mim
--
     G              D/F#
És fiel, Senhor, e dizes
   Em                   C
Palavras de amor e esperança sem fim
    G      D/F#
Ao sentir Teu toque
     Em             C
Por Tua bondade, libertas meu ser
      Am    Bm  Em
No calor deste lugar
--
D         G              D/F#
Eu venho me derramar, dizer que Te amo
 Em             C
Me derramar, dizer: Te preciso
 G              D/F#
Me derramar, dizer que sou grato
 Em             C
Me derramar, dizer que és formoso
--
G  D/F#  Em  C
--
       G    D/F#
Eis-me aqui outra vez
  Em                 C
Diante de Ti abro o meu coração
      G          D/F#
Meu clamor Tu escutas
   Em               C
E fazes cair as barreiras em mim
--
     G              D/F#
És fiel, Senhor, e dizes
   Em                   C
Palavras de amor e esperança sem fim
    G      D/F#
Ao sentir Teu toque
     Em             C
Por Tua bondade, libertas meu ser
      Am7    Bm7  C7M
No calor deste lugar
--
D         G              D/F#
Eu venho me derramar, dizer que Te amo
 Em             C
Me derramar, dizer: Te preciso
 G              D/F#
Me derramar, dizer que sou grato
 Em             C
Me derramar, dizer que és formoso
--
 G              D/F#
Me derramar, dizer que Te amo
 Em             C
Me derramar, dizer: Te preciso
 G              D/F#
Me derramar, dizer que sou grato
 Em             C
Me derramar, dizer que és formoso
</cifra>
</musica>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->


<musica>
	<nome>Ele É Exaltado</nome>
	<tom>D</tom>
	<rolagem>200</rolagem>
	<delay>0</delay>
	<tempo>56</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=22c5Flzd8Iw</url>
	<intro>
D D/F# G   G/B A/C# 
D D/F# G   A    G/B  A/C#  B/D# 
	</intro>
<cifra>
D                   
Ele é exaltado
   D/F#               G
O rei é exaltado nos céus
      G/B  A/C#
Eu o louva_rei
D                    D/F#             
Ele é exaltado, pra sempre exaltado
       G  A  G/B  A/C# B/D#
O seu no__me lou___va___rei

--

*Em  Em/D    A/C#
Ele é o Senhor
        D        D/F#      G
Sua verdade vai sempre reinar
 Em  Em/D  A/C#
Ter_ra e  céus
      D         D/C  B4  B/D#
Glorificam seu santo no__me
Em7        Em/D  
Ele é exaltado
   C        A        D   A7
O rei é exaltado nos céus

--

D                   
Ele é exaltado
   D/F#               G
O rei é exaltado nos céus
      G/B  A/C#
Eu o louva_rei
D                    D/F#             
Ele é exaltado, pra sempre exaltado
       G  A  G/B  A/C# B/D#
O seu no__me lou___va___rei

--

*Em  Em/D    A/C#
Ele é o Senhor
        D        D/F#      G
Sua verdade vai sempre reinar
 Em  Em/D  A/C#
Ter_ra e  céus
      D         D/C  B4  B/D#
Glorificam seu santo no__me
Em7        Em/D  
Ele é exaltado
   C        A        D   A7
O rei é exaltado nos céus

--

Em  Em/D    A/C#
Ele é o Senhor
        D        D/F#      G
Sua verdade vai sempre reinar
 Em  Em/D  A/C#
Ter_ra e  céus
      D         D/C  B4  B/D#
Glorificam seu santo no__me
Em7        Em/D  
Ele é exaltado
   C        A        D   A7
O rei é exaltado nos céus
</cifra>
</musica>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->







<musica>
	<nome>Meus Filhos São Teus</nome>
	<tom>C</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>92</tempo>
	<ritmo>2</ritmo>
	<url>https://www.youtube.com/watch?app=desktop&v=mfGkCMUKkOM</url>
	<intro>
C  Em7/B  F9/A  F9  F
	</intro>
<cifra>
C
Herança de Deus
F/C
Presente do céu
G/C          F/C
São meus filhos
C
Pedi ao Senhor
 Dm7
E Ele me ouviu
  C/E       Dm  C/E  F
Por eles clamo


F
Que ouçam tua voz
 C/E
Que amém tua voz
D7                 G4  G
E busquem sempre obedecer
 F
Que tenham em ti
C/E
O tesouro maior
D7                   G4
E vivam pra te engrandecer
       C
Sejam luz por onde andarem
   F7/E                 D7
Resplandecendo a luz do amor
       C
Sejam sal onde estiverem
   F7               D7
Trazendo o sabor de Deus
  F7/E          G    C  ( F )
Meus filhos   são teus


C
Herança de Deus
F/C
Presente do céu
G/C          F/C
São meus filhos
C
Pedi ao Senhor
Dm7
E Ele me ouviu
   C/E      Dm  C/E
Por eles clamo
F
Que ouçam tua voz
 C/E
Que amém tua voz
D7               G    C
E busquem sempre obedecer
 F
Que tenham em ti
C/E
O tesouro maior
D7                    G
E vivam pra te engrandecer
       C
Sejam luz por onde andarem
   F                D7
Resplandecendo a luz do amor
       C
Sejam sal sim onde estiverem
   F               D7
Trazendo o sabor de Deus
  F7/E          G    C
Meus filhos   são teus


F
Que tua graça os livre do mal
 Am
E o teu pão os sustente
    F                   G/F
Seus anseios estejam em ti
       Am7       G
Sim, em ti tão somente
    F        C/E      D7
Consagrados estão ao Senhor
F
Meus filhos

       C
Sejam luz por onde andarem
   F                D7
Resplandecendo a luz do amor
       C
Sejam sal onde estiverem
   F               D7
Trazendo o sabor de Deus
  F7/E     D7
Meus filhos
  F     D7
Meus filhos
  F      G         C  F  G
Meus filhos, são teus


  F    C
Sejam sal sim onde estiverem
   Dm        C/E   D7  E
Trazendo o sabor de Deus
   Am    C/G
Meus fi___lhos
F     Dm          C
Meus filhos, são teus

G  Em  F  C
</cifra>
</musica>

<!-- -------------------------------------------------------------------------------------------------------------------------------- -->


<musica>
	<nome>A Alegria Está No Coração</nome>
	<tom>C</tom>
	<rolagem>210</rolagem>
	<tempo>130</tempo>
	<ritmo>1</ritmo>
	<delay>10</delay>
	<url>https://www.youtube.com/watch?v=5drSCKZQjX4</url>
	<intro>
C F C F C D7 G
	</intro>
	<cifra>
C
A alegria está no coração
    F                  C   F
De quem já conhece a Jesus
C
A verdadeira paz só tem aquele
     D7             G
Que já conhece a Jesus
C                   C7
O sentimento mais precioso
     F               G#
Que vem do nosso Senhor
      C          G
É o amor que só tem quem
                C   F
Já conhece a Jesus
C
A alegria está no coração
     F                  C   F
De quem já conhece a Jesus
C
A verdadeira paz só tem aquele
     D7             G
Que já conhece a Jesus
C                   C7
O sentimento mais precioso
     F               G#
Que vem do nosso Senhor
      C          G
É o amor que só tem quem
                C   F
Já conhece a Jesus
--
         C
Posso pisar numa tropa
      C7
E saltar as muralhas
    F        G#
Aleluia! Aleluia!
--
         C
Posso pisar numa tropa
      C7
E saltar as muralhas
    F        G#
Aleluia! Aleluia!

--
  C                 C7
E Ele é a rocha da minha salvação
    F                G#
Com Ele não há mais condenação
         C
Posso pisar numa tropa
   G
E saltar as muralhas
    C          G
Aleluia! Aleluia!
--
    C        F  C
Aleluia! Alelui_a!
             D7  G
Aleluia! Alelui__a!
    C        F  C
Aleluia! Alelui_a!
             D7  G
Aleluia! Alelui__a!
--
C
O sentimento mais precioso
     F               G#
Que vem do nosso Senhor
      C          G
É o amor que só tem quem
                C  G
Já conhece a Jesus
--
      C          G
É o amor que só tem quem
                A# F
Já conhece a Jesus
      C          G
É o amor que só tem quem
                C
Já conhece a Jesus

    </cifra>
  </musica>



<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Bondade de Deus</nome>
	<tom>A</tom>
	<rolagem>210</rolagem>
	<delay>10</delay>
	<tempo>129</tempo>
	<ritmo>2</ritmo>
	<url>https://www.youtube.com/watch?v=b5DN9mPxMEI</url>
	<intro>
 A  A4  A  A4
	</intro>
	<cifra>
           A
Te amo, Deus

      D/A         A
Tua graça nunca falha

   E/G#   F#m7
Todos os dias
      D/A         E6
Eu estou em Tuas mãos
--
                   F#m7 D/C#
Desde quando me levanto
        A     E/G# F#m7
Até eu me deitar
         D/A       E6      *A
Eu cantarei da bondade de Deus
--
D/A                  A
      És fiel em todo tempo
D/A                      A        E6
      Em todo tempo Tu és tão, tão bom
D/A                      F#m7
      Com todo fôlego que tenho

         D/A     E6      A*
Eu cantarei da bondade de Deus
--
          A
Tua doce voz
         D/A          A
Que me guia em meio ao fogo
      E/G# F#m7
Na escuri_dão
        D/A       E6
Tua presença me conforta
--
                F#m7 D/C#
Sei que és meu Pai
      A   E/G# F#m7
Que amigo és
      D/A  E              *A
E eu vivo na bon_dade de Deus
--
D/A                  A
      És fiel em todo tempo
D/A                      A        E6
      Em todo tempo Tu és tão, tão bom
D/A                      F#m7
      Com todo fôlego que tenho
         D/A     E6      A
Eu cantarei da bondade de Deus

A9  A  A4   A
--
A/C#                D/C#
    Tua bondade me seguirá
    E6         A
Me seguirá Senhor
A/C#                D/C#
    Tua bondade me seguirá
    E6         A
Me seguirá Senhor
--
       A/C#           D/C#
Eu me rendo a Ti, te dou o meu ser
    E6          F#m7
Entrego tudo a Ti
A/C#                D/C#
    Tua bondade me seguirá
    E6         A
Me seguirá Senhor
--
D/A                  A
      És fiel em todo tempo
D/A                      A        E6
      Em todo tempo Tu és tão, tão bom
D/A                      F#m7
      Com todo fôlego que tenho
         D/A     E6      A
Eu cantarei da bondade de Deus
         D/A     E6      A*
Eu cantarei da bondade de Deus
</cifra>
</musica>


<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Grande É o Senhor</nome>
	<tom>D</tom>
	<rolagem>190</rolagem>
	<delay>23</delay>
	<tempo>120</tempo>
	<ritmo>2</ritmo>
	<url>https://www.youtube.com/watch?v=6OnuqNFeGUY</url>
	<intro>
D  D/C#       G7M        D/F#   Em7  A
	</intro>
	<cifra>
  D
Grande
       G/D
é o Senhor
                   D
E mui digno de louvor
--
      G/D
Na cidade do nosso Deus
     A/C#  Bm7
Seu Santo monte

 D
 Alegria de toda

 Em7  F#m7 G7M  A4
 ter - ra - a - a
 --

  D
Grande
       G/D
é o Senhor
                       D
Em quem nós temos a vitória
       G/D
E que nos ajuda
             Bm
Contra o inimigo
--
        D9
    Por isso diante dele nos

       Em7  F#m7 G7M  A4
 prostramos
 --
    D
Queremos o Teu
             D/C#
Nome engrandecer
G7M
E agradecer-Te
D/F#      Em7             A
Por Tua obra em nossas vidas
--
     D
Confiamos em Teu
           D/C#
Infinito amor
      G7M                D/F#
Pois só Tu és o Deus eterno

Em7        A4
Sobre toda terra e céus
--

  D
Grande
       G/D
é o Senhor
                       D
Em quem nós temos a vitória
--
       G/D
E que nos ajuda
             Bm
Contra o inimigo
--
        D9
    Por isso diante dele nos

       Em7  F#m7 G7M  A4
 prostramos
--


    D
Queremos o Teu
            D/C#
Nome engrandecer



G7M
E agradecer-Te
D/F#        Em7             A4
    Por Tua obra em nossas vidas
--
     D
Confiamos em Teu
           D/C#
Infinito amor

      G7M                 D/F#
Pois só Tu és o Deus eterno
 Em7        A4
Sobre toda terra
--
    D
Queremos o Teu
            D/C#
Nome engrandecer

G7M
E agradecer-Te
D/F#        Em7             A4
    Por Tua obra em nossas vidas
--
     D
Confiamos em Teu
           D/C#
Infinito amor

      G7M                 D/F#
Pois só Tu és o Deus eterno

 Em7        A4      D9
Sobre toda terra e céus


	</cifra>
</musica>




<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Rompendo em Fé</nome>
	<tom>D</tom>
	<rolagem>238</rolagem>
	<delay>22</delay>
	<tempo>128</tempo>
	<ritmo>2</ritmo>
	<url>https://www.youtube.com/watch?v=fRsTowW3TSA</url>
	<intro>
D  G     A  D
Bm  F#m7    Em7  A  A4
	</intro>
<cifra>
      D                       G
Cada vez que a minha fé é provada
       A                          D
Tu me dás a chance de crescer um pouco mais
       Bm              F#m7
As montanhas e vales desertos e mares
         Em7                A        A4  A
Que atravesso me levam pra perto de Ti
--
         D                  D/F#   Em7
Minhas provações não são maiores que o meu Deus
       A                      D
E não vão me impedir de caminhar
      Em7     A            F#7   Bm
Se diante de mim não se abrir o mar
          Em7        A               D
Deus vai me fazer andar por sobre as águas
--
 D4          D  D/F#
Rompendo em fé
       G         A          D
Minha vida se revestirá do Teu poder
 D4          D  D5(9/11)
Rompendo em fé
         G         A           Bm
Com ousadia vou mover o sobrenatural
--
 Bm  A/C#  G/B     D
Vou  lu____tar e vencer
         G        Bm
Vou plantar e colher
        Em7       A
A cada dia vou viver
             D  D4  D  D4
Rompendo em fé
--
      D                       G
Cada vez que a minha fé é provada
       A                          D
Tu me dás a chance de crescer um pouco mais
       Bm              F#m7
As montanhas e vales desertos e mares
         Em7                A        A4  A
Que atravesso me levam pra perto de Ti
--
         D                  D/F#   Em7
Minhas provações não são maiores que o meu Deus
       A                      D
E não vão me impedir de caminhar
      Em7     A            F#7   Bm
Se diante de mim não se abrir o mar
          Em7        A               D
Deus vai me fazer andar por sobre as águas
--
 D4          D  D/F#
Rompendo em fé
       G         A          D
Minha vida se revestirá do Teu poder
 D4          D  D5(9/11)
Rompendo em fé
         G         A           Bm
Com ousadia vou mover o sobrenatural
--
 Bm  A/C#  G/B     D
Vou  lu____tar e vencer
         G        Bm
Vou plantar e colher
        Em7       A
A cada dia vou viver
             D  D4  D  D4
Rompendo em fé
--
        Em7       A
A cada dia vou viver
             D  D4  D  D4
Rompendo em fé

</cifra>
</musica>



<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Eu Vejo a Glória</nome>
	<tom>C</tom>
	<rolagem>180</rolagem>
	<delay>0</delay>
	<tempo>107</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=qZjzUUv7zCY</url>
	<intro>
D  G  Bm  A
	</intro>
<cifra>
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
--
D  G  Bm  A
--
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
</cifra>
</musica>




<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Te Agradeço</nome>
	<tom>A</tom>
	<rolagem>220</rolagem>
	<delay>0</delay>
	<tempo>100</tempo>
	<ritmo>2</ritmo>
	<url>https://www.youtube.com/watch?v=q9_gM6rUdf0</url>
	<intro>
D  A2  D  A2
	</intro>
<cifra>
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
        D
Te agradeço
        A2
Meu Senhor
        D
Te agradeço
        A2
Meu Senhor
--
        A2                       A/G
Te agradeço por me libertar e salvar
 D/F#               D#º
Por ter morrido em meu lugar
--
        A2  A/C#  D
Te agrade___ço
               A2  A/C#  D
Jesus, te agrade___ço
           A2  A/C#  D
Eu te agrade___ço
        Bm   A2
Te agrade___ço

--
( D  A2 )
--
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
        D
Te agradeço
        A2
Meu Senhor
        D
Te agradeço
        A2
Meu Senhor
--
        A2                       A/G
Te agradeço por me libertar e salvar
 D/F#               D#º
Por ter morrido em meu lugar
--
        A2  A/C#  D
Te agrade___ço
               A2  A/C#  D
Jesus, te agrade___ço
           A2  A/C#  D
Eu te agrade___ço
        Bm   A2
Te agrade___ço

--
        A2                       A/G
Te agradeço por me libertar e salvar
 D/F#               D#º
Por ter morrido em meu lugar
--
        A2  A/C#  D
Te agrade___ço
               A2  A/C#  D
Jesus, te agrade___ço
           A2  A/C#  D
Eu te agrade___ço
        Bm   A2
Te agrade___ço
--
        Bm   A2
Te agrade___ço
        Bm   A2

Te agrade___ço
        Bm   A2

Te agradeeeee___ço

</cifra>
</musica>



<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Fico Feliz Em Vir Em Tua Casa</nome>
	<tom>G</tom>
	<rolagem>150</rolagem>
	<delay>8</delay>
	<tempo>130</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=wp2V6B-hAO0</url>
	<intro>
G C G D
G C G D G
	</intro>
<cifra>
G              C                 G                  D
Fico feliz em vir em Tua casa, erguer minha voz e cantar
G              C                 G          D            G
Fico feliz em vir em Tua casa, erguer minhas mãos e adorar
G              C                 G                  D
Fico feliz em vir em Tua casa, erguer minha voz e cantar
G              C                 G          D            G
Fico feliz em vir em Tua casa, erguer minhas mãos e adorar
--
G                        C  G                    D
Bendito é o nome do Senhor bendito é o nome do Senhor
G                       C       D   G   D
Bendito é o nome do Senhor pra sempre
G                        C  G                    D
Bendito é o nome do Senhor. bendito é o nome do Senhor
G                       C       D   G
Bendito é o nome do Senhor pra sempre
C       D   G
   Pra sempre
--
G              C                 G                  D
Fico feliz em vir em Tua casa, erguer minha voz e cantar
G              C                 G          D            G
Fico feliz em vir em Tua casa, erguer minhas mãos e adorar
G              C                 G                  D
Fico feliz em vir em Tua casa, erguer minha voz e cantar
G              C                 G          D            G
Fico feliz em vir em Tua casa, erguer minhas mãos e adorar
--
G                        C  G                    D
Bendito é o nome do Senhor bendito é o nome do Senhor
G                       C       D   G   D
Bendito é o nome do Senhor pra sempre
G                        C  G                    D
Bendito é o nome do Senhor. bendito é o nome do Senhor
G                       C       D   G
Bendito é o nome do Senhor pra sempre
C       D   G
   Pra sempre

</cifra>
</musica>



<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Deus Está Aqui</nome>
	<tom>C</tom>
	<rolagem>210</rolagem>
	<delay>10</delay>
	<tempo>125</tempo>
	<ritmo>2</ritmo>
	<url>https://www.youtube.com/watch?v=zB4MctMDETI</url>
	<intro>
C  F/C  G/C  F/C
	</intro>
<cifra>
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C4
Tão certo como eu te falo e podes me ouvir
--
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C4
Tão certo como eu te falo e podes me ouvir
--
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C
Tão certo como eu te falo e podes me ouvir
--
     F                G/F
Tão certo como eu te falo
     E7              Am7
Tão certo como eu te falo
     Dm7              G               C4
Tão certo como eu te falo podes me ouvir
--
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C
Tão certo como eu te falo e podes me ouvir
--
     F                G/F
Tão certo como eu te falo
     E7              Am7
Tão certo como eu te falo
     Dm7              G               C4
Tão certo como eu te falo podes me ouvir
</cifra>
</musica>




<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Tua É a Glória</nome>
	<tom>C</tom>
	<rolagem>210</rolagem>
	<delay>0</delay>
	<tempo>54</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=UJKNjAjMf44</url>
	<intro>
C  Am7  F C G
	</intro>
<cifra>
C9      Am7          F7/E
Tua é a glória e o poder
            C      G
Tu és pra sempre Rei
C9           Am7         F7/E        F/G
Honra e majestade estão diante do Senhor
     Am         Am7/G#          Am7/G      D/F#
Não existe nenhum Deus que seja   digno como Tu
      F         C/E
Nada vai me separar de Ti
   Dm7             G
Tu  és  a própria vida em mim
--
C  Am7  F
--

C9      Am7          F7/E
Tua é a glória e o poder
            C      G
Tu és pra sempre Rei
C9           Am7         F7/E        G
Honra e majestade estão diante do Senhor
     Am         Am7/G#          Am7/G      D/F#
Não existe nenhum Deus que seja   digno como Tu
     Dm7/E   C/E
Nada vai me separar de Ti
     F              *G
Tu  és  a própria vida em mim
--
C9
Não deixarei de te louvar
Am7
Não deixarei de te buscar
        F           C/E
És a razão da minha  vi-da
Dm7             F/G
Vi-vo pra te exaltar
--
C9
Não deixarei de te louvar
Am7
Não deixarei de te buscar
        F           C/E
És a razão da minha  vi-da
Dm7           F/G
Vivo pra te adorar
--
C  Am7  F
--
D9
Não deixarei de te louvar
Bm7
Não deixarei de te buscar
        G           D/F#
És a razão da minha  vi-da
Em7             G/A
Vi-vo pra te exaltar
--
D9
Não deixarei de te louvar
Bm7
Não deixarei de te buscar
        G           D/F#
És a razão da minha  vi-da
Em7           G/A*
Vivo pra te adorar
</cifra>
</musica>


<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Amigo de Deus</nome>
	<tom>C</tom>
	<rolagem>180</rolagem>
	<delay>0</delay>
	<tempo>83</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=hIrw_wRXAfk</url>
	<intro>
C  G/B  Am  Dm  C  G
	</intro>
<cifra>
      C     G/B       Am
Não existe nada melhor
        C    G/B       F
Do que ser amigo de Deus
      Am    G       D/F#
Caminhar seguro na luz
       Am     G/B   C
Desfrutar do seu   amor
--
       Dm     C   G/B
Ter a paz no coração
       Dm        C    G/B
Viver sempre em comunhão
     F       G
E assim perceber
       C    C/E  F
A grandeza do  poder
      C/G      G
De Jesus, meu Bom Pastor
--
C  G/B  Am  Dm  C  G
--

      C     G/B       Am
Não existe nada melhor
        C    G/B       F
Do que ser amigo de Deus
      Am    G       D/F#
Caminhar seguro na luz
       Am     G/B   C
Desfrutar do seu   amor
--
       Dm     C   G/B
Ter a paz no coração
       Dm        C    G/B
Viver sempre em comunhão
     F       G
E assim perceber
       C    C/E  F
A grandeza do  poder
      C/G      G      C  F/C  C
De Jesus, meu Bom Pastor
--
       Dm     C   G/B
Ter a paz no coração
       Dm        C    G/B
Viver sempre em comunhão
     F       G
E assim perceber
       C    C/E  F
A grandeza do  poder
--
      C/G      G      C  F/C  C
De Jesus, meu Bom Pastor
      C/G      G      F
De Jesus, meu Bom Pastor

--
C  G/B  Am  Dm  C  G
--
</cifra>
</musica>


<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Cantarei Teu Amor Pra Sempre</nome>
	<tom>C</tom>
	<rolagem>142</rolagem>
	<delay>8</delay>
	<tempo>97</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=3JUS_ueGjnA</url>
	<intro>
C  Dm7  F9  G    C
	</intro>
<cifra>
C
   Dos montes corre para o mar
Dm7
    Teu rio de amor por mim
F9                                  G
    Eu abrirei meu coração
                                     C
deixando Tua cura entrar
--
C
    Me alegro por te pertencer
Dm7
     Levantarei as minhas mãos
F9
     O Teu amor me alcança
G
     E me faz louvar-Te
--
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
--
 C  Dm7  F9  G
--
C
   Dos montes corre para o mar
Dm7
    Teu rio de amor por mim
F9                                  G
    Eu abrirei meu coração
                                     C
deixando Tua cura entrar
--
C
    Me alegro por te pertencer
Dm7
     Levantarei as minhas mãos
F9
     O Teu amor me alcança
G
     E me faz louvar-Te
--
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
--
Dm7                   C/E
     Meu coração exulta
F9                         G
     De alegria eu canto
Dm7                             C/E
      Se o mundo conhecer a Ti
      F9                        G
Ele se encherá com Tua alegria
--
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
--
 C  Dm7  F9  G
</cifra>
</musica>


<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Quão Grande É o Meu Deus</nome>
	<tom>D</tom>
	<rolagem>230</rolagem>
	<delay>15</delay>
	<tempo>75</tempo>
	<ritmo>1</ritmo>
	<url>https://www.youtube.com/watch?v=4LofSg56V8Y</url>
	<intro>
D  Bm7  G9  A5  D  G/A
	</intro>
<cifra>
       D
Quão grande é o meu Deus
      A/C#  Bm7
Cantarei  quão grande é o meu Deus
         Bm/A   G9
E todos hão de ver
       G/A           D   G/A
Quão grande é o meu Deus
--
    D
Com esplendor de um Rei
    Bm7
Em majestade e luz
                    G9
Faz a Terra se alegrar

Faz a Terra se alegrar
--
D
Ele é a própria luz
       Bm7
E as trevas vão fugir
                G9
Tremer com sua voz
                G/A
Tremer com sua voz
--
       D
Quão grande é o meu Deus
      A/C#  Bm7
Cantarei  quão grande é o meu Deus
         Bm/A   G9
E todos hão de ver
       G/A           D   G/A
Quão grande é o meu Deus
--
     D
Por gerações Ele é
   Bm7
O tempo está em tuas mãos
              G9
O começo e o fim
             G/A
O começo e o fim
--
  D
Três se formam em um
 Bm7
Filho, Espírito e Pai
             G9
Cordeiro e leão
             G/A
Cordeiro e leão
--
       D
Quão grande é o meu Deus
      A/C#  Bm7
Cantarei  quão grande é o meu Deus
         Bm/A   G9
E todos hão de ver
       G/A           D   G/A
Quão grande é o meu Deus
--
       D
Sobre todo nome é o seu
       Bm7
Tu és digno do louvor
    G9             G/A           D
Eu cantarei quão grande é o meu Deus
         Ab/Bb
É o meu Deus

</cifra>
</musica>


<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Em Jesus Amigo Temos</nome>
	<tom>G</tom>
	<rolagem>240</rolagem>
	<delay>0</delay>
	<tempo>115</tempo>
	<ritmo>2</ritmo>
	<url>https://www.youtube.com/watch?v=0qhLIyogXuk</url>
	<intro>
G  G7  C  A  G  Em  Am  D  G  G
	</intro>
<cifra>
G   G7       C   C9/C#
Em Jesus amigo te..mos
G   D/F#   Em           Am    D
Mais chegado que um irmão

G  G7         C   C9/C#
Ele manda que levemos
G      Em Am     D   G
Tudo a   Deus em oração
--
D      D7          G   G7
Oh! que paz perdemos sempre
C       G/B      Am  D
Oh! que dor no coração
G    G7           C   C9/C#
Só porque nós não leva..mos
G   Em  Am     D   G
Tu - do a Deus em ora..ção.
--
G    G7       C   C9/C#
Temos lidas e pesa..res
G D/F#   Em       Am D
E    na   vida tentação
G    G7          C    C9/C#
Não ficamos sem confor..to
G Em   Am       D G
Indo   a Cristo em oração
--
D  D7          G  G7
Haverá um outro ami..go
C      G/B        Am   D
De tão grande compaixão?
G    G7           C   C9/C#
Os contritos, Jesus Cristo
G   Em   Am      D    G
sem - pre atende em ora..ção
--
G   G7        C   C9/C#
E se nós desfalece..mos
G  D/F#    Em         Am   D
Cris - to estende-nos a mão
G     G7            C     C9/C#
Pois é sempre a nossa for...ça
G Em  Am      D G
E     refúgio em oração
--
D      D7          G   G7
Se este mundo nos despre..za
C        G/B       Am   D
Cristo é nosso em oração
G      G7         C   C9/C#
Em Seus braços nos aco..lhe
G Em  Am    D  G
E    nos dá consolação
--
--
</cifra>
</musica>



<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Vim Para Adorar-Te</nome>
	<tom>C</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>72</tempo>
	<ritmo>1</ritmo>
	<url>https://youtu.be/-4AAHPM98Do?feature=shared</url>
	<intro>
 C  G  Dm  F
	</intro>
<cifra>
 C      G
Luz do mundo
  Dm       F
Viestes à Terra
  C           G
Pra que eu pudesse
 F
Te ver
--
 C     G
Tua beleza me
 Dm        F
Leva a adorar-te
  C       G
Quero contigo
 F
Viver
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim
--
C       G
Eterno rei
     Dm         F
Exaltado nas alturas
  C  G    F
Glorioso nos céus
--
   C      G
Humilde vieste
   Dm         F
À Terra que criaste
 C        G
Por amor pobre
 F
Se fez
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim
--
    G     Am  F
Eu nunca saberei o preço
F      G     Am    F
Dos meus pecados lá na cruz

    G     Am  F
Eu nunca saberei o preço
F      G     Am    F
Dos meus pecados lá na cruz
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim

</cifra>
</musica>



<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Senhor, Te Quero</nome>
	<tom>C</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>144</tempo>
	<ritmo>1</ritmo>
	<url>https://youtu.be/JMV-K0d1QYQ?feature=shared</url>
	<intro>
C  F9  Am  G9  F9
	</intro>
<cifra>
C                            F
 Eu te busco, te procuro óh Deus
Am            G    F
 No silêncio tu estás
C                          F
 Eu te busco, toda hora espero em ti, revela-te a mim
Am                G    F
 Conhecer-te eu quero mais
--
C            G
 Senhor te quero
Am        F
 Quero ouvir tua voz
C             G    F
 Senhor, te quero mais
--
C         G
 Quero tocar-te
Am             F
 Tua face eu quero ver
C             G    F
 Senhor, te quero mais
--
C                              F
 Prosseguindo, para o alvo eu vou
Am        G      F
 A coroa conquistar
C                        F
 Vou lutando, nada pode me impedir, eu vou te seguir
Am                G    F
 Conhecer-te eu quero mais
--
C            G
 Senhor te quero
Am        F
 Quero ouvir tua voz
C             G    F
 Senhor, te quero mais
--
C         G
 Quero tocar-te
Am             F
 Tua face eu quero ver
C             G    F
 Senhor, te quero mais
--
G  F  C
--
C                              F
 Prosseguindo, para o alvo eu vou
Am        G      F
 A coroa conquistar
C                        F
 Vou lutando, nada pode me impedir, eu vou te seguir
Am                G    F
 Conhecer-te eu quero mais
--
C            G9
 Senhor te quero
Am        F
 Quero ouvir tua voz
C             G    F
 Senhor, te quero mais
--
C         G9
 Quero tocar-te
Am             F
 Tua face eu quero ver
C             G    F
 Senhor, te quero mais
</cifra>
</musica>




<!-- -------------------------------------------------------------------------------------------------------------------------------- -->
<musica>
	<nome>Poder para Salvar</nome>
	<tom>C</tom>
	<rolagem>200</rolagem>
	<delay>10</delay>
	<tempo>149</tempo>
	<ritmo>2</ritmo>
	<url>https://youtu.be/gDH0tT730UA?feature=shared</url>
	<intro>
C   G  F   C   Am7   G7
	</intro>
<cifra>
F2            C                   Am7
  Todos necessitam de um amor perfeito
   G          F
Perdão e compaixão
            C                    Am7
Todos necessitam de graça e esperança
      G          F  G  F  G
De um Deus que salva
--
C                 G
Cristo move as montanhas
        F           C
E tem poder pra salvar
      Am7        G4
Tem poder pra salvar
--
    C                     G
Pra sempre, Autor da salvação
        F         C
Jesus a morte venceu
        Am7      G
Sobre a morte venceu
--
C/F                     C9                C9/A
   Me aceitas com meus medos, falhas e temores
C2/G         C2/F
Enche meu viver
                 C2
A minha vida entrego
                 C2/A    C2/G      F  G  F  G
Pra seguir teus passos, a ti me rendo ooooo
--
C                 G
Cristo move as montanhas
        F           C
E tem poder pra salvar
      Am7        G
Tem poder pra salvar
--
    C                     G
Pra sempre, Autor da salvação
        F         C
Jesus a morte venceu
        Am7      G
Sobre a morte venceu
--
F            C              G
 Possa o mundo ver brilhar a luz
   Am  F            C            G    Am  F
Cantamos para a glória do Senhor Jesus Cristo
            C              G
Possa o mundo ver brilhar a luz
   Am  F            C            G
Cantamos para a glória do Senhor Jesus
--
C                 G
Cristo move as montanhas
        F           C
E tem poder pra salvar
      Am7        G
Tem poder pra salvar
--
    C                     G
Pra sempre, Autor da salvação
        F         C
Jesus a morte venceu
        Am7      G4
Sobre a morte venceu

</cifra>
</musica>




<!-- -------------------------------------------------------------------------------------------------------------------------------- -->




</todasAsMusicas>









<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>MANUAL</title>
  <style>
    body {
      margin: 0;
      background-color: black;
      color: white;
      font-family: 'Arial', sans-serif;
      overflow: hidden;
    }

    #layout {
      display: flex;
      height: 100vh;
      width: 100vw;
    }

    #colunaEsquerda {
      width: 450px;
      background-color: #111;
      padding: 5px;
      box-sizing: border-box;
      border-right: 1px solid #666;
      overflow-y: auto;
      margin-top: 20px;
    }

    #colunaDireita {
      flex: 1;
      position: relative;
    }

    #container {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 50px 10px 10px 30px;
      box-sizing: border-box;
    }

    #letraWrapper {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

	/* Cobertura de foco (vignette) */
	#letraWrapper .focus-overlay {
	  position: absolute;
	  inset: 0;             /* cobre 100% do wrapper */
	  pointer-events: none; /* não intercepta cliques/scroll */
	  z-index: 5;

	  /* Gradiente: escuro em cima/baixo, transparente no centro */
	  background: linear-gradient(
		to bottom,
		rgba(0,0,0,0.90) 0%,
		rgba(0,0,0,0.60) 10%,
		rgba(0,0,0,0.20) 20%,
		rgba(0,0,0,0.00) 30%,
		rgba(0,0,0,0.10) 40%,
		rgba(0,0,0,0.30) 50%,
		rgba(0,0,0,0.50) 60%,
		rgba(0,0,0,0.70) 70%,
		rgba(0,0,0,0.80) 80%,
		rgba(0,0,0,0.90) 90%,
		rgba(0,0,0,1.00) 100%
	  );
	}

	#letra {
	  position: absolute;
	  top: 100%;
	  //white-space: pre-wrap;   /* mantém quebras de linha e múltiplos espaços */
	  text-align: left;
	  font-size: 2em;
	  line-height: 1.5em;
	  font-family: 'Courier New', monospace;
	}

    .tituloMusica {
      font-size: 1.25em;
      font-weight: bold;
      text-align: left;
      margin-bottom: 0.5em;
    }

    .introTexto {
      text-align: left;
      color:#666;
    }

	.cifraTexto .acorde{
	  display: inline-block;
	  color: #666;
	  line-height: 1.2em;
	  white-space: pre;
	  //display: block;
	  //font-family: 'Courier New', monospace;
	}

    .musica-option {
      margin-bottom: 10px;
      margin-left: -15px;
      display: flex;
      align-items: left;
      gap: 0px;
    }

    .ordem {
      display: inline-block;
      width: 20px;
      text-align: right;
      color: #0f0;
    }

    #playButton {
      font-size: 12px;
      padding: 4px 12px;
      //margin-bottom: 20px;
      cursor: pointer;
      color: #383d41;
      background-color: #e2e3e5;
      //border-color: #d6d8db;
      //border-radius: 20px;
    }

    #contadorDelay {
      font-size: 1.5em;
      color: #666;
      text-align: left;
      margin-bottom: 0.5em;
    }

    musica {
      display: none;
    }

    .acorde {
      color: #666;
	  line-height: 1.2em;
    }
    .delaySelect{
      margin: 1px 0px 15px 9px;
      padding: 5px 15px 5px 15px;
      border-radius: 6px;
      color: #383d41;
      background-color: #e2e3e5;
      border-color: #d6d8db;
    }

    #toggleMenu {
      position: fixed;
      top: 0px;
      left: 10px;
      background-color: #222;
      color: #666;
      border: none;
      padding: 0px 20px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.6;
    }

    #toggleMenu:hover {
      opacity: 1;
    }

    #bpmlink {
      position: fixed;
      top: 0px;
      left: 70px;
      background-color: #222;
      color: #666;
      border: none;
      padding: 0px 20px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.6;
    }

    #timeRolagem {
      position: fixed;
      top: 0px;
      left: 140px;
      background-color: #222;
      color: #666;
      border: none;
      padding: 0px 20px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.6;
    }


    #divtranspor {
      position: fixed;
      top: 0px;
      left: 210px;
      background-color: #222;
      color: #666;
      border: none;
      padding: 0px 20px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.6;
    }

    #divManual {
      position: fixed;
      top: 0px;
      left: 285px;
      background-color: #222;
      color: #666;
      border: none;
      padding: 0px 10px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.6;
    }

    #divPlay {
      position: fixed;
      top: 0px;
      left: 370px;
      background-color: #222;
      color: #666;
      border: none;
      padding: 0px 10px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.6;
    }

    #divTeoria {
      position: fixed;
      top: 3px;
      left: 440px;
      background-color: #222;
      color: #666;
      border: none;
      padding: 0px 10px;
      font-size: 16px;
      cursor: pointer;
      z-index: 9999;
      opacity: 0.6;
    }

    .oculto #colunaEsquerda {
      display: none;
    }
    .oculto #colunaDireita {
      width: 100vw;
    }

    #timerTotal{
      margin: 4px 5px 5px 10px;
    }

	.fimMusica{
	  text-align:center;
	  color:#888;
	  font-size:1.2em;
	  letter-spacing:2px;
	  margin-top:6px;
	}


	.bolinha {
	  display: inline-block;
	  width: 5px;
	  height: 5px;
	  margin: 2px 6px;
	  background-color: #1e90ff; /* azul */
	  border-radius: 50%;
	}

	.bolinha.verde {
		background-color: #28a745;
		margin-left: -4px
	}

  .proximoAcorde {
    display: block;
    margin-top: -70px;
    font-size: 0.9em;
    color: #888;
    text-align: right;
  }

	#indicadorSlides {
	  position: fixed;
	  top: 15px;
	  right: 15px;
	  display: flex;
	  gap: 6px;
	  z-index: 9999;
	}

	.bolinhaSlide {
	  width: 10px;
	  height: 10px;
	  border: 1px solid #666;
	  border-radius: 50%;
	  background-color: transparent;
	}

	.bolinhaSlide.ativa {
	  background-color: #666;
	}

	#teoria{
		position: relative;
		top:0px;
	}


	#batidaVisual{
		justify-self: right;
		position: relative;
		z-index: 10;
	}

	.bolaBatida{

		width: 30px;
		height: 30px;
		border-radius: 50%;
		margin: 0px 15px 15px 15px;
		opacity: 0.25;
	}
	#bola1{background-color: limegreen;}
	#bola2{background-color: limegreen;}
	#bola3{background-color: limegreen;}
	#bola4{background-color: greenyellow;}
	#bola5{background-color: tomato;}







/* Faixa de destaque central que tinge o texto */
#letraWrapper .color-overlay {
  position: absolute;
  inset: 0;                 /* cobre 100% do wrapper */
  pointer-events: none;     /* não intercepta cliques/scroll */
  z-index: 6;               /* acima do texto (#letra) e da focus-overlay */
  /* Gradiente vertical: transparente → amarelo (centro) → transparente */
  background: linear-gradient(
    to bottom,
    rgba(255,255,255,0.0) 0%,
	rgba(255,255,255,0.1) 10%,
	rgba(255,255,000,0.8) 20%,
	rgba(255,255,000,1.0) 30%,
	rgba(255,255,000,0.5) 40%,
	rgba(255,255,000,0.4) 50%,
	rgba(255,255,255,0.3) 60%,
    rgba(255,255,255,0.2) 70%,
    rgba(255,255,255,0.1) 80%,
	rgba(255,255,255,0.1) 90%,
    rgba(255,255,255,0.0) 100%
  );
  /* Este truque tinge o que está por baixo (texto branco fica amarelo) */
  mix-blend-mode: multiply;
}



/* linha destacada (verde) */
.cifra-linha.destacada {
  color: #00e676;
  font-weight: 600;
}

/* opcional: melhora a legibilidade ao centralizar */
.cifra-linha {
  transition: color 160ms ease;
}


.introTexto .acorde-intro {
  color: #aaa;
  margin: 0 4px;
}
.introTexto .acorde-intro.destacado {
  color: #00e676;
  font-weight: bold;
}




  </style>
</head>
<body>
  <div>
    <button id="toggleMenu" title="Mostrar/Ocultar painel">...</button>
	<a id='bpmlink' target=_blank href='https://audioaidynamics.com/music-analyzer'>bpm</a>
	<div id='timeRolagem' contenteditable="true" title="Clique para editar o tempo de rolagem (em segundos)">-</div>
	<div id='divtranspor'><select id='seltranspor'><option>A</option></select></div>
	<div id='divManual'><input type="checkbox" id="chManual" name="Manual" checked /><label for="Manual">Manual</label></div>
	<div id='divPlay' style='display:none'><button id="playButton">Iniciar</button></div>
	<div id='divTeoria'>#</div>
  </div>

  <div id="cifra">
	  <div id="layout">
		<div id="colunaEsquerda">
		  <div style='display: none;'>
			<div>
			  <select id='delayInicial' class='delaySelect'>
				<option>0</option><option>2</option><option>5</option><option>10</option>
				<option>15</option><option>20</option><option>25</option><option>30</option>
			  </select>
			</div>
			<div>
			  <select id='delayEntreMusicas' class='delaySelect'>
				<option>0</option><option>2</option><option>5</option><option>10</option><option>15</option>
			  </select>
			</div>
			<div id='timerTotal'></div>
		  </div>
		  <div id="listaMusicas"></div>
		</div>
		<div id="colunaDireita">
		  <div id="container">
			<div id="letraWrapper">
			  <div class="focus-overlay" aria-hidden="true"></div>
			  <div class="color-overlay"></div>
			  <div id="introNav" style="display:none"></div>
			  <div id="letra"></div>
			  <div id="batidaVisual" style='justify-self: right;'>
				<div id="bola5" class='bolaBatida'></div>
				<div id="bola4" class='bolaBatida'></div>
				<div id="bola3" class='bolaBatida'></div>
				<div id="bola2" class='bolaBatida'></div>
				<div id="bola1" class='bolaBatida'></div>
			  </div>
			</div>
		  </div>
		</div>
	  </div>
	  <div id="indicadorSlides"></div>
  </div>



<div id="teoria">
	<style>
.circulo-wrapper {
  position: relative;
  width: 500px;
  height: 500px;
  margin: 40px auto;
  padding: 20px;
}

.circulo-quintas {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 2px solid #444;
  transition: transform 0.8s ease;
}

.circulo-quintas .nota {
  --total: 12;
  --raio: 230px; /* default (para maiores) */
  position: absolute;
  top: 50%;
  left: 50%;
  transform: rotate(calc(360deg / var(--total) * var(--i)))
             translateY(var(--raio));
  text-align: center;
  font-weight: bold;
  cursor: pointer;
}

/* Texto SEM rotação extra */
.circulo-quintas .nota span {
  display: inline-block;
  transform: rotate(0deg);
}

/* Maiores → círculo externo */
.circulo-quintas .nota.maior {
  --raio: -230px;
  font-size: 1.5em;
  color: #fff;
}

/* Menores → círculo interno */
.circulo-quintas .nota.menor {
  --raio: -160px;
  font-size: 1.2em;
  color: #1e90ff;
}

.acorde.destacado {
  color: #00e676 !important;
  font-weight: bold;
}




	</style>
	<table>
	<tr>
	<td style='padding: 20px;'>
	<div class="circulo-wrapper">
		<div class="circulo-quintas" id="circuloQuintas">
			<!-- Acordes maiores -->
			<div class="nota maior" style="--i:0"><span>C</span></div>
			<div class="nota maior" style="--i:1"><span>G</span></div>
			<div class="nota maior" style="--i:2"><span>D</span></div>
			<div class="nota maior" style="--i:3"><span>A</span></div>
			<div class="nota maior" style="--i:4"><span>E</span></div>
			<div class="nota maior" style="--i:5"><span>B</span></div>
			<div class="nota maior" style="--i:6"><span>F#</span></div>
			<div class="nota maior" style="--i:7"><span>C#</span></div>
			<div class="nota maior" style="--i:8"><span>Ab</span></div>
			<div class="nota maior" style="--i:9"><span>Eb</span></div>
			<div class="nota maior" style="--i:10"><span>Bb</span></div>
			<div class="nota maior" style="--i:11"><span>F</span></div>

			<!-- Acordes menores -->
			<div class="nota menor" style="--i:0"><span>Am</span></div>
			<div class="nota menor" style="--i:1"><span>Em</span></div>
			<div class="nota menor" style="--i:2"><span>Bm</span></div>
			<div class="nota menor" style="--i:3"><span>F#m</span></div>
			<div class="nota menor" style="--i:4"><span>C#m</span></div>
			<div class="nota menor" style="--i:5"><span>G#m</span></div>
			<div class="nota menor" style="--i:6"><span>D#m</span></div>
			<div class="nota menor" style="--i:7"><span>A#m</span></div>
			<div class="nota menor" style="--i:8"><span>Fm</span></div>
			<div class="nota menor" style="--i:9"><span>Cm</span></div>
			<div class="nota menor" style="--i:10"><span>Gm</span></div>
			<div class="nota menor" style="--i:11"><span>Dm</span></div>
		</div>
	</div>
	</td>

	<td style='padding: 20px;'>
		<div id='listaDosGraus'>
			GRAUS
		</div>
		<div  style='margin: 24px 0px 0px 0px;display: inline-flex;'>
			<div><button>BPM BATIDA</button></div>
			<div id='resultadoBPM' style='margin: -5px 0px 0px 31px;font-size: 30px;'></div>
		</div>

	</td>
	</tr>
	</table>


<script>
const circulo = document.getElementById("circuloQuintas");
const notas = document.querySelectorAll(".circulo-quintas .nota");

const listaDosGraus = document.getElementById("listaDosGraus");

// Escalas maiores simplificadas
const escalas = {
  "C": ["C","D","E","F","G","A","B"],
  "G": ["G","A","B","C","D","E","F#"],
  "D": ["D","E","F#","G","A","B","C#"],
  "A": ["A","B","C#","D","E","F#","G#"],
  "E": ["E","F#","G#","A","B","C#","D#"],
  "B": ["B","C#","D#","E","F#","G#","A#"],
  "F#": ["F#","G#","A#","B","C#","D#","E#"],
  "C#": ["C#","D#","E#","F#","G#","A#","B#"],
  "F": ["F","G","A","Bb","C","D","E"],
  "Bb": ["Bb","C","D","Eb","F","G","A"],
  "Eb": ["Eb","F","G","Ab","Bb","C","D"],
  "Ab": ["Ab","Bb","C","Db","Eb","F","G"]
};

// Info extra por grau
const infoGraus = [
  {grau:"I",   func:"Tônica",             emoc:"Estável",       vars:"maj7, maj9, 6"},
  {grau:"ii",  func:"Pré-Dominante",      emoc:"Suave tensão",  vars:"m7, m9, m11"},
  {grau:"iii", func:"Tônica menor fraca", emoc:"Melancólico",   vars:"m7, m9"},
  {grau:"IV",  func:"Pré-Dominante",      emoc:"Doce, nobre",   vars:"maj7, 6"},
  {grau:"V",   func:"Dominante",          emoc:"Tenso",         vars:"7, 9, 13, 7(b9)"},
  {grau:"vi",  func:"Tônica menor",       emoc:"Introspectivo", vars:"m7, m9, m11"},
  {grau:"vii°",func:"Dominante fraco",    emoc:"Instável",      vars:"m7(b5)"}
];

// Função que monta a tabela do campo harmônico
function mostrarCampoHarmonico(tonica) {
  const escala = escalas[tonica];
  if (!escala) {
    listaDosGraus.innerHTML = `<p>Não tenho a escala para ${tonica} ainda.</p>`;
    return;
  }

  // Limpa cores anteriores (fundo e texto)
  document.querySelectorAll('.nota').forEach(div => {
    div.style.background = '';
    div.style.color = 'white'; // volta para a cor original
  });

  let html = "<table border='1' cellpadding='5'>";
  html += "<tr><th>Grau</th><th>Acorde</th><th>Função</th><th>Emoção</th><th>Variações úteis</th></tr>";

  escala.forEach((nota, idx) => {
    let acorde = nota;
    let cor = "yellow"; // cor padrão para os acordes do campo harmônico

    if (idx === 1 || idx === 2 || idx === 5) {
      acorde += "m";
    } else if (idx === 6) {
      acorde = nota + "dim";
      cor = "orange"; // cor especial para o diminuto
    }

    // Marca os acordes no círculo (tanto os maiores quanto menores)
    document.querySelectorAll('.nota').forEach(div => {
      const span = div.querySelector('span');
      if (!span) return;
      const texto = span.innerText;

      if (idx === 6) {
        // Para o diminuto, tenta encontrar a nota equivalente no círculo
        if (texto === nota || texto === nota + "m") {
          div.style.color = cor;
        }
      } else {
        if (texto === acorde) {
          div.style.color = cor;
        }
      }
    });

    html += `<tr>
      <td>${infoGraus[idx].grau}</td>
      <td>${acorde}</td>
      <td>${infoGraus[idx].func}</td>
      <td>${infoGraus[idx].emoc}</td>
      <td>${nota}${infoGraus[idx].vars}</td>
    </tr>`;
  });

  html += "</table>";
  listaDosGraus.innerHTML = html;
}



// Eventos de clique
notas.forEach((nota, i) => {
  nota.addEventListener("click", () => {
    // gira o círculo
    const angulo = -(360 / 12) * i;
    circulo.style.transform = `rotate(${angulo}deg)`;

    // só reage se clicou em maior
    if (nota.classList.contains("maior")) {
      const tonica = nota.innerText.trim();
      mostrarCampoHarmonico(tonica);
    }
  });
});
</script>



</div>





<script>
window.__metronomeMuted = true;  // metrônomo começa mudo
window.__padLigado = true;       // pad começa ligado
window.__padChordAtual = null;    // guarda o acorde atualmente no pad


function clamp01(v) {
  if (!Number.isFinite(v)) return 0;
  // margem para erros de ponto flutuante
  return Math.max(0, Math.min(1, v));
}


</script>




<script>
  const letraDiv = document.getElementById('letra');
  const musicas = Array.from(document.querySelectorAll('musica'));
  const listaContainer = document.getElementById('listaMusicas');
  const playButton = document.getElementById('playButton');
  const timerTotalDiv = document.getElementById('timerTotal');
  const timeRolagemDiv = document.getElementById('timeRolagem');

  let ordemSelecionada = [];
  let totalSegundos = 0;
  let timerInterval = null;
  let scrollInterval;
  let rolagemAtual = 30; // tempo em segundos da rolagem
  let musicaEmExecucao = null;


	function autoHideMenuIfMulti() {
	  if (Array.isArray(ordemSelecionada) && ordemSelecionada.length > 1) {
		document.body.classList.add('oculto'); // esconde menu

		// tenta entrar em tela cheia
		const elem = document.documentElement;
		if (elem.requestFullscreen) {
		  elem.requestFullscreen();
		} else if (elem.webkitRequestFullscreen) { // Safari
		  elem.webkitRequestFullscreen();
		} else if (elem.msRequestFullscreen) { // IE/Edge antigos
		  elem.msRequestFullscreen();
		}
	  }
	}

/* === NOVO: estado do “start em 2 etapas” === */
let etapaStart = 0;            // 0 = parado, 1 = pad tocando, 2 = sequência em execução
let sequenciaEmAndamento = false;

/* === NOVO: acha a primeira música pelos checkboxes marcados === */
function primeiraMusicaSelecionada() {
  if (!ordemSelecionada || ordemSelecionada.length === 0) return null;
  const idx = ordemSelecionada[0];
  return musicas[idx] || null;
}

/* === NOVO: só ligar o pad no tom da 1ª música === */
async function iniciarPadDaPrimeira() {
  const m = primeiraMusicaSelecionada();
  if (!m) return false;

  // guarda referência da música atual, como você já faz
  musicaEmExecucao = m;

  const tom   = m.querySelector('tom')?.textContent.trim()   || 'C';
  const tempo = parseInt(m.querySelector('tempo')?.textContent) || 0;
  const ritmo = parseInt(m.querySelector('ritmo')?.textContent) || 1;

  // prepara UI de BPM como você já faz dentro do tocarMusica
  if (tempo > 0) {
    window.bpmBase   = tempo;
    window.bpmAtual  = tempo;
    window.ritmoAtual= ritmo;
    const link = document.getElementById('bpmlink');
    if (link) {
      link.textContent = `${window.bpmAtual}`;
      link.title = 'Ctrl+L diminui | Ctrl+P aumenta';
    }
  }

  // mostra título/intro centralizados (sem contador)
  const nome  = m.querySelector('nome')?.textContent.trim()  || '';
  const intro = m.querySelector('intro')?.textContent.trim() || '';
  letraDiv.innerHTML = `
    <div class="tituloMusica">${nome}</div>
    <div class="introTexto">${intro.replace(/\n/g,"<br>")}</div>
  `;
  letraDiv.style.transition = 'none';
  letraDiv.style.transform  = 'none';
  const alturaWrapper = document.getElementById('letraWrapper').offsetHeight;
  const alturaTitulo  = 40; // altura média do título (ou medir só o .tituloMusica)
  const topInicial    = (alturaWrapper / 2) - (alturaTitulo / 2);
  const alturaBlocoInicial = medirAlturaHTML(letraDiv.innerHTML);
  letraDiv.style.top  = `${topInicial}px`;

// liga só o pad no tom da música
try { pararPad?.(); } catch(_) {}
window.__padLigado = true;     // <— adicionado
iniciarPadSuave?.(tom);


  // deixa playbackRate neutro (caso exista)
  try { if (window.padAudio) window.padAudio.playbackRate = 1.0; } catch(_) {}

  return true;
}


async function executarSequenciaSelecionada() {
  if (sequenciaEmAndamento) return;
  if (!ordemSelecionada || ordemSelecionada.length === 0) return;

  autoHideMenuIfMulti(); // ⬅️ adiciona aqui

  sequenciaEmAndamento = true;
  iniciarContagemRegressiva();

  const delayInicial = parseInt(document.getElementById('delayInicial').value) || 0;
  const delayEntre   = parseInt(document.getElementById('delayEntreMusicas').value) || 0;

  for (let i = 0; i < ordemSelecionada.length; i++) {
    const index   = ordemSelecionada[i];
    const musica  = musicas[index];
    const base    = parseFloat(musica.querySelector('delay')?.textContent) || 0;
    const extra   = i === 0 ? delayInicial : delayEntre;

    // ⬇ PRIMEIRA música após o 1º pressionamento: sem contagem e mantendo o pad tocando
    if (i === 0 && etapaStart === 1) {
      await tocarMusica(musica, base + extra, { pularContagem: true, manterPad: true });
    } else {
      await tocarMusica(musica, base + extra); // demais músicas, tudo como sempre
    }
  }

  sequenciaEmAndamento = false;
  etapaStart = 0;
}





  function formatarTempo(segundos) {
    const m = String(Math.floor(segundos / 60)).padStart(2, '0');
    const s = String(segundos % 60).padStart(2, '0');
    return `${m}:${s}`;
  }

  // --- monta lista lateral em ordem alfabética ---
  const musicasOrdenadas = [...musicas].sort((a, b) => {
    const nomeA = a.querySelector('nome')?.textContent.trim().toLowerCase() || "";
    const nomeB = b.querySelector('nome')?.textContent.trim().toLowerCase() || "";
    return nomeA.localeCompare(nomeB);
  });

let contador = 1;

musicasOrdenadas.forEach((musica, index) => {
  const nome = musica.querySelector('nome')?.textContent.trim() || `Música ${index + 1}`;
  if (nome === "...") return; // não renderiza esta

  const tom = musica.querySelector('tom')?.textContent.trim() || '';
  const url = musica.querySelector('url')?.textContent.trim() || '';

  const container = document.createElement('div');
  container.className = 'musica-option';

  const ordemSpan = document.createElement('span');
  ordemSpan.className = 'ordem';

  const checkbox = document.createElement('input');
  checkbox.type = 'checkbox';
  checkbox.dataset.index = musicas.indexOf(musica);

  let nomeElemento;
  const prefixo = `${contador}. `; // << numeração visível

  if (url) {
    nomeElemento = document.createElement('a');
    nomeElemento.href = url;
    nomeElemento.target = "_blank";
    nomeElemento.textContent = prefixo + nome;
    nomeElemento.style.color = "white";
    nomeElemento.style.textDecoration = "underline";
  } else {
    nomeElemento = document.createElement('span');
    nomeElemento.textContent = prefixo + nome;
  }

  const tomSpan = document.createElement('span');
  tomSpan.textContent = ` (${tom})`;
  tomSpan.style.color = "#666";
  tomSpan.style.marginLeft = "4px";

  const label = document.createElement('label');
  label.appendChild(nomeElemento);

  // 🔹 bolinha azul se tiver <tempo> e <ritmo>
  const temTempo = musica.querySelector('tempo')?.textContent.trim();
  const temRitmo = musica.querySelector('ritmo')?.textContent.trim();
  if (temTempo && temRitmo) {
    const bolinha = document.createElement('span');
    bolinha.className = 'bolinha';
    label.appendChild(bolinha);
  }

  // 🔹 bolinha verde se <cifra> contiver "--"
  const cifraTag = musica.querySelector('cifra');
  const temDelimitador = !!(cifraTag && cifraTag.textContent.includes('--'));
  if (temDelimitador) {
    const bolinhaVerde = document.createElement('span');
    bolinhaVerde.className = 'bolinha verde';
    label.appendChild(bolinhaVerde);
  }

  label.appendChild(tomSpan);

  checkbox.addEventListener('change', () => {
    const idx = parseInt(checkbox.dataset.index);
    if (checkbox.checked) {
      ordemSelecionada.push(idx);
    } else {
      ordemSelecionada = ordemSelecionada.filter(i => i !== idx);
    }
    atualizarOrdemNumerica();
  });

  container.appendChild(ordemSpan);
  container.appendChild(checkbox);
  container.appendChild(label);
  listaContainer.appendChild(container);

  contador++; // incrementa só quando realmente renderizou
});





  function atualizarOrdemNumerica() {
    const inputs = document.querySelectorAll('.musica-option input');
    inputs.forEach(input => {
      const idx = parseInt(input.dataset.index);
      const span = input.parentElement.querySelector('.ordem');
      const pos = ordemSelecionada.indexOf(idx);
      span.textContent = pos !== -1 ? pos + 1 : '';
    });
    atualizarTimerTotal();
  }

  function atualizarTimerTotal() {
    const delayInicial = parseInt(document.getElementById('delayInicial').value) || 0;
    const delayEntre = parseInt(document.getElementById('delayEntreMusicas').value) || 0;
    let soma = 0;
    ordemSelecionada.forEach(index => {
      const musica = musicas[index];
      const rolagem = parseInt(musica.querySelector('rolagem')?.textContent) || 0;
      const delayMusica = parseInt(musica.querySelector('delay')?.textContent) || 0;
      soma += rolagem + delayMusica;
    });
    if (ordemSelecionada.length > 0) {
      soma += delayInicial;
      soma += delayEntre * (ordemSelecionada.length - 1);
    }
    totalSegundos = soma;
    timerTotalDiv.textContent = formatarTempo(soma);
  }

  function iniciarContagemRegressiva() {
    clearInterval(timerInterval);
    let restante = totalSegundos;
    timerTotalDiv.textContent = formatarTempo(restante);
    timerInterval = setInterval(() => {
      restante--;
      if (restante <= 0) {
        clearInterval(timerInterval);
        timerTotalDiv.textContent = "Fim";
      } else {
        timerTotalDiv.textContent = formatarTempo(restante);
      }
    }, 1000);
  }

  playButton.addEventListener('click', async () => {
	autoHideMenuIfMulti(); // ⬅️ adiciona aqui
    iniciarContagemRegressiva();
    const delayInicial = parseInt(document.getElementById('delayInicial').value) || 0;
    const delayEntre = parseInt(document.getElementById('delayEntreMusicas').value) || 0;
    for (let i = 0; i < ordemSelecionada.length; i++) {
      const index = ordemSelecionada[i];
      const musica = musicas[index];
      const baseDelay = parseFloat(musica.querySelector('delay')?.textContent) || 0;
      const delayExtra = i === 0 ? delayInicial : delayEntre;
      await tocarMusica(musica, baseDelay + delayExtra);
    }
  });

  // --- metrônomo ---
  // Lookahead WebAudio scheduler (preciso) mantendo a API original:
  // Variáveis expostas: metronomeInterval, audioCtx, nextNoteTime, contagem
  // Funções expostas: contagemInicial(bpm), iniciarMetronomo(bpm, ritmo), pararMetronomo(), tocarNotaBaixo(tom, when, isTonica)
  let metronomeInterval = null;
  let audioCtx = null;
  let nextNoteTime = 0;
  let contagem = 0;

  // parâmetros do scheduler
  const __LOOKAHEAD_MS__ = 25;         // intervalo para enfileirar eventos (JS)
  const __SCHEDULE_AHEAD__ = 0.12;     // janela de agendamento no relógio de áudio (segundos)

  function __initAudioCtx__() {
    if (!audioCtx) {
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    }
    try { audioCtx.resume && audioCtx.resume(); } catch (_) {}
  }

  function contagemInicial(bpm) {
    return new Promise(resolve => {
      if (!bpm) return resolve();
      __initAudioCtx__();
      const intervalo = 60.0 / bpm;
      let i = 0;
      function tick(time) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = "sine";
        osc.frequency.value = 120;
        gain.gain.setValueAtTime(0.6, time);
        gain.gain.exponentialRampToValueAtTime(0.001, time + 0.12);
        osc.connect(gain).connect(audioCtx.destination);
        osc.start(time);
        osc.stop(time + 0.12);
      }
      (function scheduleCount() {
        if (i < 4) {
          const when = audioCtx.currentTime + 0.04;
          tick(when);
          i++;
          setTimeout(scheduleCount, intervalo * 1000);
        } else {
          resolve();
        }
      })();
    });
  }




function __scheduleBeat__(when, isTonica, tomAtual) {
  try {
    const vol = (window.__metronomeMuted ? 0 : 0.8); // 0 = mudo
    //console.log(`[METRO] when=${when.toFixed(3)}s, tom=${tomAtual}, pulso=${isTonica ? 'TÔNICA' : 'TERÇA'}, vol=${vol}`);
    tocarNotaBaixo(tomAtual, when, isTonica, vol);
  } catch (_) {}
}






  function iniciarMetronomo(bpm, ritmo = 1) {
    pararMetronomo(); // zera anterior
    if (!bpm) return;
    __initAudioCtx__();

    contagem = 0;
    const secondsPerBeat = 60.0 / bpm;
    nextNoteTime = audioCtx.currentTime + 0.06; // pequeno offset de arranque

    const getTomAtual = () => {
      try {
        return (musicaEmExecucao && musicaEmExecucao.querySelector('tom') && musicaEmExecucao.querySelector('tom').textContent.trim()) || "C";
      } catch (_) { return "C"; }
    };

    function scheduler() {
      const tomAtual = getTomAtual();
      while (nextNoteTime < audioCtx.currentTime + __SCHEDULE_AHEAD__) {
        const isTonica = (contagem % 2 === 0); // mantém padrão antigo
        __scheduleBeat__(nextNoteTime, isTonica, tomAtual);
        // avança com base no relógio do áudio
        nextNoteTime += secondsPerBeat * ritmo;
        contagem++;
      }
    }

    // loop leve para agendar
    metronomeInterval = setInterval(scheduler, __LOOKAHEAD_MS__);
  }

  function pararMetronomo() {
    if (metronomeInterval) {
      clearInterval(metronomeInterval);
      metronomeInterval = null;
    }
  }









// === HOLD-TO-SCROLL (manual fluido com easing) ===
const manualScroll = {
  active: false,
  dir: 0,                   // 1 = desce, -1 = sobe, 0 = parado
  raf: null,
  speedBase: 250,           // px/s
  speedBoost: 900,          // px/s (Shift)
  shiftKey: false,

  // Dinâmica (easing)
  v: 0,                     // velocidade atual (px/s)
  lastTs: 0,                // timestamp do último frame
  tauIn: 0.3,              // constante de tempo aceleração (s) → menor = arranca mais rápido
  tauOut: 0.3,             // constante de tempo desaceleração (s) → menor = freia mais rápido
  maxAccel: 2500,           // teto de aceleração (px/s²) como segurança

  // Auto-avançar no fim
  autoAdvanceHoldMs: 500,   // segurar 0.5s no fim → próxima música
  _holdMs: 0,
  onEnd: null,
};





function __stepManualScroll__(ts) {
  if (!manualScroll.active) return;

  const wrapper = document.getElementById('letraWrapper');
  const letra   = document.getElementById('letra');
  if (!wrapper || !letra) return;

  // dt em segundos
  if (!manualScroll.lastTs) manualScroll.lastTs = ts;
  const dt = Math.max(0.001, (ts - manualScroll.lastTs) / 1000);
  manualScroll.lastTs = ts;

  const target = manualScroll.dir * (manualScroll.shiftKey ? manualScroll.speedBoost : manualScroll.speedBase);

  // --- escolhe tau: acelera só se tem alvo ≠ 0, mesma direção e |target|>|v|
  const sameDir = Math.sign(target) === Math.sign(manualScroll.v) || manualScroll.v === 0;
  const accelerating = (target !== 0) && sameDir && (Math.abs(target) > Math.abs(manualScroll.v));
  const tau = accelerating ? manualScroll.tauIn : manualScroll.tauOut;

  const alpha = 1 - Math.exp(-dt / Math.max(0.001, tau));
  let vNext = manualScroll.v + (target - manualScroll.v) * alpha;

  // --- clamp de aceleração opcional (defina maxAccel <= 0 para desativar)
  if (manualScroll.maxAccel && manualScroll.maxAccel > 0) {
    const maxDV = manualScroll.maxAccel * dt;
    const dv = vNext - manualScroll.v;
    if (Math.abs(dv) > maxDV) vNext = manualScroll.v + Math.sign(dv) * maxDV;
  }

  // integra posição
  const topNow = parseFloat(letra.style.top || "0");
  let newTop = topNow - vNext * dt;

  // limites (fim = última linha no TOPO)
  let minTop = calcularTopFinal(0);
  if (minTop === null) {
    const alturaTexto   = letra.scrollHeight;
    const alturaWrapper = wrapper.offsetHeight;
    minTop = Math.min(0, alturaWrapper - alturaTexto - 40);
  }
  const maxTop = wrapper.offsetHeight - 40;

  // clamp e zerinho de segurança na borda
  let clampedTop = newTop;
  if (clampedTop < minTop) { clampedTop = minTop; vNext = 0; }
  if (clampedTop > maxTop) { clampedTop = maxTop; vNext = 0; }

  letra.style.top = clampedTop + "px";
  manualScroll.v = vNext;

  // --- AUTO-STOP: se não há alvo (dir=0) e a velocidade ficou quase zero, desligue o loop
  if (manualScroll.dir === 0 && Math.abs(manualScroll.v) < 0.5) {
    manualScroll.active = false;
    manualScroll.v = 0;
    manualScroll._holdMs = 0;
    manualScroll.lastTs = 0;
    manualScroll.raf = null;
    return;
  }

// detectar “fim” + segurar → auto-avança (com tolerância) + reset de estado da próxima
const nearEnd = (clampedTop - minTop) <= 2; // 2px de folga
if (manualScroll.dir === 1 && nearEnd) {
  manualScroll._holdMs += dt * 1000;
  if (manualScroll._holdMs >= manualScroll.autoAdvanceHoldMs) {
    const cb = manualScroll.onEnd;

    // 1) para a rolagem manual (hard stop)
    stopManualScroll(false);

    // 2) importantíssimo: zere o estado de navegação para a PRÓXIMA música
    //    (isso faz a próxima começar pela INTRO, depois seguir acorde por acorde)
    window.__introAtivo = true;
    window.__acordeIntroAtual = -1;
    window.__acordeAtual = -1;

    // 3) chama o callback de “fim da música” que resolve a Promise do tocarMusica
    if (typeof cb === 'function') {
      // deixa o layout assentar um frame antes de trocar a música
      requestAnimationFrame(() => cb());
    }
    return;
  }
} else {
  manualScroll._holdMs = 0;
}




  manualScroll.raf = requestAnimationFrame(__stepManualScroll__);
}








function startManualScroll(dir, withShift=false) {
  manualScroll.dir = dir;
  manualScroll.shiftKey = !!withShift;
  if (!manualScroll.active) {
    manualScroll.active = true;
    manualScroll._holdMs = 0;
    manualScroll.lastTs = 0; // força dt correto no 1º frame
    manualScroll.raf = requestAnimationFrame(__stepManualScroll__);
  }
}

function stopManualScroll(soft = true) {
  if (soft) {
    // alvo de velocidade vira 0 → desacelera com tauOut
    manualScroll.dir = 0;
    manualScroll.shiftKey = false;

    // garante que o loop está vivo para fazer a desaceleração
    if (!manualScroll.active) {
      manualScroll.active = true;
      manualScroll.lastTs = 0;
      manualScroll.raf = requestAnimationFrame(__stepManualScroll__);
    }
    return;
  }

  // parada brusca (hard stop), se precisar
  manualScroll.active = false;
  manualScroll.dir = 0;
  manualScroll.v = 0;
  manualScroll._holdMs = 0;
  manualScroll.lastTs = 0;
  if (manualScroll.raf) cancelAnimationFrame(manualScroll.raf);
  manualScroll.raf = null;
}







function tocarNotaBaixo(tom, time, isTonica = true, vol = 0.8) {
  __initAudioCtx__();

  const notasBase = { "C":65.41,"C#":69.30,"D":73.42,"D#":77.78,"E":82.41,"F":87.31,
                      "F#":92.50,"G":98.00,"G#":103.83,"A":110.00,"A#":116.54,"B":123.47 };
  const alias = { "Db":"C#","Eb":"D#","Gb":"F#","Ab":"G#","Bb":"A#" };
  if (alias[tom]) tom = alias[tom];
  if (!notasBase[tom]) return;

  const freqs = Object.values(notasBase);
  const tons = Object.keys(notasBase);
  const index = tons.indexOf(tom);

  const freq1 = notasBase[tom];
  const freq3 = freqs[(index + 4) % 12];
  const freq  = isTonica ? freq1 : freq3;
	//console.log(`[METRO→OSC] ${isTonica ? 'TÔNICA' : 'TERÇA'} de ${tom} = ${freq.toFixed(2)} Hz`);
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();

  osc.type = "sine";
  osc.frequency.setValueAtTime(freq, time);
  gain.gain.setValueAtTime(Math.max(0, vol), time);
  gain.gain.exponentialRampToValueAtTime(0.001, time + 0.6);

  osc.connect(gain).connect(audioCtx.destination);
  osc.start(time);
  osc.stop(time + 0.6);
}












function formatarLinhasCifra(cifraTexto) {
  const TAB = 4;

  // Token de acorde: raiz + acidentes, sufixos (m, maj, sus, dim, aug), extensões,
  // opcional com parênteses e opcional baixo ("/nota")
  // permite * antes ou depois do acorde
const RE_ACORDE = /^\*?[A-G](?:#|b)?(?:maj|min|m|sus[24]?|dim|aug|add)?\d*(?:\([^)]+\))?(?:\/[A-G](?:#|b)?)?\*?$/;


  function protegerIndentacao(inicio) {
    // tabs do INÍCIO da linha -> espaços; depois espaços iniciais -> &nbsp;
    inicio = inicio.replace(/^\t+/g, t => ' '.repeat(t.length * TAB));
    inicio = inicio.replace(/^ +/g, s => '&nbsp;'.repeat(s.length));
    return inicio;
  }

  function ehLinhaDeAcorde(texto) {
    // true somente se cada token não-vazio (sem ser só espaço) for um acorde
    const tokens = texto.trim().split(/\s+/).filter(Boolean);
    if (tokens.length === 0) return false;
    return tokens.every(t => RE_ACORDE.test(t));
  }

  return cifraTexto.split('\n').map(linha => {
    // separa prefixo de espaços/tabs do resto
    const m = linha.match(/^\s*/);
    const inicio = protegerIndentacao(m ? m[0] : '');
    const resto  = linha.slice(m ? m[0].length : 0);

    if (ehLinhaDeAcorde(resto)) {
      // envolve APENAS os acordes individuais
      return inicio + resto.split(/(\s+)/).map(tok => {
        const t = tok.trim();
        if (t && RE_ACORDE.test(t)) return `<span class="acorde">${tok}</span>`;
        return tok.replace(/ /g, '&nbsp;');
      }).join('');
    }

    // linha de LETRA: não tocar em palavras; só preservar indentação/espaços
    return inicio + resto.replace(/ /g, '&nbsp;');
  }).join('\n');
}






// ⬇ altera só a assinatura e pontos marcados; resto é idêntico ao seu
async function tocarMusica(musica, delayTotal = 0, opts = {}) {

//zoom
document.body.style.zoom = "1.4";


  // [2-etapas] não pare o pad se pedirem pra manter
  clearInterval(scrollInterval);
  pararMetronomo();
  if (!opts?.manterPad) pararPad();

  musicaEmExecucao = musica;
  const nome = musica.querySelector('nome')?.textContent.trim() || '';
  const intro = musica.querySelector('intro')?.textContent.trim() || '';
  const cifra = musica.querySelector('cifra')?.textContent.trim() || '';
  const rolagemTag = parseFloat(musica.querySelector('rolagem')?.textContent) || 30;
  const tempo = parseInt(musica.querySelector('tempo')?.textContent) || 0;
  const ritmo = parseInt(musica.querySelector('ritmo')?.textContent) || 1;
  const tom = musica.querySelector('tom')?.textContent.trim() || 'C';
  const delay = delayTotal;

  rolagemAtual = rolagemTag > 1 ? rolagemTag : 30;
  timeRolagemDiv.textContent = rolagemAtual;

  // (BPM/UI) — mantém igual ao seu fluxo
  if (tempo > 0) {
    window.bpmBase   = tempo;
    window.bpmAtual  = tempo;
    window.ritmoAtual= ritmo;
    const link = document.getElementById('bpmlink');
    if (link) { link.textContent = `${window.bpmAtual}`; link.title = 'Ctrl+L ↓ | Ctrl+P ↑'; }
  }

	const contadorHTML   = `<div id="contadorDelay">${formatarTempo(delay)}</div>`;
	const nomeHTML       = `<div class="tituloMusica">${nome}</div>`;
	const introHTML = `<div class="introTexto">${formatarIntro(intro)}</div>`;
	const cifraHTML      = `<pre class="cifraTexto">${formatarLinhasCifra(cifra)}</pre>`;
	const fimMusicaHTML  = `<div id="fimAnchor" style="height:0; line-height:0;"></div><div class="fimMusica">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</div>`;

	// 1) Monta TUDO já com <pre>, mas deixa a cifra oculta
	letraDiv.innerHTML = `
	  ${contadorHTML}
	  ${nomeHTML}
	  ${introHTML}
	  <div id="cifraBlock" style="display:none">${cifraHTML}</div>
	  ${fimMusicaHTML}
	`;
	letraDiv.style.transition = 'none';
	letraDiv.style.transform  = 'none';

	// 2) Centraliza pela altura VISÍVEL (contador + título + intro)
	const alturaWrapper      = document.getElementById('letraWrapper').offsetHeight;
	const alturaBlocoInicial = medirAlturaHTML(contadorHTML + nomeHTML + introHTML);
	const topInicial         = (alturaWrapper / 2) - (alturaBlocoInicial / 2);
	letraDiv.style.top = `${topInicial}px`;

	// 3) Contagem / metrônomo / pad
	if (tempo > 0) {
	  if (!opts?.pularContagem) {
		await contagemInicial(tempo);
	  }
	  iniciarMetronomo(tempo, ritmo);
	  if (!opts?.manterPad) {
		iniciarPadSuave(tom);
		try { if (window.padAudio) window.padAudio.playbackRate = 1.0; } catch(_) {}
	  }
	}

	// 4) Espera o delay mantendo a cifra oculta
	await new Promise(resolve => {
	  let restante = delay;
	  const contador = document.getElementById('contadorDelay');
	  const intervalo = setInterval(() => {
		restante--;
		if (contador) contador.textContent = formatarTempo(restante);
		if (restante <= 0) { clearInterval(intervalo); resolve(); }
	  }, 1000);
	});

	// 5) Agora só MOSTRA a cifra (sem reconstruir HTML) — preserva indentação da 1ª linha
	const cifraBlock = document.getElementById('cifraBlock');
	if (cifraBlock) cifraBlock.style.display = 'block';

	// mantém o mesmo top calculado para iniciar a rolagem
	letraDiv.style.top = `${topInicial}px`;

await new Promise(resolve => {
  let pos = topInicial;
  const fps = 30;

  // alvo: última palavra no topo (0). Se quiser um “respiro”,
  // use calcularTopFinal(8) para 8px abaixo do topo.
  let topFinal = calcularTopFinal(0);

  if (topFinal === null) {
    // fallback: se não houver fimAnchor por algum motivo, cai no antigo
    const alturaTexto = letraDiv.scrollHeight;
    const distancia   = alturaTexto + topInicial;
    scrollInterval = setInterval(() => {
      const tempoUsado = rolagemAtual > 1 ? rolagemAtual : 30;
      const pxs        = distancia / tempoUsado / fps;
      pos -= pxs;
      letraDiv.style.top = pos + "px";
      if (pos + alturaTexto < 0) {
        clearInterval(scrollInterval);
        pararMetronomo(); pararPad(); resolve();
      }
    }, 1000 / fps);
    return;
  }

  const distancia = Math.max(1, Math.abs(topFinal - topInicial));
  scrollInterval = setInterval(() => {
    // se reflow ocorrer (troca de fonte, transpose…), recalcule o alvo
    const novoFinal = calcularTopFinal(0);
    if (novoFinal !== null) topFinal = novoFinal;

    const tempoUsado = rolagemAtual > 1 ? rolagemAtual : 30;
    const step       = (distancia / tempoUsado) / fps;

    // anda na direção do alvo
    if (pos > topFinal) pos = Math.max(topFinal, pos - step);
    else                pos = Math.min(topFinal, pos + step);

    letraDiv.style.top = pos + "px";

    // crava e finaliza
    if (Math.abs(pos - topFinal) < 0.5) {
      letraDiv.style.top = `${topFinal}px`;
      clearInterval(scrollInterval);
      pararMetronomo(); pararPad();
      resolve();
    }
  }, 1000 / fps);
});



}


function calcularTopFinal(alvoY = 0) {
  const anchor  = document.getElementById('fimAnchor');
  const wrapper = document.getElementById('letraWrapper');
  const letra   = document.getElementById('letra');
  if (!anchor || !wrapper || !letra) return null;

  // Usa a line-height da <pre> (cifra) se existir, senão da #letra
  const pre = letra.querySelector('pre.cifraTexto');
  const lh  = pre ? parseFloat(getComputedStyle(pre).lineHeight)
                  : parseFloat(getComputedStyle(letra).lineHeight) || 32;

  // A âncora vem LOGO DEPOIS da última linha; subimos 1 line-height
  // topFinal = alvoY + lh - offsetTop(anchor)
  return (alvoY + lh) - anchor.offsetTop;
}





	function medirAlturaHTML(html) {
		const temp = document.createElement('div');
		temp.style.position = 'absolute';
		temp.style.visibility = 'hidden';
		temp.style.whiteSpace = 'pre-wrap';
		temp.style.fontSize = '2em';
		temp.style.lineHeight = '1.5em';
		temp.style.width = '80%';
		temp.style.fontFamily = 'Arial, sans-serif';
		temp.style.textAlign = 'left';
		temp.innerHTML = html;
		document.body.appendChild(temp);
		const altura = temp.scrollHeight;
		document.body.removeChild(temp);
		return altura;
	}

  // 👉 edição manual em #timeRolagem muda a rolagem em tempo real
  timeRolagemDiv.addEventListener("input", () => {
    const novoValor = parseFloat(timeRolagemDiv.textContent);
    if (!isNaN(novoValor) && novoValor > 1) {
      rolagemAtual = novoValor;
    }
  });




  // --- PAD WORSHIP COM MP3 ---
  let padAudio = null;
// estado mestre do pad (padrão: ligado)
window.__padLigado = (window.__padLigado !== false);


  function pararPad() {
    if (padAudio) {
      padAudio.pause();
      padAudio.currentTime = 0;
      padAudio = null;
    }
  }








// --- mapeia nome do arquivo do pad a partir do tom (evita '#')
// mapeia nome de arquivo se você usa "sharp" em vez de "#"
function __padSrcFromTom(tom) {
  if (!tom) return null;
  const s = String(tom).trim();

  // Captura nota + (#|b) + 'm' (se menor) apenas no início do token
  const m = s.match(/^([A-G])([#b]?)(m)?/i);
  if (!m) return null;

  let nota = m[1].toUpperCase();
  let acc  = (m[2] || "");          // "#", "b" ou ""
  const isMinor = !!m[3];

  // Converte bemol para enarmônico com sustenido/ natural
  if (acc === "b") {
    const flatMap = { Ab:"G#", Bb:"A#", Cb:"B", Db:"C#", Eb:"D#", Fb:"E", Gb:"F#" };
    const key = nota + "b";
    const conv = flatMap[key] || key; // ex.: "Bb" -> "A#"
    nota = conv[0].toUpperCase();
    acc  = conv.length > 1 ? "#" : ""; // se virou "A#", marca "#"
  }

  // Monta base conforme seus arquivos: "Asharp", "C", etc.
  const base = nota + (acc === "#" ? "sharp" : "") + (isMinor ? "m" : "");
  return `pad/${base}.mp3`; // mantenha 'pad/' (é o que seu arquivo usa)
}


window.__padVol = window.__padVol ?? 0.65;

function iniciarPadSuave(tom, fadeMs = 320) {
  if (!window.__padLigado || !tom) return;

  // se já estamos neste tom e o player está ativo, não recria
  if (window._padTomAtual === tom && window.padAudio && !window.padAudio.paused) return;

  // utilitário: clamp em [0,1] para evitar IndexSizeError
  const clamp01 = v => Math.max(0, Math.min(1, Number.isFinite(v) ? v : 0));

  const old = window.padAudio || null;
  const novo = new Audio(__padSrcFromTom(tom));
  novo.loop = true;
  novo.volume = 0.0;

  // tenta tocar; se falhar (autoplay), seguimos o crossfade mesmo assim
  novo.play().catch(() => {});

  // cancela fade anterior, se houver
  if (window.__padFadeRaf) cancelAnimationFrame(window.__padFadeRaf);

  const vAlvo = clamp01(window.__padVol ?? 0.65);
  const vOld0 = clamp01(old ? old.volume : 0);
  const t0 = performance.now();

  // easing mais macio
  const easeInOutCubic = x => (x < 0.5 ? 4*x*x*x : 1 - Math.pow(-2*x + 2, 3) / 2);

  function step(ts) {
    const progresso = (ts - t0) / Math.max(60, fadeMs);
    const tLin = clamp01(progresso);
    const t = easeInOutCubic(tLin);

    if (old) {
      const volOld = clamp01(vOld0 * (1 - t));
      try { old.volume = volOld; } catch (_) {}
    }

    const volNovo = clamp01(vAlvo * t);
    try { novo.volume = volNovo; } catch (_) {}

    if (tLin < 1) {
      window.__padFadeRaf = requestAnimationFrame(step);
    } else {
      // fim do crossfade
      if (old) {
        try { old.pause(); old.src = ""; } catch (_) {}
      }
      window.padAudio = novo;
      window._padTomAtual = tom;   // chave do tom atual atualizada aqui
      window.__padFadeRaf = null;
      // garanta volume final correto
      try { novo.volume = vAlvo; } catch (_) {}
    }
  }

  window.__padFadeRaf = requestAnimationFrame(step);
}


function pararPadSuave(fadeMs = 180) {
  const a = window.padAudio;
  if (!a) return;
  if (window.__padFadeRaf) cancelAnimationFrame(window.__padFadeRaf);

  const v0 = a.volume;
  const t0 = performance.now();
  function step(ts){
    const t = Math.min(1, (ts - t0) / Math.max(40, fadeMs));
    a.volume = v0 * (1 - t);
    if (t < 1) {
      window.__padFadeRaf = requestAnimationFrame(step);
    } else {
      try { a.pause(); a.src = ""; } catch(_) {}
      window.padAudio = null;
	  window._padTomAtual = null;   // <<< importante: zera a chave atual
      window.__padFadeRaf = null;
    }
  }
  window.__padFadeRaf = requestAnimationFrame(step);
}















// ===== Utilitários para tocar o pad do acorde destacado =====
function normalizarNota(n) {
  const mapa = { "Db":"C#", "Eb":"D#", "Gb":"F#", "Ab":"G#", "Bb":"A#" };
  return mapa[n] || n;
}

// pega a raiz do acorde (antes da barra), ex.: "A9/C#" -> "A"
function extrairTomDoAcorde(str) {
  if (!str) return null;
  const parte = String(str).trim().split(/\s+/)[0].split('/')[0];
  const m = parte.match(/^([A-G](?:#|b)?)/);
  return m ? normalizarNota(m[1]) : null;
}






// ===== CONFIG =====
// true = usar a nota do BAIXO (após a barra) para o pad, ex.: "E/G#" -> "G#"
// false = usar a RAIZ do acorde, ex.: "E/G#" -> "E"
const PAD_USA_BAIXO_DA_INVERSAO = true;

// Se seus arquivos não têm "#", e sim "sharp" ou "sus", ajuste aqui:
const MAPA_ARQUIVO_PAD = { "C#":"Csharp", "D#":"Dsharp", "F#":"Fsharp", "G#":"Gsharp", "A#":"Asharp" };
// Se seus arquivos aceitam "#", pode deixar MAPA_ARQUIVO_PAD vazio.


// ————— Sanitização de texto (remove NBSP, tabs etc.)
function __sanitize(str) {
  return String(str || "")
    .replace(/\u00A0/g, " ")  // NBSP -> espaço normal
    .replace(/\s+/g, " ")     // colapsa
    .trim();
}



// ————— Converte bemol -> sustenido (seus arquivos/sintonia usam #)
function __bemolParaSustenido(nota) {
  const map = { "Db":"C#", "Eb":"D#", "Gb":"F#", "Ab":"G#", "Bb":"A#" };
  return map[nota] || nota;
}

// ————— Extrai APENAS a RAIZ (ignora inversões e sufixos)
// sanitiza, converte bemol->sustenido e pega só a tônica (antes da barra)
function __extrairRaiz(acordeStr) {
  const s = __sanitize(acordeStr);
  if (!s) return null;
  const [antes] = s.split("/");
  const m = antes.match(/^([A-Ga-g])([#b]?)/);
  if (!m) return null;
  let nota = m[1].toUpperCase() + (m[2] || "").toUpperCase();
  if (nota.endsWith("B")) nota = __bemolParaSustenido(nota);
  return nota; // "C", "F#", "A#"
}



// ————— Transforma a raiz em NOME DE ARQUIVO (ajuste se usar “sharp”)
function __padSrcFromKey(key) {
  // Se seus arquivos são "Csharp.mp3" etc., mapeie aqui:
  const SHARP = { "C#":"Csharp", "D#":"Dsharp", "F#":"Fsharp", "G#":"Gsharp", "A#":"Asharp" };
  const nome = SHARP[key] || key;   // troque por seu padrão, se for diferente
  return `pad/${nome}.mp3`;         // ajuste a pasta se necessário
}



// troca o pad para o tom do acorde atual (respeita o toggle do "p")
// troca de pad SEMPRE com crossfade e só pela RAIZ
// troca o pad para o tom do acorde atual (com crossfade), usando só a RAIZ
function __extrairPadTom(acordeStr) {
  const s = __sanitize(acordeStr);
  if (!s) return null;
  const [antes] = s.split("/");
  // raiz + (#|b) + 'm' (se menor). Ignora extensões (7, 9, sus, etc.)
  const m = antes.match(/^([A-Ga-g])([#b]?)(m|min)?/);
  if (!m) return null;

  let nota = m[1].toUpperCase() + (m[2] || "").toUpperCase(); // ex.: "Bb"
  if (nota.endsWith("B")) nota = __bemolParaSustenido(nota);   // "Bb" -> "A#"
  const isMinor = !!m[3];
  return nota + (isMinor ? "m" : "");                          // "A", "Am", "C#", "C#m"
}

function tocarPadDoAcorde(acordeStr) {
  if (!window.__padLigado) return;
  const tomPad = __extrairPadTom(acordeStr);
  if (!tomPad) return;

  // se já estamos no mesmo tom, apenas sincroniza volume atual com __padVol
  if (window._padTomAtual === tomPad && window.padAudio && !window.padAudio.paused) {
    try {
      const v = Math.max(0, Math.min(1, window.__padVol ?? window.padAudio.volume));
      window.padAudio.volume = v;
    } catch(_) {}
    return;
  }

  // caso contrário, troca com crossfade
  iniciarPadSuave(tomPad, 360);
}














// ===== INTRO: estado e helpers =====
window.__introAtivo = false;
window.__acordeIntroAtual = -1;

function tokenizarAcordes(str) {
  // mesmo padrão de acordes usado na cifra
  const RE_ACORDE = /^[A-G](?:#|b)?(?:maj|min|m|sus[24]?|dim|aug|add)?\d*(?:\([^)]+\))?(?:\/[A-G](?:#|b)?)?$/;
  // separa por espaços mantendo tokens
  return String(str || "")
    .split(/(\s+)/)
    .map(t => t.trim())
    .filter(Boolean)
    .filter(t => RE_ACORDE.test(t));
}

function prepararIntroNavbar(introTexto) {
  const nav = document.getElementById('introNav');
  if (!nav) return false;

  const acordes = tokenizarAcordes(introTexto);
  if (!acordes.length) {
    nav.style.display = 'none';
    window.__introAtivo = false;
    return false;
  }

  nav.innerHTML = acordes.map((a,i)=>`<span class="acorde-intro" data-i="${i}">${a}</span>`).join('');
  nav.style.display = '';
  window.__introAtivo = true;
  window.__acordeIntroAtual = -1;
  return true;
}

function obterAcordesIntro() {
  return Array.from(document.querySelectorAll('#introNav .acorde-intro'));
}

window.__introAtivo = false;
window.__acordeIntroAtual = -1;

function obterAcordesIntro() {
  return Array.from(document.querySelectorAll('.introTexto .acorde-intro'));
}

function destacarIntroPorIndice(idx) {
  const acordes = obterAcordesIntro();
  if (!acordes.length) return false;
  idx = Math.max(0, Math.min(idx, acordes.length - 1));

  acordes.forEach(el => el.classList.remove('destacado'));
  const alvo = acordes[idx];
  if (!alvo) return false;
  alvo.classList.add('destacado');

  window.__acordeIntroAtual = idx;

  // troca pad
  const acordeLimpo = alvo.textContent.replace(/\*/g, "").trim();
  tocarPadDoAcorde(acordeLimpo);
  iniciarBaixoDoAcorde(acordeLimpo);
  const raiz = (alvo.textContent.trim().match(/^[A-G](?:#|b)?/i) || ['?'])[0].toUpperCase();
  console.log(`[PAD] acorde="${alvo.textContent.trim()}" → raiz="${raiz}" (trocando PAD)`);
  return true;
}

function avancarIntro(passo) {
  const acordes = obterAcordesIntro();
  if (!acordes.length) return false;

  let idx = (window.__acordeIntroAtual ?? -1) + passo;
  if (idx < 0) idx = 0;
  if (idx >= acordes.length) {
    // terminou a intro → desativa
    window.__introAtivo = false;
    return false;
  }

  destacarIntroPorIndice(idx);
  return true;
}






















  // --- botões extras ---
  document.getElementById('toggleMenu').addEventListener('click', () => {
    document.body.classList.toggle('oculto');
  });
  document.getElementById('delayInicial').addEventListener('change', atualizarTimerTotal);
  document.getElementById('delayEntreMusicas').addEventListener('change', atualizarTimerTotal);
</script>






<script>
// ---------------- TRANSPOSTO ----------------
const selTranspor = document.getElementById("seltranspor");
const tons = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
const tonsMenores = tons.map(t => t + "m");

// popula select com 12 maiores + 12 menores
selTranspor.innerHTML = "";
[...tons, ...tonsMenores].forEach(t => {
  const opt = document.createElement("option");
  opt.value = t;
  opt.textContent = t;
  selTranspor.appendChild(opt);
});

let musicaTransposicao = null; // música selecionada para transpor

// clique no tom (ao lado do nome) para escolher a música
document.querySelectorAll("#listaMusicas .musica-option").forEach(container => {
  const tomSpan = container.querySelector("span:last-child");
  if (tomSpan) {
    tomSpan.style.cursor = "pointer";
    tomSpan.title = "Clique para selecionar esta música para transposição";
    tomSpan.addEventListener("click", () => {
      document.querySelectorAll("#listaMusicas .musica-option span:last-child").forEach(s => {
        s.style.fontWeight = "normal";
        s.style.color = "#666";
      });
      tomSpan.style.fontWeight = "bold";
      tomSpan.style.color = "#0ff";

      const idx = container.querySelector("input").dataset.index;
      musicaTransposicao = musicas[idx];
    });
  }
});

// quando mudar select → transpõe música ativa
selTranspor.addEventListener("change", () => {
  if (!musicaTransposicao) return;
  const novoTom = selTranspor.value;
  transporMusica(musicaTransposicao, novoTom);

  // se a música já estiver em execução, atualiza tela
  if (musicaEmExecucao === musicaTransposicao) {
    const cifraNova = musicaTransposicao.querySelector("cifra").textContent;
    const introNova = musicaTransposicao.querySelector("intro")?.textContent || "";
    const cifraHTML = `<pre class="cifraTexto">${formatarLinhasCifra(cifraNova)}</pre>`;
    const introHTML = introNova ? `<div class="introTexto">${introNova.replace(/\n/g,"<br>")}</div>` : "";
    const titulo = musicaTransposicao.querySelector("nome").textContent;
    letraDiv.innerHTML = `<div class="tituloMusica">${titulo}</div>${introHTML}<br>${cifraHTML}`;
  }
});

function transporTextoDeCifra(texto, delta) {
  const linhas = texto.split("\n");
  return linhas.map(linha => {
    const linhaSemEspacos = linha.trim();
    const temSimbolos = /[#76()\/]/.test(linhaSemEspacos);
    const temMaiusculas = /[A-G]/.test(linhaSemEspacos);
    const temMinusculasNaoPermitidas = /[a-ln-zç]/.test(linhaSemEspacos); // 🔹 inclui ç
    const muitosEspacos = (linha.match(/ /g) || []).length > 3;

    const ehLinhaDeAcorde = (!temMinusculasNaoPermitidas && (temSimbolos || temMaiusculas || muitosEspacos));

    if (ehLinhaDeAcorde && linhaSemEspacos !== "") {
      // só nesta linha aplica regex para transpor
      return linha.replace(/([A-G](#|b)?(m)?(7)?(\/[A-G](#|b)?)?)/g, acorde => transporAcorde(acorde, delta));
    } else {
      return linha; // letra intacta
    }
  }).join("\n");
}


function transporMusica(musica, novoTom) {
  const cifraTag = musica.querySelector("cifra");
  const introTag = musica.querySelector("intro");
  const tomTag = musica.querySelector("tom");
  if (!cifraTag || !tomTag) return;

  const tomOriginal = tomTag.textContent.trim();
  const delta = calcularDelta(tomOriginal, novoTom);

	const cifraOriginal = cifraTag.textContent;
	cifraTag.textContent = transporTextoDeCifra(cifraOriginal, delta);

	if (introTag) {
	  const introOriginal = introTag.textContent;
	  introTag.textContent = transporTextoDeCifra(introOriginal, delta);
	}

  // --- tom atualizado ---
  tomTag.textContent = novoTom;

  const idx = musicas.indexOf(musica);
  const container = document.querySelector(`#listaMusicas input[data-index="${idx}"]`).parentElement;
  const tomSpan = container.querySelector("span:last-child");
  if (tomSpan) {
    tomSpan.textContent = ` (${novoTom})`;
    tomSpan.style.fontWeight = "bold";
    tomSpan.style.color = "#0ff";
  }
}

function calcularDelta(orig, dest) {
  const tons = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
  const mapa = {"Db":"C#","Eb":"D#","Gb":"F#","Ab":"G#","Bb":"A#"};
  if (mapa[orig]) orig = mapa[orig];
  if (mapa[dest]) dest = mapa[dest];
  const iOrig = tons.indexOf(orig.replace("m",""));
  const iDest = tons.indexOf(dest.replace("m",""));
  if (iOrig === -1 || iDest === -1) return 0;
  return (iDest - iOrig + 12) % 12;
}

function transporAcorde(acorde, delta) {
  const tons = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
  const mapa = {"Db":"C#","Eb":"D#","Gb":"F#","Ab":"G#","Bb":"A#"};
  const match = acorde.match(/^([A-G](#|b)?)(.*)$/);
  if (!match) return acorde;
  let raiz = match[1];
  const sufixo = match[3] || "";
  if (mapa[raiz]) raiz = mapa[raiz];
  const idx = tons.indexOf(raiz);
  if (idx === -1) return acorde;
  const novaRaiz = tons[(idx + delta) % 12];
  return novaRaiz + sufixo;
}
</script>



<script>
  let slides = [];
  let slideAtual = 0;
  let emModoManual = false;
  let proximaMusicaCallback = null;

document.addEventListener('keydown', (e) => {
  if (!emModoManual || slides.length === 0) return;

  // Avançar slide: → ou ↑ ou PageDown
  if (["ArrowRight", "ArrowDown", "PageDown"].includes(e.key)) {
    if (slideAtual < slides.length - 1) {
      slideAtual++;
      exibirSlideAtual();
    } else if (slideAtual === slides.length - 1) {
      emModoManual = false;
      pararMetronomo?.();
      pararPad?.();
      if (typeof proximaMusicaCallback === "function") {
        proximaMusicaCallback();
      }
    }
  }

  // Retroceder slide: ← ou ↓ ou PageUp
  else if (["ArrowLeft", "ArrowUp", "PageUp"].includes(e.key)) {
    if (slideAtual > 0) {
      slideAtual--;
      exibirSlideAtual();
    }
  }
});


/* === NOVO: volta ao estado inicial === */
function resetarInicio() {
  clearInterval(timerInterval);
  clearInterval(scrollInterval);
  stopManualScroll(); // <<< adiciona isto
  try { pararMetronomo?.(); } catch(_) {}
  try { pararPad?.(); }       catch(_) {}

  musicaEmExecucao = null;
  etapaStart = 0;
  sequenciaEmAndamento = false;

  // se estiver no modo manual/”slides”, volta pra base
  try { emModoManual = false; slides = []; } catch(_) {}

  // mantém o tempo total calculado na lateral, só limpa a tela
  letraDiv.innerHTML = "";
}



/* === NOVO: teclado para controlar start em 2 etapas === */
document.addEventListener('keydown', async (e) => {
  // não conflitar com a navegação de slides do modo manual
  if (typeof emModoManual !== 'undefined' && emModoManual) return;

  // Etapa 1 → Etapa 2
  if (["ArrowRight", "ArrowDown", "PageDown"].includes(e.key)) {
    if (!ordemSelecionada || ordemSelecionada.length === 0) return;

    if (etapaStart === 0) {
      const ok = await iniciarPadDaPrimeira(); // liga só o pad
      if (ok) etapaStart = 1;
    } else if (etapaStart === 1) {
      await executarSequenciaSelecionada();    // contagem + metrônomo + pad + rolagem (como hoje)
      etapaStart = 2;
    } else {
      // etapaStart === 2: já está rolando → ignora
    }
  }

  // Voltar ao início
  if (["ArrowLeft", "ArrowUp", "PageUp"].includes(e.key)) {
    resetarInicio();
  }
});




function atualizarIndicadorSlides() {
  const indicador = document.getElementById('indicadorSlides');
  indicador.innerHTML = ""; // limpa antes
  slides.forEach((_, i) => {
    if (i === 0) return; // não cria bolinha para slide de título/intro
    const bolinha = document.createElement("div");
    bolinha.className = "bolinhaSlide";
    if (i === slideAtual) {
      bolinha.classList.add("ativa");
    }
    indicador.appendChild(bolinha);
  });
}

function exibirSlideAtual() {
  const letraDiv = document.getElementById('letra');
  letraDiv.style.transition = 'top 500ms';

  if (slideAtual === 0) {
    letraDiv.innerHTML = slides[0];
  } else {
    letraDiv.innerHTML = `
      <pre class="cifraTexto">${formatarLinhasCifra(slides[slideAtual])}</pre>
    `;
  }

  letraDiv.style.top = '0px';
  atualizarIndicadorSlides();
}



function formatarIntro(introTexto) {
  if (!introTexto) return '';
  const RE_ACORDE = /^[A-G](?:#|b)?(?:maj|min|m|sus[24]?|dim|aug|add)?\d*(?:\([^)]+\))?(?:\/[A-G](?:#|b)?)?$/;

  return introTexto.split(/(\s+)/).map(tok => {
    const t = tok.trim();
    if (t && RE_ACORDE.test(t)) {
      return `<span class="acorde-intro">${tok}</span>`;
    }
    return tok.replace(/ /g, '&nbsp;');
  }).join('');
}




function formatarLinhasCifra(cifraTexto) {
  const TAB = 4;

  // Token de acorde: raiz + acidentes, sufixos (m, maj, sus, dim, aug), extensões,
  // opcional com parênteses e opcional baixo ("/nota")
const RE_ACORDE = /^\*?[A-G](?:#|b)?(?:maj|min|m|sus[24]?|dim|aug|add)?\d*(?:\([^)]+\))?(?:\/[A-G](?:#|b)?)?\*?$/;


  function protegerIndentacao(inicio) {
    // tabs do INÍCIO da linha -> espaços; depois espaços iniciais -> &nbsp;
    inicio = inicio.replace(/^\t+/g, t => ' '.repeat(t.length * TAB));
    inicio = inicio.replace(/^ +/g, s => '&nbsp;'.repeat(s.length));
    return inicio;
  }

  function ehLinhaDeAcorde(texto) {
    // true somente se cada token não-vazio (sem ser só espaço) for um acorde
    const tokens = texto.trim().split(/\s+/).filter(Boolean);
    if (tokens.length === 0) return false;
    return tokens.every(t => RE_ACORDE.test(t));
  }

  return cifraTexto.split('\n').map(linha => {
    // separa prefixo de espaços/tabs do resto
    const m = linha.match(/^\s*/);
    const inicio = protegerIndentacao(m ? m[0] : '');
    const resto  = linha.slice(m ? m[0].length : 0);

    if (ehLinhaDeAcorde(resto)) {
      // envolve APENAS os acordes individuais
      return inicio + resto.split(/(\s+)/).map(tok => {
        const t = tok.trim();
        if (t && RE_ACORDE.test(t)) return `<span class="acorde">${tok}</span>`;
        return tok.replace(/ /g, '&nbsp;');
      }).join('');
    }

    // linha de LETRA: não tocar em palavras; só preservar indentação/espaços
    return inicio + resto.replace(/ /g, '&nbsp;');
  }).join('\n');
}




const tocarMusicaOriginal = window.tocarMusica;



// ⬇ idem: acrescenta opts e usa nos pontos marcados
window.tocarMusica = async function(musica, delayTotal = 0, opts = {}) {

//zoom
document.body.style.zoom = "1.4";

  clearInterval(scrollInterval);
  pararMetronomo?.();
  if (!opts?.manterPad) pararPad?.();

  const letraDiv = document.getElementById('letra');
  const nome = musica.querySelector('nome')?.textContent.trim() || '';
  const intro = musica.querySelector('intro')?.textContent.trim() || '';
  const rolagemTag = parseFloat(musica.querySelector('rolagem')?.textContent) || 30;
  const tempo = parseInt(musica.querySelector('tempo')?.textContent) || 0;
  const ritmo = parseInt(musica.querySelector('ritmo')?.textContent) || 1;
  const tom = musica.querySelector('tom')?.textContent.trim() || 'C';
  const modoManual = document.getElementById('chManual').checked;

  // cifra (igual ao seu)
  let cifra = '';
  const raw = musica.innerHTML;
  const match = raw.match(/<cifra[^>]*>([\s\S]*?)<\/cifra>/i);
  if (match) {
    cifra = match[1].replace(/^\s+|\s+$/g, '').replace(/&lt;/g, "<").replace(/&gt;/g, ">");
  }
  if (modoManual) {
    cifra = cifra.split('\n').map(l => l.replace(/\s+$/,'')).join('\n');
  }

  rolagemAtual = rolagemTag > 1 ? rolagemTag : 30;
  document.getElementById('timeRolagem').textContent = rolagemAtual;

  // BPM/UI
  if (tempo > 0) {
    window.bpmBase   = tempo;
    window.bpmAtual  = tempo;
    window.ritmoAtual= ritmo;
    const _b = document.getElementById('bpmlink');
    if (_b) { _b.textContent = `${window.bpmAtual}`; _b.title = 'Ctrl+L ↓ | Ctrl+P ↑'; }
  }











// ✅ MODO MANUAL FLUIDO — cifra inteira + rolagem por tecla (segurar = rola, soltar = para)
// (SUBSTITUA INTEIRO O BLOCO if (modoManual) { ... } PELO CÓDIGO ABAIXO)
if (modoManual) {
  emModoManual = true;
  slides = []; // mantém vazio para não acionar a lógica antiga de slides

  // tela inicial (título + intro + cifra completa + fimAnchor)
  const tituloHTML = `<div class="tituloMusica">${nome}</div>`;
  const introHTML  = `<div class="introTexto">${formatarIntro(intro)}</div>`;
  const cifraHTML  = `<pre class="cifraTexto">${formatarLinhasCifra(cifra)}</pre>`;
  // ⚠️ fimAnchor garante que calcularTopFinal(0) funcione e a última linha pare no topo
  const fimHTML    = `<div id="fimAnchor" style="height:0; line-height:0;"></div><div class="fimMusica">&gt;&gt;&gt;&gt;&gt;</div>`;

  letraDiv.innerHTML = `${tituloHTML}${introHTML}${cifraHTML}${fimHTML}`;


// ativa o modo intro se houver acordes na intro
// ativa o modo intro se houver acordes na intro
const temIntroAcordes = document.querySelectorAll('.introTexto .acorde-intro').length > 0;
window.__introAtivo = temIntroAcordes;
window.__acordeIntroAtual = -1;




  letraDiv.style.transition = 'none';
  letraDiv.style.transform  = 'none';

  // centraliza pelo bloco visível (título + intro), antes da rolagem
  const alturaWrapper      = document.getElementById('letraWrapper').offsetHeight;
  const alturaBlocoInicial = medirAlturaHTML(`${tituloHTML}${introHTML}`);
  const topInicial         = (alturaWrapper / 2) - (alturaBlocoInicial / 2);
  letraDiv.style.top = `${topInicial}px`;

  // metrônomo/pad/contagem
  if (tempo > 0) {
    if (!opts?.pularContagem) await contagemInicial(tempo);
    iniciarMetronomo?.(tempo, ritmo);
    if (!opts?.manterPad) {
      iniciarPadSuave?.(tom);
      try { if (window.padAudio) window.padAudio.playbackRate = 1.0; } catch(_) {}
    }
  }

  // ====== CONTROLES DE TECLADO (hold-to-scroll) ======
  const downKeys = new Set();

  function cleanup() {
    stopManualScroll();
    manualScroll.onEnd = null;
    document.removeEventListener('keydown', keyDownHandler, true);
    document.removeEventListener('keyup',   keyUpHandler,   true);
    emModoManual = false;
    pararMetronomo?.();
    if (!opts?.manterPad) pararPad?.();
  }




// tempo máximo para considerar um "tap" (ms)
// tempo máximo para considerar um "tap" (ms)
const TAP_MS = 180;
const __tapTimes = new Map();

// ⬇️ novas teclas que contam como "passo por acorde"
const NAV_TAP_KEYS = new Set(["ArrowRight","ArrowLeft","PageDown","PageUp"]);

function keyDownHandler(e) {
  // marca instante do keydown para tap
  if (NAV_TAP_KEYS.has(e.key)) {
    __tapTimes.set(e.key, performance.now());
  }

  // ===== rolagem suave ao SEGURAR (mantém seu comportamento atual) =====
  if (["ArrowRight","ArrowDown","PageDown"].includes(e.key)) {
    e.preventDefault();
    downKeys.add(e.key);
    startManualScroll(1, e.shiftKey);
  }
  if (["ArrowLeft","ArrowUp","PageUp"].includes(e.key)) {
    e.preventDefault();
    downKeys.add(e.key);
    startManualScroll(-1, e.shiftKey);
  }

  // (resto do seu keyDownHandler: Enter/Espaço/Esc/End etc.)
}

function keyUpHandler(e) {
  // soltar tecla: se nenhuma outra está pressionada, parar suave
  if (downKeys.has(e.key)) {
    downKeys.delete(e.key);
    const algumaPressionada = ["ArrowRight","ArrowDown","PageDown","ArrowLeft","ArrowUp","PageUp"]
      .some(k => downKeys.has(k));
    if (!algumaPressionada) stopManualScroll(true);
  }

  // ===== TAP curto → passo por acorde (incluindo PageDown/PageUp) =====
  if (NAV_TAP_KEYS.has(e.key)) {
    const t0 = __tapTimes.get(e.key) || 0;
    const dur = performance.now() - t0;
    __tapTimes.delete(e.key);

    if (dur <= TAP_MS) {
      // toque curto → não queremos scroll continuado
      stopManualScroll(false);

      // 1) Se ainda estamos na INTRO, consumir aqui primeiro
      if (window.__introAtivo) {
        const passo = (e.key === "ArrowRight" || e.key === "PageDown") ? +1 : -1;
        const ok = avancarIntro(passo);
        if (ok) return; // ainda na intro, já usamos a tecla
        // se a intro terminou (ok=false), cai para a cifra abaixo
      }

      // 2) Cifra: acorde por acorde
      const acordes = Array.from(document.querySelectorAll('#letra pre.cifraTexto .acorde'));
      if (acordes.length) {
        let idx = (window.__acordeAtual ?? -1);
        const passo = (e.key === "ArrowRight" || e.key === "PageDown") ? +1 : -1;
        idx = Math.max(0, Math.min(idx + passo, acordes.length - 1));
        centralizarAcordePorIndice(idx); // já destaca + (se ligado) toca o pad do acorde
      }
    } else {
      // segurar → mantém rolagem suave
      stopManualScroll(true);
    }
  }

  // (resto do seu keyUpHandler, se houver)
}








  document.addEventListener('keydown', keyDownHandler, true);
  document.addEventListener('keyup',   keyUpHandler,   true);

  // Quando atingir o fim (última linha no TOPO) e segurar 0.5s, avança sozinho
  return await new Promise((resolver) => {
    manualScroll.onEnd = () => { cleanup(); resolver(); };
  });
}















  // ✅ AUTOMÁTICO — mantém comportamento original
  return await tocarMusicaOriginal(musica, delayTotal);
};





</script>


<script>
// 🔹 inicia #teoria oculto
document.getElementById("teoria").style.display = "none";

document.getElementById("divTeoria").addEventListener("click", () => {
  const teoria = document.getElementById("teoria");
  const cifra = document.getElementById("cifra");

  if (teoria.style.display === "none" || teoria.style.display === "") {
    // mostra teoria, esconde cifra
    teoria.style.display = "block";
    cifra.style.display = "none";
  } else {
    // mostra cifra, esconde teoria
    teoria.style.display = "none";
    cifra.style.display = "block";
  }
});

</script>



<script>
document.addEventListener("keydown", (e) => {
  if (!e.ctrlKey || !musicaEmExecucao) return;
  if (e.key.toLowerCase() === "l") { // Ctrl+L: diminuir BPM
    e.preventDefault();
    alterarBpm(window.bpmAtual - 1);
  }
  if (e.key.toLowerCase() === "p") { // Ctrl+P: aumentar BPM
    e.preventDefault();
    alterarBpm(window.bpmAtual + 1);
  }
});

function alterarBpm(novo) {
  if (!window.bpmBase || !window.ritmoAtual) return;
  window.bpmAtual = Math.max(30, Math.min(240, novo)); // limites
  iniciarMetronomo(window.bpmAtual, window.ritmoAtual);
  if (window.padAudio) {
    const rate = Math.max(0.5, Math.min(2, window.bpmAtual / window.bpmBase));
    window.padAudio.playbackRate = rate;
  }
  const bpmLink = document.getElementById("bpmlink");
  if (bpmLink) bpmLink.textContent = `${window.bpmAtual}`;
}
</script>




<script>
(function () {
  // ===== Configuração =====
  const RESET_MS = 3000;        // se ficar mais de 3s sem tap, reinicia a contagem
  const MAX_SAMPLES = 8;        // quantos intervalos recentes usar na média
  const ROUND_TO = 1;           // arredondamento do BPM (0 sem arredondar, 1 = inteiro)

  // ===== Pega elementos =====
  // Tenta achar o botão existente "BPM BATIDA". Se não tiver id, cria.
  let btnTap = Array.from(document.querySelectorAll("button"))
    .find(b => b.textContent.trim().toUpperCase() === "BPM BATIDA");

  if (!btnTap) {
    console.warn("Botão 'BPM BATIDA' não encontrado.");
    return;
  }
  btnTap.id = btnTap.id || "btnBpmTap";

  const resultadoEl = document.getElementById("resultadoBPM");
  if (!resultadoEl) {
    console.warn("Elemento #resultadoBPM não encontrado.");
    return;
  }

  // ===== Estado =====
  let tapMode = false;
  let lastTap = 0;
  let intervals = [];

  // ===== Áudio (fallback para o baixo em A) =====
  function playBassAFallback() {
    try {
      const Ctx = window.AudioContext || window.webkitAudioContext;
      const ctx = new Ctx();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.type = "sine";
      osc.frequency.value = 110;     // A2 ~ 110 Hz
      gain.gain.setValueAtTime(0.8, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.25);
      osc.connect(gain).connect(ctx.destination);
      osc.start();
      osc.stop(ctx.currentTime + 0.25);
    } catch (e) {
      // se o navegador bloquear, silêncio é aceitável
    }
  }

  function playBassA() {
    // Se tua função tocarNotaBaixo existir, use-a com o clock atual;
    // caso contrário, usa o fallback simples.
    try {
      if (typeof tocarNotaBaixo === "function") {
        // tenta reutilizar o audioCtx global se existir, senão cria
        let ctx;
        if (typeof audioCtx !== "undefined" && audioCtx) {
          ctx = audioCtx;
        } else {
          const Ctx = window.AudioContext || window.webkitAudioContext;
          ctx = new Ctx();
        }
        tocarNotaBaixo("A", ctx.currentTime, true);
      } else {
        playBassAFallback();
      }
    } catch {
      playBassAFallback();
    }
  }

  // ===== Cálculo do   a partir dos taps =====
  function calcAndShowBpm() {
    if (intervals.length === 0) {
      resultadoEl.textContent = "—";
      return;
    }
    // média dos últimos N intervalos
    const use = intervals.slice(-MAX_SAMPLES);
    const avgMs = use.reduce((a, b) => a + b, 0) / use.length;
    let bpm = 60000 / avgMs;

    if (ROUND_TO > 0) bpm = Math.round(bpm / ROUND_TO) * ROUND_TO;

    // limitações opcionais (30–260 bpm)
    bpm = Math.max(30, Math.min(260, bpm));

    resultadoEl.textContent = String(bpm);
  }

  // ===== Ativa/Desativa modo TAP =====
  function setTapMode(on) {
    tapMode = on;
    intervals = [];
    lastTap = 0;
    calcAndShowBpm();

    btnTap.classList.toggle("tap-ativo", on);
    btnTap.title = on ? "TAP ativo — use a tecla ESPAÇO" : "Clique para ativar o TAP";
  }

  btnTap.addEventListener("click", () => {
    setTapMode(!tapMode);
  });

  // ===== Captura da tecla ESPAÇO =====
  document.addEventListener("keydown", (e) => {
    if (!tapMode) return;
    if (e.code !== "Space") return;

    // evita scroll da página ao apertar espaço
    e.preventDefault();

    const now = performance.now();

    // toca o baixo a cada tap
    playBassA();

    // reinicia se ficou muito tempo sem tap
    if (!lastTap || now - lastTap > RESET_MS) {
      lastTap = now;
      intervals = [];
      calcAndShowBpm();
      return;
    }

    const delta = now - lastTap;
    lastTap = now;

    // descarta intervalos muito fora (opcional)
    if (delta < 100 || delta > 4000) {
      // <100ms (erro) ou >4s (muito lento) — ignora
      calcAndShowBpm();
      return;
    }

    intervals.push(delta);
    calcAndShowBpm();
  });

  // estilo sutil quando ativo (opcional)
  const style = document.createElement("style");
  style.textContent = `
    #${btnTap.id}.tap-ativo {
      outline: 2px solid #1e90ff;
      box-shadow: 0 0 12px rgba(30,144,255,.5) inset;
    }
  `;
  document.head.appendChild(style);

  // Inicializa display
  resultadoEl.textContent = "—";
})();
</script>









<script>
/* === RESYNC NO ESPAÇO — COM LOGS DE DEBUG (não bloqueia o TAP) === */
(function () {
  const TAG = "[SYNC]";
  const PERMITIR_EM_MODO_MANUAL = true;

  function tapAtivo() {
    const btn = document.getElementById("btnBpmTap");
    return !!(btn && btn.classList.contains("tap-ativo"));
  }

  function estado() {
    const hasCtx = (typeof audioCtx !== "undefined") && !!audioCtx;
    const hasMet = (typeof metronomeInterval !== "undefined") && !!metronomeInterval;
    return {
      hasAudioCtx: hasCtx,
      hasMetronome: hasMet,
      emModoManual: (typeof emModoManual !== "undefined") ? emModoManual : false,
      tapAtivo: tapAtivo(),
      bpmAtual: (typeof bpmAtual !== "undefined") ? bpmAtual : window.bpmAtual,
      bpmBase: (typeof bpmBase !== "undefined") ? bpmBase : window.bpmBase,
      ritmoAtual: (typeof ritmoAtual !== "undefined") ? ritmoAtual : window.ritmoAtual,
      contagem: (typeof contagem !== "undefined") ? contagem : "(indisp.)",
      nextNoteTime: (typeof nextNoteTime !== "undefined") ? nextNoteTime : "(indisp.)",
      currentTime: hasCtx ? audioCtx.currentTime : "(sem audioCtx)"
    };
  }

  function getBpmRitmo() {
    const st = estado();
    return { bpm: (st.bpmAtual ?? st.bpmBase ?? 120), ritmo: (st.ritmoAtual ?? 1) };
  }

  function resyncMetronomo() {
    const st = estado();
    console.log(TAG, "RESYNC requisitado — estado inicial:", st);

    if (!st.hasAudioCtx || !st.hasMetronome) {
      console.warn(TAG, "Sem audioCtx/metronome — não dá pra resync agora.");
      return;
    }
    if (!PERMITIR_EM_MODO_MANUAL && st.emModoManual) {
      console.warn(TAG, "emModoManual=true e bloqueado por configuração.");
      return;
    }
    if (st.tapAtivo) {
      console.warn(TAG, "TAP ativo — não vou resync.");
      return;
    }

    const { bpm, ritmo } = getBpmRitmo();
    console.log(TAG, `Chamando iniciarMetronomo(${bpm}, ${ritmo})`);

    try { audioCtx.resume && audioCtx.resume(); } catch {}
    if (typeof iniciarMetronomo !== "function") {
      console.error(TAG, "iniciarMetronomo não existe.");
      return;
    }

    const antes = {
      contagem: (typeof contagem !== "undefined") ? contagem : "(indisp.)",
      nextNoteTime: (typeof nextNoteTime !== "undefined") ? nextNoteTime : "(indisp.)",
      currentTime: audioCtx.currentTime
    };
    console.log(TAG, "ANTES de iniciarMetronomo:", antes);


	window.__metronomeMuted = true;

    iniciarMetronomo(bpm, ritmo);

    const depois = {
      contagem: (typeof contagem !== "undefined") ? contagem : "(indisp.)",
      nextNoteTime: (typeof nextNoteTime !== "undefined") ? nextNoteTime : "(indisp.)",
      currentTime: audioCtx.currentTime
    };
    console.log(TAG, "DEPOIS de iniciarMetronomo:", depois);

    try {
      const tomAtual =
        (typeof musicaEmExecucao !== "undefined" && musicaEmExecucao
          && musicaEmExecucao.querySelector("tom")
          && musicaEmExecucao.querySelector("tom").textContent.trim())
        || "C";
      const when = audioCtx.currentTime + 0.03;
      console.log(TAG, `Downbeat agendado: tom=${tomAtual}, when=${when.toFixed(3)}s`);
      if (typeof tocarNotaBaixo === "function") {
        tocarNotaBaixo(tomAtual, when, true);
      }
      setTimeout(() => {
        console.log(TAG, "Confirmação pós-downbeat:", {
          contagem: (typeof contagem !== "undefined") ? contagem : "(indisp.)",
          nextNoteTime: (typeof nextNoteTime !== "undefined") ? nextNoteTime : "(indisp.)",
          currentTime: audioCtx.currentTime
        });
      }, 120);
    } catch (e) {
      console.error(TAG, "Falha ao agendar downbeat:", e);
    }
  }

  // 🔧 Handler ESPAÇO: só bloqueia o evento quando vamos RESYNC de fato.
  window.addEventListener("keydown", function (e) {
    if (e.code !== "Space") return;

    const st = estado();
    console.log(TAG, "ESPAÇO lido:", st);

    // 1) Se TAP está ativo → NÃO bloqueia; deixa o evento fluir para o TAP
    if (st.tapAtivo) {
      console.log(TAG, "TAP ativo — liberando evento para o medidor de BPM.");
      return;
    }

    // 2) Se metrônomo não está rodando → também não bloqueia (TAP pode usar)
    if (!st.hasMetronome) {
      console.log(TAG, "Metrônomo OFF — liberando evento (TAP/teclas).");
      return;
    }

    // 3) Aqui sim: vamos ressync → bloqueia a tecla e ressincroniza
    e.preventDefault();
    e.stopImmediatePropagation();
    resyncMetronomo();
  }, { capture: true });

  console.log(TAG, "Handler instalado (não bloqueia TAP nem metrônomo OFF).");
})();
</script>











<script>
/* === LUZES EM CASCATA (mesa de som) ===
   - Liga 1→2→3→(4→5) com step curto
   - Segura todas acesas por hold curto
   - Desliga em ordem inversa (5→4→…→1)
   - #bola1 liga primeiro e apaga por último
*/
(function () {
  const CFG = {
    baseOpacity: 0.25,
    stepOnMs: 15,   // intervalo entre ligar cada bola (rápido)
    holdMs: 50,     // tempo com TODAS acesas antes de começar a desligar
    stepOffMs: 35,  // intervalo entre desligar cada bola (inverso)
    fadeMs: 70      // duração do fade para voltar à base
  };

  const bolas = [
    document.getElementById("bola1"),
    document.getElementById("bola2"),
    document.getElementById("bola3"),
    document.getElementById("bola4"),
    document.getElementById("bola5"),
  ].filter(Boolean);

  if (bolas.length < 5) {
    console.warn("[BATIDA] faltam bolas (#bola1..#bola5).");
    return;
  }

  // estado inicial
  bolas.forEach(el => {
    el.style.opacity = String(CFG.baseOpacity);
    el.style.transition = "opacity 0ms";
    el.style.willChange = "opacity";
  });

  function cancelTimers(el) {
    if (el._onT)  { clearTimeout(el._onT);  el._onT  = null; }
    if (el._offT) { clearTimeout(el._offT); el._offT = null; }
  }

  function ligarInstant(el) {
    el.style.transition = "opacity 0ms";
    el.style.opacity = "1";
  }
  function desligarComFade(el) {
    el.style.transition = `opacity ${CFG.fadeMs}ms linear`;
    el.style.opacity = String(CFG.baseOpacity);
  }

  function cascata(count) {
    // limpa timers e garante extras (se houver) na base
    for (let i = 0; i < bolas.length; i++) {
      cancelTimers(bolas[i]);
      if (i >= count) {
        bolas[i].style.transition = "opacity 0ms";
        bolas[i].style.opacity = String(CFG.baseOpacity);
      }
    }

    // 1) LIGAR 1→...→count
    for (let i = 0; i < count; i++) {
      const el = bolas[i];
      el._onT = setTimeout(() => ligarInstant(el), i * CFG.stepOnMs);
    }

    // 2) HOLD com todas acesas
    const allOnAt = (count - 1) * CFG.stepOnMs; // instante em que a última acende
    const startOffAt = allOnAt + CFG.holdMs;

    // 3) DESLIGAR inverso: count→...→1
    for (let k = count - 1; k >= 0; k--) {
      const el = bolas[k];
      const order = (count - 1) - k; // 0,1,2,...
      el._offT = setTimeout(() => desligarComFade(el), startOffAt + order * CFG.stepOffMs);
    }
  }

  // agenda pelo clock do áudio
  function scheduleVisual(when, isForte) {
    const count = isForte ? 5 : 3;
    try {
      if (typeof audioCtx !== "undefined" && audioCtx) {
        const delayMs = Math.max(0, (when - audioCtx.currentTime) * 1000);
        setTimeout(() => cascata(count), delayMs);
      } else {
        cascata(count);
      }
    } catch {
      cascata(count);
    }
  }

  // patch em tocarNotaBaixo
  function patch() {
    if (typeof window.tocarNotaBaixo !== "function" || window._visualBeatPatchedMixer) return false;
    const _orig = window.tocarNotaBaixo;
    window.tocarNotaBaixo = function (tom, when, isTonica = true) {
      try { scheduleVisual(when, !!isTonica); } catch {}
      return _orig.apply(this, arguments);
    };
    window._visualBeatPatchedMixer = true;
    return true;
  }

  if (!patch()) {
    let tries = 0;
    const t = setInterval(() => {
      if (patch() || ++tries > 80) clearInterval(t);
    }, 25);
  }
})();
</script>


<script>
// --- REMOVE o evento antigo do playButton ---
playButton.replaceWith(playButton.cloneNode(true));
// (isso remove todos os listeners do botão Play)

// --- ADICIONA no letraWrapper ---
document.getElementById('letraWrapper').addEventListener('click', async () => {
  autoHideMenuIfMulti(); // mantém a lógica de esconder menu/tela cheia
  iniciarContagemRegressiva();

  const delayInicial = parseInt(document.getElementById('delayInicial').value) || 0;
  const delayEntre   = parseInt(document.getElementById('delayEntreMusicas').value) || 0;

  for (let i = 0; i < ordemSelecionada.length; i++) {
    const index = ordemSelecionada[i];
    const musica = musicas[index];
    const baseDelay = parseFloat(musica.querySelector('delay')?.textContent) || 0;
    const delayExtra = i === 0 ? delayInicial : delayEntre;
    await tocarMusica(musica, baseDelay + delayExtra);
  }
});

</script>












<script>


// Estado global
window.__acordeAtual = -1;
const __tapTimes = new Map();
const TAP_MS = 180;

function obterTodosAcordes() {
  return Array.from(document.querySelectorAll('#letra pre.cifraTexto .acorde'));
}






// bases memorizadas 1x
window.__padVolBase   = window.__padVolBase   ?? (window.__padVol   ?? 0.65);
window.__baixoVolBase = window.__baixoVolBase ?? (window.__baixoVol ?? 0.45);
window.__volBoost = window.__volBoost ?? false;

// +25%
function __aplicarVolumesBoost(ativo){
  const mult = ativo ? 2 : 1.0;
  window.__padVol   = Math.min(1, window.__padVolBase   * mult);
  window.__baixoVol = Math.min(1, window.__baixoVolBase * mult);
}








function centralizarAcordePorIndice(idx) {
  const wrapper = document.getElementById('letraWrapper');
  const letra   = document.getElementById('letra');
  const acordes = obterTodosAcordes();
  if (!wrapper || !letra || acordes.length === 0) return;

  idx = Math.max(0, Math.min(idx, acordes.length - 1));
  const alvo = acordes[idx];

  // limpa anteriores e aplica destaque só no acorde atual
  document.querySelectorAll('#letra .acorde.destacado')
    .forEach(el => el.classList.remove('destacado'));
  alvo.classList.add('destacado');

  // centraliza verticalmente
  const wrapperH = wrapper.offsetHeight;
  const mid = alvo.offsetTop + alvo.offsetHeight/2;
  let novoTop = (wrapperH/2) - mid - 200; //ALTURA NA TELA DO DESTAQUE

  letra.style.transition = "top 0.25s ease";
  letra.style.top = novoTop + "px";
  setTimeout(()=>{ letra.style.transition = "none"; }, 260);

  window.__acordeAtual = idx;

// --- BOOST 25% entre *INICIO . FIM* ---
const raw = alvo.textContent.trim();
const leading  = raw.startsWith('*');  // *C  => liga boost a partir deste
const trailing = raw.endsWith('*');    // G*  => desliga boost após este
const acordeLimpo = raw.replace(/\*/g, '').trim();

// este acorde já toca com boost se o estado estava ativo OU começa com *
const boostAgora = window.__volBoost || leading;
__aplicarVolumesBoost(boostAgora);

// depois de __aplicarVolumesBoost(boostAgora);
if (window.padAudio && window._padTomAtual && __extrairPadTom(acordeLimpo) === window._padTomAtual) {
  try {
    const v = Math.max(0, Math.min(1, window.__padVol ?? window.padAudio.volume));
    window.padAudio.volume = v;
  } catch(_) {}
}


// tocar pad/baixo usando o acorde sem asterisco
tocarPadDoAcorde(acordeLimpo);
iniciarBaixoDoAcorde(acordeLimpo);

// atualizar estado para os próximos acordes
if (trailing)      window.__volBoost = false;
else if (leading)  window.__volBoost = true;


// (se nenhum leading/trailing, mantém o estado atual)
  const raiz = (alvo.textContent.trim().match(/^[A-G](?:#|b)?/i) || ['?'])[0].toUpperCase();

  console.log(`[PAD] acorde="${alvo.textContent.trim()}" → raiz="${raiz}" (trocando PAD)`);

}


</script>












<script>

document.addEventListener("keydown", (ev) => {
  if (ev.target.tagName === "INPUT" || ev.target.isContentEditable) return;

  // --- tecla "m" → alterna som do metrônomo ---
  if (ev.key.toLowerCase() === "m") {
    window.__metronomeMuted = !window.__metronomeMuted;
    console.log("Metrônomo", window.__metronomeMuted ? "MUDO" : "ATIVO");
    return;
  }


// --- tecla "p" → liga/desliga pad ---
// tecla "p" → liga/desliga pad com fade
if (ev.key.toLowerCase() === 'p' && !ev.repeat) {
  ev.preventDefault();
  if (window.__padLigado) {
    pararPadSuave(220);
    window.__padLigado = false;
  } else {
    window.__padLigado = true;
    // se já existe um acorde em destaque (intro ou cifra), liga nele
    const el = document.querySelector('.acorde.destacado, .acorde-intro.destacado');
    const acorde = el?.textContent?.trim();
    if (acorde) {
      tocarPadDoAcorde(acorde);
    } else if (window._padTomAtual) {
      iniciarPadSuave(window._padTomAtual, 220);
    }
  }
  return;
}

// --- tecla "b" → liga/desliga o baixo sustentado ---
  if (ev.key.toLowerCase() === 'b' && !ev.repeat) {
    ev.preventDefault();
    window.__baixoLigado = !window.__baixoLigado;
    if (!window.__baixoLigado) {
      pararBaixo(true);
    } else {
      const el = document.querySelector('.acorde.destacado, .acorde-intro.destacado');
      const acorde = el?.textContent?.trim();
      if (acorde) iniciarBaixoDoAcorde(acorde);
    }
    return;
  }


});





</script>




















<script>
(() => {
  window.__baixoLigado = (typeof window.__baixoLigado==='boolean') ? window.__baixoLigado : true;
  window.__baixoVol = window.__baixoVol ?? 0.5;
  window.__baixoInicialFator = window.__baixoInicialFator ?? 0.60;
  window.__baixoSustain = window.__baixoSustain ?? 0.30;
  window.__baixoEnvTempo = window.__baixoEnvTempo ?? 0.5;

  let state = { osc:null, gain:null, filt:null };

  const NOTES = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
  const IDX = Object.fromEntries(NOTES.map((n,i)=>[n,i]));
  const ALIAS = { DB:"C#", EB:"D#", GB:"F#", AB:"G#", BB:"A#" };
  const FREQ  = {"C":65.41,"C#":69.30,"D":73.42,"D#":77.78,"E":82.41,"F":87.31,
                 "F#":92.50,"G":98.00,"G#":103.83,"A":110.00,"A#":116.54,"B":123.47};

  const norm = n => (ALIAS[(n||"").toUpperCase()] || (n||"").toUpperCase());
  const transpose = (note, semi) => {
    const r = norm(note); if (IDX[r]==null) return null;
    return NOTES[(IDX[r] + (semi%12) + 12) % 12];
  };

  const parseChord = (ch) => {
    ch = String(ch||"").trim();
    const mRoot = ch.match(/^([A-G](?:#|b)?)/i);
    if (!mRoot) return {root:null};
    const root = norm(mRoot[1]);
    const rest = ch.slice(mRoot[0].length);

    const hasMaj7 = /maj7|\bM7\b/i.test(rest);
    const minor   = /(?:^|[^a-z])m(?!aj)|(?:^|[^a-z])min\b|(?:^|[^a-z])-(?!aj)/i.test(rest);
    const has7    = /\b7\b/.test(rest) && !hasMaj7;
    const has9    = /\b9\b/.test(rest);
    const has11   = /\b11\b/.test(rest);
    const has4    = /sus4|\b4\b|add4/i.test(rest) || has11;

    const mSlash = rest.match(/\/\s*([A-G](?:#|b)?)/i);
    const slash  = mSlash ? norm(mSlash[1]) : null;

    return {root, minor, has7, hasMaj7, has9, has11, has4, slash};
  };

  const targetNote = (ch) => {
    const info = parseChord(ch);
    if (!info.root) return null;

    if (info.slash)         return { note: info.slash, origin: 'slash', info };
    if (info.has7 || info.hasMaj7) {
      const semi = info.hasMaj7 ? 11 : 10;
      return { note: transpose(info.root, semi), origin: '7', info };
    }
    if (info.has9)          return { note: transpose(info.root, 2), origin: '9', info };
    if (info.has4 || info.has11)
                            return { note: transpose(info.root, 5), origin: '4', info };
    if (info.minor)         return { note: transpose(info.root, 3), origin: 'min3', info };
    return { note: info.root, origin: 'root', info };
  };



	function noteToAudibleBassFreq(note, origin) {
	  note = norm(note);
	  const f = FREQ[note];
	  if (!f) return null;

	  // ponto de partida: uma oitava abaixo
	  let freq = f / 2;

	  // piso por função (root pode ser mais grave)
	  const piso = (origin === 'root') ? 70 : 70;
	  while (freq < piso) freq *= 2;

	  return freq;
	}


  window.pararBaixo = function(){
    if (!state.osc || !state.gain) return;
    const ctx = state.osc.context;
    const t = ctx.currentTime;
    try {
      const g = state.gain.gain;
      g.cancelScheduledValues(t);
      g.setValueAtTime(g.value || 0.0001, t);
      g.exponentialRampToValueAtTime(0.0001, t + 0.02);
      state.osc.stop(t + 0.03);
    } catch {}
    state = { osc:null, gain:null, filt:null };
  };

  window.iniciarBaixoDoAcorde = function(chord){
    if (!window.__baixoLigado) return;
    if (typeof __initAudioCtx__ === 'function') __initAudioCtx__();
    const ctx = (typeof audioCtx!=='undefined' && audioCtx) ? audioCtx : new (window.AudioContext||window.webkitAudioContext)();

    const tgt = targetNote(chord);
    if (!tgt || !tgt.note) return;

    const freq = noteToAudibleBassFreq(tgt.note, tgt.origin);
    if (!freq) return;

    // >>> DEBUG LOG <<<
    const root = tgt.info.root;
    const n3   = tgt.info.minor ? transpose(root,3) : transpose(root,4); // terça
    const n5   = transpose(root,7);                                      // quinta
    console.log(`[BAIXO] Acorde: ${chord} | Notas: ${root},${n3},${n5} | Baixo: ${tgt.note} (${tgt.origin}) -> ${freq.toFixed(1)}Hz`);

    pararBaixo();

    const osc  = ctx.createOscillator();
    const filt = ctx.createBiquadFilter();
    const gain = ctx.createGain();

    osc.type = 'sine';
    osc.frequency.setValueAtTime(freq, ctx.currentTime);

    filt.type = 'lowpass';
    filt.frequency.value = (tgt.origin === 'root') ? 600 : 800;

    const base = Math.min(1, Math.max(0, window.__baixoVol));
    const vIni = base * window.__baixoInicialFator;
    const vSus = base * window.__baixoSustain;
    const t0 = ctx.currentTime + 0.01;

    gain.gain.setValueAtTime(0.0001, t0);
    gain.gain.exponentialRampToValueAtTime(Math.max(0.0002, vIni), t0 + 0.04);
    gain.gain.linearRampToValueAtTime(vSus, t0 + window.__baixoEnvTempo);

    osc.connect(filt).connect(gain).connect(ctx.destination);
    osc.start(t0);

    state = { osc, gain, filt };
  };
})();
</script>




</body>
</html>
