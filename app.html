<!-- Salve como VIOLAO_FINGERSTYLE.html -->
<!-- === BLOCO DE DADOS EM XML (cole / edite suas músicas aqui) === -->
<script id="musicas-xml" type="application/xml">
<musicas>


<musica>
	<titulo>...</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
C C7 D D7 D Dm D/C# D/F#
	]]>
	</cifra>
</musica>


<musica>
	<titulo>Poder para Salvar</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
F2            C                   Am7
  Todos necessitam de um amor perfeito
   G          F
Perdão e compaixão
            C                    Am7
Todos necessitam de graça e esperança
      G          F  G  F  G
De um Deus que salva
--
C                 G
Cristo move as montanhas
        F           C
E tem poder pra salvar
      Am7        G4
Tem poder pra salvar
--
    C                     G
Pra sempre, Autor da salvação
        F         C
Jesus a morte venceu
        Am7      G
Sobre a morte venceu
--
C/F                     C9                C9/A
   Me aceitas com meus medos, falhas e temores
C2/G         C2/F
Enche meu viver
                 C2
A minha vida entrego
                 C2/A    C2/G      F  G  F  G
Pra seguir teus passos, a ti me rendo ooooo
--
C                 G
Cristo move as montanhas
        F           C
E tem poder pra salvar
      Am7        G
Tem poder pra salvar
--
    C                     G
Pra sempre, Autor da salvação
        F         C
Jesus a morte venceu
        Am7      G
Sobre a morte venceu
--
F            C              G
 Possa o mundo ver brilhar a luz
   Am  F            C            G    Am  F
Cantamos para a glória do Senhor Jesus Cristo
            C              G
Possa o mundo ver brilhar a luz
   Am  F            C            G
Cantamos para a glória do Senhor Jesus
--
C                 G
Cristo move as montanhas
        F           C
E tem poder pra salvar
      Am7        G
Tem poder pra salvar
--
    C                     G
Pra sempre, Autor da salvação
        F         C
Jesus a morte venceu
        Am7      G4
Sobre a morte venceu
	]]>
	</cifra>
</musica>



<musica>
	<titulo>Senhor, Te Quero</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
C                            F
 Eu te busco, te procuro óh Deus
Am            G    F
 No silêncio tu estás
C                          F
 Eu te busco, toda hora espero em ti, revela-te a mim
Am                G    F
 Conhecer-te eu quero mais
--
C            G
 Senhor te quero
Am        F
 Quero ouvir tua voz
C             G    F
 Senhor, te quero mais
--
C         G
 Quero tocar-te
Am             F
 Tua face eu quero ver
C             G    F
 Senhor, te quero mais
--
C                              F
 Prosseguindo, para o alvo eu vou
Am        G      F
 A coroa conquistar
C                        F
 Vou lutando, nada pode me impedir, eu vou te seguir
Am                G    F
 Conhecer-te eu quero mais
--
C            G
 Senhor te quero
Am        F
 Quero ouvir tua voz
C             G    F
 Senhor, te quero mais
--
C         G
 Quero tocar-te
Am             F
 Tua face eu quero ver
C             G    F
 Senhor, te quero mais
--
G  F  C
--
C                              F
 Prosseguindo, para o alvo eu vou
Am        G      F
 A coroa conquistar
C                        F
 Vou lutando, nada pode me impedir, eu vou te seguir
Am                G    F
 Conhecer-te eu quero mais
--
C            G9
 Senhor te quero
Am        F
 Quero ouvir tua voz
C             G    F
 Senhor, te quero mais
--
C         G9
 Quero tocar-te
Am             F
 Tua face eu quero ver
C             G    F
 Senhor, te quero mais
	]]>
	</cifra>
</musica>


<musica>
	<titulo>Vim Para Adorar-Te</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
 C      G
Luz do mundo
  Dm       F
Viestes à Terra
  C           G
Pra que eu pudesse
 F
Te ver
--
 C     G
Tua beleza me
 Dm        F
Leva a adorar-te
  C       G
Quero contigo
 F
Viver
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim
--
C       G
Eterno rei
     Dm         F
Exaltado nas alturas
  C  G    F
Glorioso nos céus
--
   C      G
Humilde vieste
   Dm         F
À Terra que criaste
 C        G
Por amor pobre
 F
Se fez
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim
--
    G     Am  F
Eu nunca saberei o preço
F      G     Am    F
Dos meus pecados lá na cruz

    G     Am  F
Eu nunca saberei o preço
F      G     Am    F
Dos meus pecados lá na cruz
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim
--
F7+                C
Vim para adorar-te
C                  G
Vim para prostrar-me
G             Am             F
Vim para dizer que és meu Deus
--
F7+                 C
És totalmente amável
C               G
Totalmente digno
G            Am        F
Tão maravilhoso para mim
	]]>
	</cifra>
</musica>


<musica>
	<titulo>Em Jesus Amigo Temos</titulo>
	<tom>G</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
G   G7       C   C9/C#
Em Jesus amigo te..mos
G   D/F#   Em           Am    D
Mais chegado que um irmão

G  G7         C   C9/C#
Ele manda que levemos
G      Em Am     D   G
Tudo a   Deus em oração
--
D      D7          G   G7
Oh! que paz perdemos sempre
C       G/B      Am  D
Oh! que dor no coração
G    G7           C   C9/C#
Só porque nós não leva..mos
G   Em  Am     D   G
Tu - do a Deus em ora..ção.
--
G    G7       C   C9/C#
Temos lidas e pesa..res
G D/F#   Em       Am D
E    na   vida tentação
G    G7          C    C9/C#
Não ficamos sem confor..to
G Em   Am       D G
Indo   a Cristo em oração
--
D  D7          G  G7
Haverá um outro ami..go
C      G/B        Am   D
De tão grande compaixão?
G    G7           C   C9/C#
Os contritos, Jesus Cristo
G   Em   Am      D    G
sem - pre atende em ora..ção
--
G   G7        C   C9/C#
E se nós desfalece..mos
G  D/F#    Em         Am   D
Cris - to estende-nos a mão
G     G7            C     C9/C#
Pois é sempre a nossa for...ça
G Em  Am      D G
E     refúgio em oração
--
D      D7          G   G7
Se este mundo nos despre..za
C        G/B       Am   D
Cristo é nosso em oração
G      G7         C   C9/C#
Em Seus braços nos aco..lhe
G Em  Am    D  G
E    nos dá consolação
	]]>
	</cifra>
</musica>


<musica>
	<titulo>Quão Grande É o Meu Deus</titulo>
	<tom>D</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
       D
Quão grande é o meu Deus
      A/C#  Bm7
Cantarei  quão grande é o meu Deus
         Bm/A   G9
E todos hão de ver
       G/A           D   G/A
Quão grande é o meu Deus
--
    D
Com esplendor de um Rei
    Bm7
Em majestade e luz
                    G9
Faz a Terra se alegrar
                    Em
Faz a Terra se alegrar

D
Ele é a própria luz
       Bm7
E as trevas vão fugir
                G9
Tremer com sua voz
                G/A
Tremer com sua voz
---
       D
Quão grande é o meu Deus
      A/C#  Bm7
Cantarei  quão grande é o meu Deus
         Bm/A   G9
E todos hão de ver
       G/A           D   G/A
Quão grande é o meu Deus
--
     D
Por gerações Ele é
   Bm7
O tempo está em tuas mãos
              G9
O começo e o fim
             G/A
O começo e o fim

  D
Três se formam em um
 Bm7
Filho, Espírito e Pai
             G9
Cordeiro e leão
             G/A
Cordeiro e leão
---
       D
Quão grande é o meu Deus
      A/C#  Bm7
Cantarei  quão grande é o meu Deus
         Bm/A   G9
E todos hão de ver
       G/A           D   G/A
Quão grande é o meu Deus
----
       D
Sobre todo nome é o seu
       Bm7
Tu és digno do louvor
    G9             G/A           D
Eu cantarei quão grande é o meu Deus
         Ab/Bb
É o meu Deus
	]]>
	</cifra>
</musica>


<musica>
	<titulo>Cantarei Teu Amor Pra Sempre</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
C
   Dos montes corre para o mar
Dm7
    Teu rio de amor por mim
F9                                  G
    Eu abrirei meu coração
                                     C
deixando Tua cura entrar
--
C
    Me alegro por te pertencer
Dm7
     Levantarei as minhas mãos
F9
     O Teu amor me alcança
G
     E me faz louvar-Te
--
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
--
 C  Dm7  F9  G
--
C
   Dos montes corre para o mar
Dm7
    Teu rio de amor por mim
F9                                  G
    Eu abrirei meu coração
                                     C
deixando Tua cura entrar
--
C
    Me alegro por te pertencer
Dm7
     Levantarei as minhas mãos
F9
     O Teu amor me alcança
G
     E me faz louvar-Te
--
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
--
Dm7                   C/E
     Meu coração exulta
F9                         G
     De alegria eu canto
Dm7                             C/E
      Se o mundo conhecer a Ti
      F9                        G
Ele se encherá com Tua alegria
--
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
C                          Dm7
Cantarei Teu amor pra sempre
F9                    G
  Cantarei Teu amor pra sempre
--
 C  Dm7  F9  G
	]]>
	</cifra>
</musica>



<musica>
	<titulo>Amigo de Deus</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
      C     G/B       Am
Não existe nada melhor
        C    G/B       F
Do que ser amigo de Deus
      Am    G       D/F#
Caminhar seguro na luz
       Am     G/B   C
Desfrutar do seu   amor
       Dm     C   G/B
Ter a paz no coração
       Dm        C    G/B
Viver sempre em comunhão
     F       G
E assim perceber
       C    C/E  F
A grandeza do  poder
      C/G      G
De Jesus, meu Bom Pastor
C  G/B  Am  Dm  C  G

      C     G/B       Am
Não existe nada melhor
        C    G/B       F
Do que ser amigo de Deus
      Am    G       D/F#
Caminhar seguro na luz
       Am     G/B   C
Desfrutar do seu   amor
       Dm     C   G/B
Ter a paz no coração
       Dm        C    G/B
Viver sempre em comunhão
     F       G
E assim perceber
       C    C/E  F
A grandeza do  poder
      C/G      G      C  F/C  C
De Jesus, meu Bom Pastor
       Dm     C   G/B
Ter a paz no coração
       Dm        C    G/B
Viver sempre em comunhão
     F       G
E assim perceber
       C    C/E  F
A grandeza do  poder
      C/G      G      C  F/C  C
De Jesus, meu Bom Pastor
      C/G      G      F
De Jesus, meu Bom Pastor

--
C  G/B  Am  Dm  C  G
--
	]]>
	</cifra>
</musica>



<musica>
	<titulo>Tua É a Glória</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
C9      Am7          F7/E
Tua é a glória e o poder
            C      G
Tu és pra sempre Rei
C9           Am7         F7/E        F/G
Honra e majestade estão diante do Senhor
     Am         Am7/G#          Am7/G      D/F#
Não existe nenhum Deus que seja   digno como Tu
      F         C/E
Nada vai me separar de Ti
   Dm7             G
Tu  és  a própria vida em mim

C  Am7  F


C9      Am7          F7/E
Tua é a glória e o poder
            C      G
Tu és pra sempre Rei
C9           Am7         F7/E        G
Honra e majestade estão diante do Senhor
     Am         Am7/G#          Am7/G      D/F#
Não existe nenhum Deus que seja   digno como Tu
     Dm7/E   C/E
Nada vai me separar de Ti
     F              G
Tu  és  a própria vida em mim
--
C9
Não deixarei de te louvar
Am7
Não deixarei de te buscar
        F           C/E
És a razão da minha  vi-da
Dm7             F/G
Vi-vo pra te exaltar
--
C9
Não deixarei de te louvar
Am7
Não deixarei de te buscar
        F           C/E
És a razão da minha  vi-da
Dm7           F/G
Vivo pra te adorar
--
C  Am7  F
--
D9
Não deixarei de te louvar
Bm7
Não deixarei de te buscar
        G           D/F#
És a razão da minha  vi-da
Em7             G/A
Vi-vo pra te exaltar
--
D9
Não deixarei de te louvar
Bm7
Não deixarei de te buscar
        G           D/F#
És a razão da minha  vi-da
Em7           G/A
Vivo pra te adorar
	]]>
	</cifra>
</musica>




<musica>
	<titulo>Deus Está Aqui</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C4
Tão certo como eu te falo e podes me ouvir
--
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C4
Tão certo como eu te falo e podes me ouvir
--
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C
Tão certo como eu te falo e podes me ouvir
--
     F                G/F
Tão certo como eu te falo
     E7              Am7
Tão certo como eu te falo
     Dm7              G               C4
Tão certo como eu te falo podes me ouvir
--
 C   G/B  Am7  A4(7/9)  Am7
Deus está  aqui
     F              G/B     C
Tão certo como ar que eu respiro
     F           G/F            E7      Am7
Tão certo como o amanhã que se levan.....tará
     Dm7             G4                C
Tão certo como eu te falo e podes me ouvir
--
     F                G/F
Tão certo como eu te falo
     E7              Am7
Tão certo como eu te falo
     Dm7              G               C4
Tão certo como eu te falo podes me ouvir
	]]>
	</cifra>
</musica>





<musica>
	<titulo>Fico Feliz Em Vir Em Tua Casa</titulo>
	<tom>G</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
G              C              
Fico feliz em vir em Tua casa
   G                  D
erguer minha voz e cantar
G              C             
Fico feliz em vir em Tua casa
  G          D            G
erguer minhas mãos e adorar
G              C              
Fico feliz em vir em Tua casa
   G                  D
erguer minha voz e cantar
G              C             
Fico feliz em vir em Tua casa
  G          D            G
erguer minhas mãos e adorar
--
G                        C 
Bendito é o nome do Senhor 
 G                    D
bendito é o nome do Senhor
G                       C  
Bendito é o nome do Senhor 
     D   G   D
pra sempre
G                        C 
Bendito é o nome do Senhor 
 G                    D
bendito é o nome do Senhor
G                       C  
Bendito é o nome do Senhor 
     D   G   D
pra sempre
C       D   G
   Pra sempre
--
G              C              
Fico feliz em vir em Tua casa
   G                  D
erguer minha voz e cantar
G              C             
Fico feliz em vir em Tua casa
  G          D            G
erguer minhas mãos e adorar
G              C              
Fico feliz em vir em Tua casa
   G                  D
erguer minha voz e cantar
G              C             
Fico feliz em vir em Tua casa
  G          D            G
erguer minhas mãos e adorar
--
G                        C 
Bendito é o nome do Senhor 
 G                    D
bendito é o nome do Senhor
G                       C  
Bendito é o nome do Senhor 
     D   G   D
pra sempre
G                        C 
Bendito é o nome do Senhor 
 G                    D
bendito é o nome do Senhor
G                       C  
Bendito é o nome do Senhor 
     D   G   D
pra sempre
C       D   G
   Pra sempre
	]]>
	</cifra>
</musica>







<musica>
	<titulo>Te Agradeço</titulo>
	<tom>A</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
        D
Te agradeço
        A2
Meu Senhor
        D
Te agradeço
        A2
Meu Senhor
--
        A2                       A/G
Te agradeço por me libertar e salvar
 D/F#               D#º
Por ter morrido em meu lugar
--
        A2  A/C#  D
Te agrade___ço
               A2  A/C#  D
Jesus, te agrade___ço
           A2  A/C#  D
Eu te agrade___ço
        Bm   A2
Te agrade___ço

--
( D  A2 )
--
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
A2                       D
Por tudo o que tens feito
     A2               E
Por tudo o que vais fazer
--
     A2     A/G    D/F#
Por tuas promessas e tudo o que és
     A/E         E
Eu quero te agradecer
                D  A2
Com todo o meu ser
--
        D
Te agradeço
        A2
Meu Senhor
        D
Te agradeço
        A2
Meu Senhor
--
        A2                       A/G
Te agradeço por me libertar e salvar
 D/F#               D#º
Por ter morrido em meu lugar
--
        A2  A/C#  D
Te agrade___ço
               A2  A/C#  D
Jesus, te agrade___ço
           A2  A/C#  D
Eu te agrade___ço
        Bm   A2
Te agrade___ço

--
        A2                       A/G
Te agradeço por me libertar e salvar
 D/F#               D#º
Por ter morrido em meu lugar
--
        A2  A/C#  D
Te agrade___ço
               A2  A/C#  D
Jesus, te agrade___ço
           A2  A/C#  D
Eu te agrade___ço
        Bm   A2
Te agrade___ço
--
        Bm   A2
Te agrade___ço
        Bm   A2

Te agrade___ço
        Bm   A2

Te agradeeeee___ço
	]]>
	</cifra>
</musica>





<musica>
	<titulo>Eu Vejo a Glória</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
--
D  G  Bm  A
--
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G             Bm         A
Eu vejo a glória do Senhor hoje aqui
D         G        Bm         A
A sua mão o seu poder sobre mim
D         G              Bm         A
Os céus abertos hoje eu vou contemplar
    Em         G       A
O amor descer nesse lugar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
--
D         G        Bm      A
Eu quero ver agora o Teu poder
D      G          Bm       A
A Tua glória inundando meu ser
D         G            Bm      A
Vou levantar as mãos e vou receber
      Em           G             A                    D
Vou louvando o Teu nome, porque sinto o Senhor me tocar
	]]>
	</cifra>
</musica>



<musica>
	<titulo>Rompendo em Fé</titulo>
	<tom>D</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
      D                       G
Cada vez que a minha fé é provada
       A                          D
Tu me dás a chance de crescer um pouco mais
       Bm              F#m7
As montanhas e vales desertos e mares
         Em7                A        A4  A
Que atravesso me levam pra perto de Ti
--
         D                  D/F#   Em7
Minhas provações não são maiores que o meu Deus
       A                      D
E não vão me impedir de caminhar
      Em7     A            F#7   Bm
Se diante de mim não se abrir o mar
          Em7        A               D
Deus vai me fazer andar por sobre as águas
--
 D4          D  D/F#
Rompendo em fé
       G         A          D
Minha vida se revestirá do Teu poder
 D4          D  D5(9/11)
Rompendo em fé
         G         A           Bm
Com ousadia vou mover o sobrenatural
--
 Bm  A/C#  G/B     D
Vou  lu____tar e vencer
         G        Bm
Vou plantar e colher
        Em7       A
A cada dia vou viver
             D  D4  D  D4
Rompendo em fé
--
      D                       G
Cada vez que a minha fé é provada
       A                          D
Tu me dás a chance de crescer um pouco mais
       Bm              F#m7
As montanhas e vales desertos e mares
         Em7                A        A4  A
Que atravesso me levam pra perto de Ti
--
         D                  D/F#   Em7
Minhas provações não são maiores que o meu Deus
       A                      D
E não vão me impedir de caminhar
      Em7     A            F#7   Bm
Se diante de mim não se abrir o mar
          Em7        A               D
Deus vai me fazer andar por sobre as águas
--
 D4          D  D/F#
Rompendo em fé
       G         A          D
Minha vida se revestirá do Teu poder
 D4          D  D5(9/11)
Rompendo em fé
         G         A           Bm
Com ousadia vou mover o sobrenatural
--
 Bm  A/C#  G/B     D
Vou  lu____tar e vencer
         G        Bm
Vou plantar e colher
        Em7       A
A cada dia vou viver
             D  D4  D  D4
Rompendo em fé
--
        Em7       A
A cada dia vou viver
             D  D4  D  D4
Rompendo em fé
	]]>
	</cifra>
</musica>





<musica>
	<titulo>Grande É o Senhor</titulo>
	<tom>D</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
  D
Grande
       G/D
é o Senhor
                   D
E mui digno de louvor
      G/D
Na cidade do nosso Deus
     A/C#  Bm7
Seu Santo monte
 D
 Alegria de toda

 Em7  F#m7 G7M  A4
 ter - ra - a - a

  D
Grande
       G/D
é o Senhor
                       D
Em quem nós temos a vitória
       G/D
E que nos ajuda
             Bm
Contra o inimigo
        D9
    Por isso diante dele nos
       Em7  F#m7 G7M  A4
 prostramos

    D
Queremos o Teu
             D/C#
Nome engrandecer
G7M
E agradecer-Te
D/F#      Em7             A
Por Tua obra em nossas vidas
     D
Confiamos em Teu
           D/C#
Infinito amor
      G7M                D/F#
Pois só Tu és o Deus eterno
Em7        A4
Sobre toda terra e céus

  D
Grande
       G/D
é o Senhor
                       D
Em quem nós temos a vitória
       G/D
E que nos ajuda
             Bm
Contra o inimigo
        D9
    Por isso diante dele nos
       Em7  F#m7 G7M  A4
 prostramos

    D
Queremos o Teu
            D/C#
Nome engrandecer
G7M
E agradecer-Te
D/F#        Em7             A4
    Por Tua obra em nossas vidas
     D
Confiamos em Teu
           D/C#
Infinito amor

      G7M                 D/F#
Pois só Tu és o Deus eterno
 Em7        A4
Sobre toda terra
    D
Queremos o Teu
            D/C#
Nome engrandecer
G7M
E agradecer-Te
D/F#        Em7             A4
    Por Tua obra em nossas vidas
     D
Confiamos em Teu
           D/C#
Infinito amor

      G7M                 D/F#
Pois só Tu és o Deus eterno

 Em7        A4      D9
Sobre toda terra e céus

	]]>
	</cifra>
</musica>




<musica>
	<titulo>Bondade de Deus</titulo>
	<tom>A</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
           A
Te amo, Deus
      D/A         A
Tua graça nunca falha
   E/G#   F#m7
Todos os dias
      D/A         E6
Eu estou em Tuas mãos
                   F#m7 D/C#
Desde quando me levanto
        A     E/G# F#m7
Até eu me deitar
         D/A       E6      A
Eu cantarei da bondade de Deus

D/A                  A
      És fiel em todo tempo
D/A                      A        E6
      Em todo tempo Tu és tão, tão bom
D/A                      F#m7
      Com todo fôlego que tenho
         D/A     E6      A
Eu cantarei da bondade de Deus

          A
Tua doce voz
         D/A          A
Que me guia em meio ao fogo
      E/G# F#m7
Na escuri_dão
        D/A       E6
Tua presença me conforta
                F#m7 D/C#
Sei que és meu Pai
      A   E/G# F#m7
Que amigo és
      D/A  E              A
E eu vivo na bon_dade de Deus

D/A                  A
      És fiel em todo tempo
D/A                      A        E6
      Em todo tempo Tu és tão, tão bom
D/A                      F#m7
      Com todo fôlego que tenho
         D/A     E6      A
Eu cantarei da bondade de Deus

A9  A  A4   A

A/C#                D/C#
    Tua bondade me seguirá
    E6         A
Me seguirá Senhor
A/C#                D/C#
    Tua bondade me seguirá
    E6         A
Me seguirá Senhor

       A/C#           D/C#
Eu me rendo a Ti, te dou o meu ser
    E6          F#m7
Entrego tudo a Ti
A/C#                D/C#
    Tua bondade me seguirá
    E6         A
Me seguirá Senhor

D/A                  A
      És fiel em todo tempo
D/A                      A        E6
      Em todo tempo Tu és tão, tão bom
D/A                      F#m7
      Com todo fôlego que tenho
         D/A     E6      A
Eu cantarei da bondade de Deus
         D/A     E6      A
Eu cantarei da bondade de Deus
	]]>
	</cifra>
</musica>




<musica>
	<titulo>A Alegria Está No Coração</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
C
A alegria está no coração
    F                  C   F
De quem já conhece a Jesus
C
A verdadeira paz só tem aquele
     D7             G
Que já conhece a Jesus
C                   C7
O sentimento mais precioso
     F               G#
Que vem do nosso Senhor
      C          G
É o amor que só tem quem
                C   F
Já conhece a Jesus
C
A alegria está no coração
     F                  C   F
De quem já conhece a Jesus
C
A verdadeira paz só tem aquele
     D7             G
Que já conhece a Jesus
C                   C7
O sentimento mais precioso
     F               G#
Que vem do nosso Senhor
      C          G
É o amor que só tem quem
                C   F
Já conhece a Jesus
         C
Posso pisar numa tropa
      C7
E saltar as muralhas
    F        G#
Aleluia! Aleluia!
--
         C
Posso pisar numa tropa
      C7
E saltar as muralhas
    F        G#
Aleluia! Aleluia!

  C                 C7
E Ele é a rocha da minha salvação
    F                G#
Com Ele não há mais condenação
         C
Posso pisar numa tropa
   G
E saltar as muralhas
    C          G
Aleluia! Aleluia!
--
    C        F  C
Aleluia! Alelui_a!
             D7  G
Aleluia! Alelui__a!
    C        F  C
Aleluia! Alelui_a!
             D7  G
Aleluia! Alelui__a!

C
O sentimento mais precioso
     F               G#
Que vem do nosso Senhor
      C          G
É o amor que só tem quem
                C  G
Já conhece a Jesus

      C          G
É o amor que só tem quem
                A# F
Já conhece a Jesus
      C          G
É o amor que só tem quem
                C
Já conhece a Jesus
	]]>
	</cifra>
</musica>






<musica>
	<titulo>Meus Filhos São Teus</titulo>
	<tom>C</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
C
Herança de Deus
F/C
Presente do céu
G/C          F/C
São meus filhos
C
Pedi ao Senhor
 Dm7
E Ele me ouviu
  C/E       Dm  C/E  F
Por eles clamo


F
Que ouçam tua voz
 C/E
Que amém tua voz
D7                 G4  G
E busquem sempre obedecer
 F
Que tenham em ti
C/E
O tesouro maior
D7                   G4
E vivam pra te engrandecer
       C
Sejam luz por onde andarem
   F7/E                 D7
Resplandecendo a luz do amor
       C
Sejam sal onde estiverem
   F7               D7
Trazendo o sabor de Deus
  F7/E          G    C  ( F )
Meus filhos   são teus


C
Herança de Deus
F/C
Presente do céu
G/C          F/C
São meus filhos
C
Pedi ao Senhor
Dm7
E Ele me ouviu
   C/E      Dm  C/E
Por eles clamo
F
Que ouçam tua voz
 C/E
Que amém tua voz
D7               G    C
E busquem sempre obedecer
 F
Que tenham em ti
C/E
O tesouro maior
D7                    G
E vivam pra te engrandecer
       C
Sejam luz por onde andarem
   F                D7
Resplandecendo a luz do amor
       C
Sejam sal sim onde estiverem
   F               D7
Trazendo o sabor de Deus
  F7/E          G    C
Meus filhos   são teus


F
Que tua graça os livre do mal
 Am
E o teu pão os sustente
    F                   G/F
Seus anseios estejam em ti
       Am7       G
Sim, em ti tão somente
    F        C/E      D7
Consagrados estão ao Senhor
F
Meus filhos

       C
Sejam luz por onde andarem
   F                D7
Resplandecendo a luz do amor
       C
Sejam sal onde estiverem
   F               D7
Trazendo o sabor de Deus
  F7/E     D7
Meus filhos
  F     D7
Meus filhos
  F      G         C  F  G
Meus filhos, são teus


  F    C
Sejam sal sim onde estiverem
   Dm        C/E   D7  E
Trazendo o sabor de Deus
   Am    C/G
Meus fi___lhos
F     Dm          C
Meus filhos, são teus
	]]>
	</cifra>
</musica>


<musica>
	<titulo>Ele É Exaltado</titulo>
	<tom>D</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
D                   
Ele é exaltado
   D/F#               G
O rei é exaltado nos céus
      G/B  A/C#
Eu o louva_rei
D                    D/F#             
Ele é exaltado, pra sempre exaltado
       G  A  G/B  A/C# B/D#
O seu no__me lou___va___rei

Em  Em/D    A/C#
Ele é o Senhor
        D        D/F#      G
Sua verdade vai sempre reinar
 Em  Em/D  A/C#
Ter_ra e  céus
      D         D/C  B4  B/D#
Glorificam seu santo no__me
Em7        Em/D  
Ele é exaltado
   C        A        D   A7
O rei é exaltado nos céus

D                   
Ele é exaltado
   D/F#               G
O rei é exaltado nos céus
      G/B  A/C#
Eu o louva_rei
D                    D/F#             
Ele é exaltado, pra sempre exaltado
       G  A  G/B  A/C# B/D#
O seu no__me lou___va___rei

Em  Em/D    A/C#
Ele é o Senhor
        D        D/F#      G
Sua verdade vai sempre reinar
 Em  Em/D  A/C#
Ter_ra e  céus
      D         D/C  B4  B/D#
Glorificam seu santo no__me
Em7        Em/D  
Ele é exaltado
   C        A        D   A7
O rei é exaltado nos céus

Em  Em/D    A/C#
Ele é o Senhor
        D        D/F#      G
Sua verdade vai sempre reinar
 Em  Em/D  A/C#
Ter_ra e  céus
      D         D/C  B4  B/D#
Glorificam seu santo no__me
Em7        Em/D  
Ele é exaltado
   C        A        D   A7
O rei é exaltado nos céus
	]]>
	</cifra>
</musica>

<musica>
	<titulo>Me Derramar</titulo>
	<tom>G</tom>
	<bpm></bpm>
	<categ></categ>
	<cifra>
	<![CDATA[
C      G    D/F#
Eis-me aqui outra vez
  Em                 C
Diante de Ti abro o meu coração
      G          D/F#
Meu clamor Tu escutas
   Em               C
E fazes cair as barreiras em mim
--
     G              D/F#
És fiel, Senhor, e dizes
   Em                   C
Palavras de amor e esperança sem fim
    G      D/F#
Ao sentir Teu toque
     Em             C
Por Tua bondade, libertas meu ser
      Am    Bm  Em
No calor deste lugar
--
D         G              D/F#
Eu venho me derramar, dizer que Te amo
 Em             C
Me derramar, dizer: Te preciso
 G              D/F#
Me derramar, dizer que sou grato
 Em             C
Me derramar, dizer que és formoso
--
G  D/F#  Em  C
--
       G    D/F#
Eis-me aqui outra vez
  Em                 C
Diante de Ti abro o meu coração
      G          D/F#
Meu clamor Tu escutas
   Em               C
E fazes cair as barreiras em mim
--
     G              D/F#
És fiel, Senhor, e dizes
   Em                   C
Palavras de amor e esperança sem fim
    G      D/F#
Ao sentir Teu toque
     Em             C
Por Tua bondade, libertas meu ser
      Am7    Bm7  C7M
No calor deste lugar
--
D         G              D/F#
Eu venho me derramar, dizer que Te amo
 Em             C
Me derramar, dizer: Te preciso
 G              D/F#
Me derramar, dizer que sou grato
 Em             C
Me derramar, dizer que és formoso
--
 G              D/F#
Me derramar, dizer que Te amo
 Em             C
Me derramar, dizer: Te preciso
 G              D/F#
Me derramar, dizer que sou grato
 Em             C
Me derramar, dizer que és formoso
	]]>
	</cifra>
</musica>


<musica>
	<titulo>Porque Ele Vive</titulo>
	<tom>A</tom>
	<bpm></bpm>
	<categ>Holiness</categ>
	<cifra>
	<![CDATA[
A9 E D A9 E
          A9  E
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
          A9            E
Está nas mãos do meu Jesus
            A9
Que vivo está
--
                        D
Deus enviou seu Filho amado
         A9             Bm  E
Pra perdoar, pra me salvar
            A9            D
Na cruz morreu por meus pecados
Bm      A9/C#  F#m              E/G#    D
   Mas ressur_giu e vivo com o Pai está
--
            A9
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
Bm    A9/C#  F#m           E/G#
   Está nas mãos do meu Jesus
            G    E
Que vivo está

...
            A9            D
E quando enfim, chegar a hora
          A9            Bm  E
Em que a morte enfrentarei
             A9           D
Sem medo, então, terei vitória
Bm    A9/C#   F#m             E/G#
   Verei na Glória, ao meu Jesus
            D
Que vivo está
--
            A9
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
Bm    A/C#   F#m           E/G#
   Está nas mãos do meu Jesus
            G
Que vivo está
--
            A9
Porque Ele vive
              D
Posso crer no amanhã
            A9
Porque Ele vive
           E
Temor não há
--
            A9
Mas eu bem sei, eu sei
             D
Que a minha vida
Bm    A/C#   F#m           E/G#
   Está nas mãos do meu Jesus
            D  A9/C#  A9
Que vivo está

	]]>
	</cifra>
</musica>



<musica>
	<titulo>Chamamecero</titulo>
	<tom>A</tom>
	<bpm></bpm>
	<categ>Rafael</categ>
	<cifra>
	<![CDATA[
A7M
Como se a escuridão trouxesse luz
C#m7
Como se o coração fosse explodir
D7M/A             Ebº
Mastiguei a fala, negaceei a mágoa
Bm7          Bm7/A   Bm4/G#  E
Só pra ver a lágrima feliz

A7M
Quis amansar a dor, me vi pela vida
C#m7
Quis conhecer o amor, fiz um chamamé
D7M/A             Ebº
Cheio de carinho, louco de faceiro
    Bm7       Bm7/A     Bm4/G#  E
Mas que chamamecero me senti

A7M
Coisa de bom menino abraçando o pai
C#m7
Coisa de mãe saudosa mimando o filho
D7M/A                Ebº
Fui me emocionando a mando do gaiteiro
   Bm7        Bm7/A     Bm4/G#  E
Mas que chamamecero, repeti

A7M
A mão vem me dando um soco
     A7
E eu prendo-lhe um sapucay
  D         
O pé pisoteia a marca
   Ebº                    
Que a alma arrepia em pêlo
Cº   Bm7             Bm7/A
   E quase arrebenta o fole
  Bm4/G#    E            A7M
Que torce, pra vida melhorar

( A7M  A/G  D/F#  E ) 
( Bm7  E  A  A/G ) 
( D/F#  E  A )

A7M
Como se a escuridão trouxesse luz
C#m7
Como se o coração fosse explodir
D7M/A             Ebº
Mastiguei a fala, negaceei a mágoa
Bm7          Bm7/A   Bm4/G#  E
Só pra ver a lágrima feliz

A7M
Quis amansar a dor, me vi pela vida
C#m7
Quis conhecer o amor, fiz um chamamé
D7M/A             Ebº
Cheio de carinho, louco de faceiro
    Bm7       Bm7/A     Bm4/G#  E
Mas que chamamecero me senti

A7M
Coisa de bom menino abraçando o pai
C#m7
Coisa de mãe saudosa mimando o filho
D7M/A                Ebº
Fui me emocionando a mando do gaiteiro
   Bm7        Bm7/A     Bm4/G#  E
Mas que chamamecero, repeti

A7M
A mão vem me dando um soco
     A7
E eu prendo-lhe um sapucay
  D         
O pé pisoteia a marca
   Ebº                    
Que a alma arrepia em pêlo
Cº   Bm7             Bm7/A
   E quase arrebenta o fole
  Bm4/G#    E            A7M
Que torce, pra vida melhorar
	]]></cifra>
</musica>

<musica>
	<titulo>I don't wanna miss a thing</titulo>
	<tom>D</tom>
	<bpm></bpm>
	<categ>FingerStyle</categ>
	<cifra><![CDATA[
          D6        D6/C#             D6/B
I could stay awake just to hear you breathing
            D6/G                D6/F#
Watch you smile while you are sleeping
              D6/E
While you're far away and dreaming
          D6          D6/C#             D6/B
I could spend my life in this sweet surrender
          D6/G               D6/F#    D6/E
I could stay lost in this moment   forever
               D6/F#     D6/G
Every moment spent with you
                  D6/A
Is a moment of treasure

[Refrão]

D5(9)               A9/C#
      Don't wanna close my eyes
Em7(9)
       I don't wanna fall asleep
  G5/F#     G7M
'Cause I'd miss you baby
                   A4          
And I don't wanna miss a thing
D5(9)                      A9/C#
      'Cause even when I dream of you
Em7(9)
       The sweetest dream would never do
      G5/F#  G7M
I'd still   miss you baby
                   A4          
And I don't wanna miss a thing

( D5(9)  A9/C#  Em7(9)  A4 )

[Primeira Parte - Variação]

         D
Laying close to you
 A9/C#              Bm7(11)
Feeling your heart beating
         G                      D9/F#
And I'm wondering what you're dreaming
          Em7
Wondering if it's me you're seeing
        D
Then I kiss your eyes
      A9/C#            Bm7(11)
And thank God we're together
                     F#m7(11) G7M
And I just want to stay with you
                  A4
In this moment forever, forever and ever

[Refrão]

D5(9)               A9/C#
      Don't wanna close my eyes
Em7(9)
       I don't wanna fall asleep
  G5/F#     G7M
'Cause I'd miss you baby
                   A4          
And I don't wanna miss a thing
D5(9)                      A9/C#
      'Cause even when I dream of you
Em7(9)
       The sweetest dream would never do
      G5/F#  G7M
I'd still   miss you baby
                   A4          
And I don't wanna miss a thing

[Segunda Parte]

               C9
I don't wanna miss one smile
               C9/B
I don't wanna miss one kiss
              Bb9(11+)
I just wanna be with you
                      F/A
Right here with you, just like this
              C9
I just wanna hold you close
                       C9/B
I feel your heart so close to mine
           Dm7(9)
And just stay here in this moment
             A4          A
For all the rest of time

[Refrão] (…)
	]]></cifra>
</musica>

</musicas>


</script>
<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Fingerstyle • Identificador de Notas no Violão</title>




<style>
  :root{
    --bg:#0f1115; --fg:#e6e6e6; --muted:#9aa3af; --acc:#6ee7ff; --mark:#ffd166;
    --string:#39414f; 
	--fret:#222733; 
	--dot:#3b4252; 
	--note:#1f6feb; 
	--bass:#f59e0b;
	--chord:#22c55e;  /* VERDE (acorde)  */
    --colL:260px; 
	/*--colR:420px;*/
	--colR: clamp(520px, 34vw, 760px);
	--fretH:42px; --nutH:10px;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font:15px/1.4 system-ui,Segoe UI,Roboto,Inter,sans-serif}
  #geral{display:grid;grid-template-columns:var(--colL) 1fr var(--colR);height:100vh}
  /* menu esquerdo */
  #menuEsquerda{border-right:1px solid #1d2230;background:#0b0d12;overflow:auto}
  #menuEsquerda h2{margin:12px 12px 6px;font-size:14px;color:var(--muted);letter-spacing:.08em;text-transform:uppercase}
  
  #listaMusicas{list-style:none;margin:0;padding:0}
#listaMusicas li{
  position: relative;
  padding: 10px;
  overflow: hidden;             /* mantém ellipsis se você usar */
  text-overflow: ellipsis;
  white-space: nowrap;
}
#listaMusicas li .queue-badge{
  position: absolute;
  top: 50%;
  right: 10px;
  transform: translateY(-50%);
  float: none;
  margin-left: 0;
}


  #listaMusicas li:hover{background:#101521}
  #listaMusicas li.active{background:#111827;color:#e5f5ff;box-shadow:inset 3px 0 0 var(--acc)}
  
  /* cifra centro */
  #cifraMeio{padding:18px 20px 80px;overflow:auto}
  #cifraMeio pre{white-space:pre-wrap;font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;background:#0b0f19;border:1px solid #161c2a;border-radius:12px;padding:16px}
  
/* Base: nenhuma margem nas linhas (letra) */
#cifraMeio .linha{
  display: inline-block;   /* block garante que margin vertical funcione */
  margin: 0;
  font-size: 45px;
}

/* Só LINHAS COM ACORDES ganham espaçamento especial */
#cifraMeio .linha:has(.chord){
  margin-top: 50px;  /* afasta da linha de cima (letra) */
  margin-bottom: -10px;/* aproxima da linha de baixo (letra) */
}
#cifraMeio .linha:has(.chord):has(+ .linha:not(:has(.chord))){
  margin-bottom: 2px;
}
  
  .chord{display:inline-block;padding:0 3px;margin:0 1px;border-radius:6px;background:#122034;color:#bfe7ff;cursor:pointer}
  .chord:hover{outline:1px dashed #2b3b59}
  .meta{color:var(--muted);font-size:12px;margin:6px 0 10px}
  
  /* braço do violão */
  #bracoViolaoDireita{
  border-left:1px solid #1d2230;
  background:#0b0d12;
  display:flex;
  flex-direction:column
  }
  
  .controls{display:flex;gap:8px;align-items:center;padding:12px;border-bottom:1px solid #1b2130;color:#bcd}
  .controls select,.controls button{background:#111827;color:#e5e7eb;border:1px solid #1f2937;border-radius:8px;padding:6px 10px}
  .legend{padding:10px 12px;color:#cfe;display:flex;flex-wrap:wrap;gap:8px;border-bottom:1px solid #1b2130}
  .pill{padding:3px 8px;border-radius:999px;background:#132033;border:1px solid #22324b;font-weight:600}
  .pill.bass{background:#2a1c09;border-color:#3a2a11}
  
  .fretboardWrap{flex:1;display:flex;justify-content:center;align-items:flex-start;overflow:auto;padding:12px}
  
  .fretboard{
		position:relative;
		display:grid;
		grid-auto-rows:var(--fretH);
		grid-template-columns:repeat(6,1fr);
		background:var(--fret);
		border-radius:14px;
		padding-top:var(--nutH);
		box-shadow:inset 0 0 0 1px #1b2331;
		/*width: 100%;*/
		min-width: 280px;   /* garante leitura confortável */
	}
  
  .nut{position:absolute;top:0;left:0;right:0;height:var(--nutH);background:#d1c7b7;border-bottom:2px solid #b29f85;border-top-left-radius:14px;border-top-right-radius:14px}
  .string{position:relative;border-left:1px solid #1b2230;border-right:1px solid #1b2230}
  .string::before{content:"";position:absolute;left:50%;top:0;bottom:0;width:3px;transform:translateX(-50%);background:linear-gradient(#8b8b8b,#bfbfbf);opacity:.4;border-radius:2px}
  .fretRow{position:relative;display:contents}
  .fretSep{position:absolute;left:0;right:0;bottom:0;height:2px;background:#141923}
  
	.marker{
	  position:absolute; transform:translate(-50%,-50%);
	  width:26px; height:26px; border-radius:50%;
	  display:flex; align-items:center; justify-content:center;
	  font:700 12px/1 ui-monospace; color:#fff;
	  box-shadow:0 0 0 2px #0b1220; /* contorno escuro para legibilidade */
	}

	/* Só escala (azul) */
	.marker.is-scale:not(.is-chord){
	  background:var(--note);
	}

	/* Acorde (verde) sempre prevalece no preenchimento */
	.marker.is-chord{
	  background:var(--chord);
	}

	/* Escala + acorde: fundo verde + anel azul externo */
	.marker.is-scale.is-chord{
	  background:var(--chord);
	  box-shadow:
		0 0 0 2px #0b1220,
		0 0 0 6px var(--note); /* anel azul */
	}

	/* ------ REGRAS DO BAIXO (ANEL LARANJA) ------ */
	/* Caso tenha apenas o baixo (sem escala/acorde) → mantém o anel laranja */
	.marker.is-bass{
	  box-shadow:
		0 0 0 2px #0b1220,
		0 0 0 10px var(--bass); /* anel laranja */
	}

	/* Escala + baixo (sem acorde) → azul + laranja */
	.marker.is-scale.is-bass:not(.is-chord){
	  box-shadow:
		0 0 0 2px #0b1220,
		0 0 0 6px var(--note),
		0 0 0 10px var(--bass);
	}

	/* Acorde + baixo (sem escala) → só laranja (fundo verde do acorde já aplicado) */
	.marker.is-chord.is-bass:not(.is-scale){
	  box-shadow:
		0 0 0 2px #0b1220,
		0 0 0 10px var(--bass);
	}

	/* Escala + acorde + baixo → azul + laranja (ordem de maior especificidade para vencer o cascade) */
	.marker.is-scale.is-chord.is-bass{
	  box-shadow:
		0 0 0 2px #0b1220,
		0 0 0 6px var(--note),
		0 0 0 10px var(--bass);
	}

  
  .inlay{position:absolute;left:50%;bottom:6px;transform:translateX(-50%);width:10px;height:10px;background:var(--dot);border-radius:50%;opacity:.7}
  .inlay.double{display:flex;gap:10px;justify-content:center;align-items:center;width:auto;background:transparent}
  .inlay.double::before,.inlay.double::after{content:"";display:block;width:10px;height:10px;background:var(--dot);border-radius:50%;opacity:.7}
  .fretNum{position:absolute;left:6px;top:6px;font-size:11px;color:#9fb}
  /* util */
  .muted{opacity:.6}
  a.btn{padding:6px 10px;border:1px solid #22314d;border-radius:8px;text-decoration:none;color:#e6f3ff;background:#0f1626}
  
  /* Torna o BAIXO visível mesmo quando não faz parte da escala/acorde */
  .marker.is-bass:not(.is-scale):not(.is-chord){
    background: var(--bass);
    color:#111;
  }
  
  
	 /* acorde atualmente selecionado pelo teclado */
	.chord.active{
	  outline: 2px solid var(--mark);
	  background:#1a2a44;
	  border-radius:6px;
	}

 .capo {
  position: absolute; left: 0; right: 0;
  height: 10px; border-radius: 8px;
  background: rgba(245, 158, 11, .25);
  border: 1px solid #f59e0b; 
  pointer-events: none; z-index: 0;
}
 
.controls .chk{
  display:inline-flex; align-items:center; gap:8px;
  padding:4px 8px; border:1px solid #1f2937; border-radius:8px;
  background:#0f1626; user-select:none;
}
.controls .chk input{ transform:scale(1.1); }

.controls label { display:inline-flex; align-items:center; gap:6px; }
#selTransposeKey { min-width:72px; }


/* item selecionado na fila (Ctrl+clique) */
#listaMusicas li.queued{
  background: #0f1a2c;
  box-shadow: inset 3px 0 0 #60a5fa;
}
/* número de ordem na fila */
#listaMusicas li .queue-badge{
  float:right;
  min-width:22px; height:22px;
  margin-left:8px;
  border-radius:999px;
  border:1px solid #1f2b46;
  background:#13243f;
  color:#cfe3ff;
  display:inline-flex; align-items:center; justify-content:center;
  font:600 12px/1 ui-sans-serif,system-ui;
  padding:2px 6px;
}



/* === Toggle de colunas (cifraMeio SEMPRE visível) === */
#geral.hide-left {
  grid-template-columns: 1fr var(--colR);
}
#geral.hide-right {
  grid-template-columns: var(--colL) 1fr;
}
#geral.hide-left.hide-right {
  grid-template-columns: 1fr;
}

/* Reposiciona elementos quando painéis são escondidos */
#geral.hide-left #cifraMeio {
  grid-column: 1;
}
#geral.hide-left #bracoViolaoDireita {
  grid-column: 2;
}

#geral.hide-right #menuEsquerda {
  grid-column: 1;
}
#geral.hide-right #cifraMeio {
  grid-column: 2;
}

#geral.hide-left.hide-right #cifraMeio {
  grid-column: 1;
}

/* Esconde completamente os painéis laterais */
#geral.hide-left  #menuEsquerda       { display: none; }
#geral.hide-right #bracoViolaoDireita { display: none; }




#cifra{
font-size: 50px;
}

/* ===== Scrollbars pretos ===== */

/* Chrome, Edge e Safari */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}
::-webkit-scrollbar-track {
  background: #0b0d12;   /* fundo do trilho */
}
::-webkit-scrollbar-thumb {
  background: #111;      /* “polegar” da rolagem */
  border-radius: 6px;
}
::-webkit-scrollbar-thumb:hover {
  background: #222;      /* hover um pouco mais claro */
}

/* Firefox */
* {
  scrollbar-width: thin;           /* fino */
  scrollbar-color: #111 #0b0d12;   /* polegar / trilho */
}

/* ===== Painel de Knobs ===== */
#knobs { padding: 8px 12px; display: grid; gap: 14px; }
.knob-group { border: 1px solid #1f2937; border-radius: 10px; padding: 10px 12px; background:#0e1422; }
.knob-group h3 { margin: 0 0 8px 0; font-size: 14px; font-weight: 600; color:#cbd5e1; }

/* linha do slider */
.knob-row { display: grid; grid-template-columns: 1fr auto; align-items: center; gap: 10px; margin: 6px 0; }
.knob-row label { color:#e5e7eb; font-size: 13px; }

/* display digital vermelho */
@font-face{
  font-family:"DS-Digital";
  src: local("DS-Digital"), local("Digital-7"), local("Segment7Standard"); /* usa se existir no SO */
}
.digital {
  font-family: "DS-Digital", "Digital-7", "Segment7Standard", monospace;
  font-size: 14px;
  background:#290000;
  color:#ff3b3b;
  padding: 2px 8px;
  border-radius: 6px;
  border: 1px solid #5b0000;
  min-width: 64px;
  text-align: right;
}

/* sliders */
.knob-row input[type="range"] { width: 100%; }


.vol-marker { opacity:.35; letter-spacing:1px; }



/* ===== Mobile drawer para #menuEsquerda ================================================================================================================================= */
@media (max-width: 900px){
  /* layout: só centro visível por padrão */
  #geral{ grid-template-columns: 1fr !important; }

  /* menu vira drawer */
  #menuEsquerda{
    position: fixed; inset: 0 auto 0 0; /* top:0; right:auto; bottom:0; left:0 */
    width: min(82vw, 340px);
    max-width: 90vw;
    z-index: 1000;
    transform: translateX(-100%);
    transition: transform .25s ease;
    box-shadow: 2px 0 16px rgba(0,0,0,.4);
  }
  /* quando #geral remove .hide-left → menu aparece */
  #geral:not(.hide-left) #menuEsquerda{
    transform: translateX(0);
  }

  /* overlay para fechar com toque */
  .mobile-overlay{
    position: fixed; inset: 0;
    background: rgba(0,0,0,.45);
    backdrop-filter: blur(1px);
    z-index: 900;
    display: none;
  }
  /* overlay visível quando menu aberto */
  #geral:not(.hide-left) ~ .mobile-overlay{ display:block; }

  /* botão hambúrguer flutuante */
  #menuToggleBtn{
    position: fixed; left: 12px; top: 12px;
    z-index: 1100;
    width: 42px; height: 42px; border-radius: 999px;
    border: 1px solid #1f2937;
    background: #0f1626; color: #e6f3ff;
    display: inline-flex; align-items: center; justify-content: center;
    font-size: 20px; line-height: 1; cursor: pointer;
    box-shadow: 0 2px 10px rgba(0,0,0,.35);
  }
  /* empurra conteúdo para não ficar sob o botão */
  #cifraMeio{ padding-top: 56px; }
}
/* Só em telas pequenas (ex.: até 768px de largura) */
@media (max-width: 768px) {
  #cifraMeio .linha {
    display: inline-block;
    margin: 0;
    font-size: 16px;  /* menor fonte para caber no celular */
  }
 #cifra {
    font-size: 14px;
}


}

/* BOTÃO FLUTUANTE DE NAVEGAÇÃO (estilo iPhone) - APENAS MOBILE */
@media (max-width: 900px){
  #mobileNavBtn{
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1100;
    width: 64px;
    height: 64px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0,0,0,.3), 0 0 0 1px rgba(255,255,255,.1);
    backdrop-filter: blur(10px);
    transition: all 0.2s ease;
    user-select: none;
    touch-action: manipulation;
  }
  
  #mobileNavBtn:active{
    transform: translateX(-50%) scale(0.95);
    box-shadow: 0 2px 10px rgba(0,0,0,.4), 0 0 0 1px rgba(255,255,255,.2);
  }
  
  /* empurra conteúdo para não ficar sob o botão */
  #cifraMeio{ 
    padding-top: 56px; 
    padding-bottom: 100px; /* espaço para o botão de navegação */
  }
}

/* Esconde o botão em desktop */
@media (min-width: 901px){
  #mobileNavBtn{ display: none !important; }
}


</style>



</head>
<body>
<div id="geral"  class="hide-right">
<div id="menuEsquerda">
<h2>Músicas</h2>
<ul id="listaMusicas"></ul>
<div id="escolheCategorias"></div>
<div id="ajustaFonteTela"></div>
<hr>
<div id="knobs"></div>
</div>
<div id="cifraMeio">
<pre id="cifra"></pre>
</div>
<div id="bracoViolaoDireita">
<div class="controls">
<label>
  <select id="capoPos">
    <option value="0">0 (sem capo)</option>
    <option value="1">1ª casa</option>
    <option value="2">2ª casa</option>
    <option value="3">3ª casa</option>
    <option value="4">4ª casa</option>
    <option value="5">5ª casa</option>
    <option value="6">6ª casa</option>
    <option value="7">7ª casa</option>
  </select>
</label>

<label title="Transpor a música para o tom selecionado">
  <select id="selTransposeKey">
    <option value="C">C</option>
    <option value="C#">C#</option>
    <option value="D">D</option>
    <option value="D#">D#</option>
    <option value="E">E</option>
    <option value="F">F</option>
    <option value="F#">F#</option>
    <option value="G">G</option>
    <option value="G#">G#</option>
    <option value="A">A</option>
    <option value="A#">A#</option>
    <option value="B">B</option>
  </select>
</label>

<label class="chk" title="Ao selecionar um acorde, tocar as notas em strings">
  <input type="checkbox" id="chkStrings" checked>
  Tocar acorde (strings)
</label>
<span class="muted" id="chordLabel">—</span>
</div>
<div class="legend" id="legend"></div>
<div class="fretboardWrap">
<div class="fretboard" id="fretboard"><div class="nut"></div></div>
</div>
</div>
</div>
<div class="mobile-overlay" id="mobileOverlay"></div>
<!-- Botão flutuante de navegação (só mobile) -->
<button id="mobileNavBtn" aria-label="Próximo acorde">▶</button>


<script>
/* ===== Util Musical ===== */
const NOTES = ["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
const OPEN_STRINGS = ["E","A","D","G","B","E"]; // 6→1 (grave→agudo)
const TOTAL_FRETS = 15; // fixo
let capo = 0;           // 0 = sem capo
let currentScale = [];   // notas da escala do tom selecionado
let currentKey = "";     // tom atual (texto)

let chordSpans = [];   // lista de <span class="chord">
let chordIdx   = -1;   // índice do acorde ativo na lista (−1 = nenhum)

const NEXT_KEYS = ['ArrowRight','ArrowDown','PageDown']; // adiantar
const PREV_KEYS = ['ArrowLeft','ArrowUp','PageUp'];      // retroceder


</script>



<script>

// ======== PLAYLIST (fila) ========
let songsList = [];         // array com <musica> do XML (na ordem do menu)
let currentSongIdx = -1;    // índice da música atual em songsList

// MASTER (todas as músicas) + filtro atual
let songsMaster = [];               // todas as <musica> do XML
let currentCategory = 'Holiness';   // filtro padrão

// Fila: array de índices inteiros de songsList, na ordem de execução
let playlist = [];
try { playlist = JSON.parse(localStorage.getItem('playlist') || '[]'); } catch { playlist = []; }

function savePlaylist(){
  try { localStorage.setItem('playlist', JSON.stringify(playlist)); } catch {}
}
function isQueued(i){ return playlist.indexOf(i) !== -1; }

function toggleQueue(i){
  const pos = playlist.indexOf(i);
  if (pos >= 0) playlist.splice(pos, 1);
  else playlist.push(i);
  savePlaylist();
  updatePlaylistUI();
}

function updatePlaylistUI(){
  const lis = document.querySelectorAll('#listaMusicas li[data-mid]');
  lis.forEach(li=>{
    const i = parseInt(li.dataset.mid,10); // índice GLOBAL
    li.classList.toggle('queued', isQueued(i));
    let badge = li.querySelector('.queue-badge');
    if (!badge){
      badge = document.createElement('span');
      badge.className = 'queue-badge';
      li.appendChild(badge);
    }
    const order = playlist.indexOf(i);
    if (order >= 0){
      badge.textContent = (order + 1);
      badge.style.display = 'inline-flex';
    } else {
      badge.textContent = '';
      badge.style.display = 'none';
    }
  });
}


function setActiveSongIdx(masterIdx){
  currentSongIdx = masterIdx;
  document.querySelectorAll('#listaMusicas li').forEach(li=>li.classList.remove('active'));
  const li = document.querySelector(`#listaMusicas li[data-mid="${masterIdx}"]`);
  if (li) li.classList.add('active');
}


// Avança para próxima música da fila; retorna true se conseguiu
function goToNextSongInPlaylist(){
  if (!songsList.length || !playlist.length) return false;
  const pos = playlist.indexOf(currentSongIdx);
  const nextIdx = (pos >= 0 && pos < playlist.length - 1)
    ? playlist[pos + 1]
    : (pos === -1 ? playlist[0] : -1);
  if (nextIdx === -1) return false;
  const mEl = songsList[nextIdx];
  if (!mEl) return false;
  setActiveSongIdx(nextIdx);
  showCifra(mEl);
  // após carregar, vai para o 1º acorde se existir
  if (typeof setActiveChord === 'function' && chordSpans.length) setActiveChord(0);
  return true;
}

// Volta para música anterior da fila; retorna true se conseguiu
function goToPrevSongInPlaylist(){
  if (!songsList.length || !playlist.length) return false;
  const pos = playlist.indexOf(currentSongIdx);
  const prevIdx = (pos > 0)
    ? playlist[pos - 1]
    : (pos === -1 ? playlist[0] : -1);
  if (prevIdx === -1) return false;
  const mEl = songsList[prevIdx];
  if (!mEl) return false;
  setActiveSongIdx(prevIdx);
  showCifra(mEl);
  if (typeof setActiveChord === 'function' && chordSpans.length) setActiveChord(Math.max(0, chordSpans.length - 1));
  return true;
}


function getAllCategories(xml){
  const xs = [...xml.getElementsByTagName('musica')];
  const set = new Set(xs.map(x => (getText(x,'categ') || '').trim()).filter(Boolean));
  return [...set].sort((a,b)=>a.localeCompare(b));
}





// --- Transposição por música (persistida em localStorage) ---
let transposeMap = {};
try {
  transposeMap = JSON.parse(localStorage.getItem('transposeMap') || '{}');
} catch { transposeMap = {}; }

let currentSongTitle = '';   // título da música atual (chave no map)
let currentSongOrigKey = ''; // tom original do XML da música atual (ex.: "A" ou "Am")

function saveTransposeMap(){
  try { localStorage.setItem('transposeMap', JSON.stringify(transposeMap)); } catch {}
}

// distância em semitons entre dois roots (0..11), resultado 0..11
function semisBetween(fromRoot, toRoot){
  return (n2i(toRoot) - n2i(fromRoot) + 12) % 12;
}

// transpor símbolo de acorde (raiz e baixo /X) mantendo sufixos
function transposeSymbol(sym, semis){
  const s = String(sym).trim();
  const parts = s.split('/');
  const head = parts[0];
  const bass = parts[1];

  const root = parseRoot(head);
  if(!root) return s;

  const after = head.slice(root.length);               // sufixos/extensões
  const newRoot = i2n(n2i(root) + semis);
  let out = newRoot + after;

  if (bass){
    const bRoot = parseRoot(bass);
    out += '/' + (bRoot ? i2n(n2i(bRoot) + semis) : bass);
  }
  return out;
}






function centerInto(viewEl, container){
  const c = container || document.getElementById('cifraMeio');
  const top = viewEl.offsetTop - c.clientHeight/2 + viewEl.offsetHeight/2;
  c.scrollTo({ top, behavior:'smooth' });
}

function setActiveChord(idx){
  if (!chordSpans.length) return;
  idx = Math.max(0, Math.min(idx, chordSpans.length-1));
  chordSpans.forEach(s=>s.classList.remove('active'));
  const span = chordSpans[idx];
  chordIdx = idx;
  span.classList.add('active');
  centerInto(span, document.getElementById('cifraMeio'));
  // dispara a pintura do braço
  highlightChord(span.dataset.chord);
// Aplica dinâmica do acorde selecionado (rampa 0.75s)

const vol = parseFloat(span.dataset.vol || '1') || 1;
console.log('Aplicando volume:', vol, 'STR_BUS disponível:', !!window.STR_BUS);
if (typeof setPerformanceVol === 'function' && window.STR_BUS && window.STR_BUS.input) {
  setPerformanceVol(vol, 0.75);
setTimeout(() => {
  console.log('Volume final após rampa:', STR_BUS.input.gain.value.toFixed(3));
}, 800); // um pouco após os 0.75s da rampa
} else {
  console.warn('setPerformanceVol não disponível ou STR_BUS não inicializado');
}

}










// HANDLER SIMPLES, APENAS AVANÇA E RETROCEDE
function gotoNextChord(){
  if (!chordSpans.length){
    // sem acordes: tenta próxima música da fila
    if (goToNextSongInPlaylist()) return;
    return;
  }
  if (chordIdx < chordSpans.length - 1){
    setActiveChord(chordIdx + 1);
  } else {
    // fim da música -> próxima da fila
    if (goToNextSongInPlaylist()) return;
    // se não houver próxima, fica no último acorde
    setActiveChord(chordIdx);
  }
}

function gotoPrevChord(){
  if (!chordSpans.length){
    if (goToPrevSongInPlaylist()) return;
    return;
  }
  if (chordIdx > 0){
    setActiveChord(chordIdx - 1);
  } else {
    // início da música -> volta música na fila
    if (goToPrevSongInPlaylist()) return;
    setActiveChord(0);
  }
}

// Vai para a PRIMEIRA música da sequência e posiciona no 1º acorde
function goToFirstSongInPlaylist(){
  try{
    // (A) Se você tiver índice atual + setter, use isso:
    if (typeof window.currentSongIndex === 'number'){
      if (typeof setCurrentSongIndex === 'function'){
        setCurrentSongIndex(0);
      } else if (typeof selectSongByIndex === 'function'){
        selectSongByIndex(0);
      }
      setTimeout(()=>{ try{ setActiveChord(0); }catch{} }, 0);
      return true;
    }

    // (B) Se existir uma API direta:
    if (typeof goToFirstSelectedSong === 'function'){
      goToFirstSelectedSong();
      setTimeout(()=>{ try{ setActiveChord(0); }catch{} }, 0);
      return true;
    }

    // (C) Fallback genérico: volta enquanto houver "música anterior"
    if (typeof goToPrevSongInPlaylist === 'function'){
      let moved = false;
      // proteção: no máximo 200 passos
      for (let i=0; i<200; i++){
        const ok = goToPrevSongInPlaylist();
        if (!ok) break;
        moved = true;
      }
      // garante o 1º acorde da primeira
      setTimeout(()=>{ try{ setActiveChord(0); }catch{} }, 0);
      return moved;
    }

  }catch(e){
    console.warn('goToFirstSongInPlaylist falhou:', e);
  }
  return false;
}





</script>






















<script>
//BLOCO QUE CONTROLA O AVANÇO E O RETROCESSO SEGURANDO A TECLA POR 2 SEGUNDOS
// ===== CONFIG =====
const LONG_HOLD_KEYS = new Set(['PageDown', 'ArrowRight', 'ArrowDown']);
const LONG_HOLD_MS   = 2000;

let holdTimer = null;
let longTriggered = false;
let pressingKey = null;

// ===== HELPERS =====
function stopPadSafely(){
  try {
    if (typeof setPerformanceVol === 'function') setPerformanceVol(0.001, 0.2);
    window.dispatchEvent?.(new CustomEvent('pad:stop'));
  } catch (e) {}
}
function showHint(msg){
  let el = document.getElementById('hint-longpress');
  if (!el){
    el = document.createElement('div');
    el.id = 'hint-longpress';
    Object.assign(el.style, {
      position:'fixed', bottom:'16px', left:'50%', transform:'translateX(-50%)',
      padding:'8px 12px', background:'rgba(0,0,0,.7)', color:'#fff',
      borderRadius:'10px', fontSize:'14px', zIndex:99999, pointerEvents:'none',
      transition:'opacity .25s', opacity:'0'
    });
    document.body.appendChild(el);
  }
  el.textContent = msg;
  el.style.opacity = '1';
  clearTimeout(el._t);
  el._t = setTimeout(()=>{ el.style.opacity='0'; }, 1400);
}
function isAtFirstChord() {
  if (typeof window.chordIdx === 'number') return window.chordIdx === 0;
  const chords = document.querySelectorAll('#cifraMeio .chord');
  if (!chords.length) return false;
  const active = document.querySelector('#cifraMeio .chord.active');
  if (!active) return false;
  const idx = Array.prototype.indexOf.call(chords, active);
  return idx === 0;
}
function isFirstSongInQueue() {
  if (!Array.isArray(window.playlist) || typeof window.currentSongIdx !== 'number') return false;
  // playlist pode ter números ou objetos
  const first = window.playlist[0];
  const firstIdx = (typeof first === 'number') ? first :
                   (first && typeof first.idx === 'number') ? first.idx : null;
  if (firstIdx == null) return false;
  return firstIdx === window.currentSongIdx;
}
function clickFirstQueuedOrFirstListItem(){
  const ul = document.getElementById('listaMusicas');
  if (!ul) return false;
  // tenta item da fila (li.queued)
  let li = ul.querySelector('li.queued');
  // senão, primeiro item da lista
  if (!li) li = ul.querySelector('li');
  if (!li) return false;
  li.click?.();
  return true;
}
/** Vai para a primeira música da fila (com vários fallbacks robustos) */
function goToFirstSong() {
  let done = false;

  try {
    if (Array.isArray(window.playlist) && window.playlist.length > 0) {
      const first = window.playlist[0];
      const firstIdx = (typeof first === 'number') ? first :
                       (first && typeof first.idx === 'number') ? first.idx : null;

      if (firstIdx != null) {
        if (typeof setActiveSongIdx === 'function') { setActiveSongIdx(firstIdx); done = true; }
        if (!done && typeof selectSongByIndex === 'function') { selectSongByIndex(firstIdx); done = true; }
        if (!done && typeof setCurrentSongIndex === 'function') { setCurrentSongIndex(firstIdx); done = true; }

        if (done) {
          if (typeof songsMaster !== 'undefined' && songsMaster[firstIdx] && typeof showCifra === 'function') {
            showCifra(songsMaster[firstIdx]);
          }
        }
      }
    }
  } catch(e){ console.warn('playlist path falhou:', e); }

  // Fallback por clique na UI
  if (!done) done = clickFirstQueuedOrFirstListItem();

  // Garante acorde 0 após navegar
  setTimeout(()=>{ try { setActiveChord?.(0); } catch(_){} }, done ? 60 : 0);

  return !!done;
}

// ===== LONG-PRESS CORE =====
function handleLongPress() {
  holdTimer = null;
  longTriggered = true;
  stopPadSafely();

  const firstChord = isAtFirstChord();
  const firstSong  = isFirstSongInQueue();

  if (!firstChord) {
    try { setActiveChord?.(0); } catch(_){}
    showHint('Voltou ao 1º acorde desta música');
    return;
  }

  if (firstChord && !firstSong) {
    const ok = goToFirstSong();
    if (!ok) showHint('Tentei ir para a 1ª música… ajuste sua fila');
    else     showHint('Foi ao 1º acorde da 1ª música');
    return;
  }

  showHint('Já está no 1º acorde da 1ª música');
}

// ===== EVENTOS =====
function onKeyDown(e){
  if (!LONG_HOLD_KEYS.has(e.key)) return;

  // Intercepta SEMPRE para evitar duplo avanço pelos handlers originais
  e.preventDefault();
  e.stopPropagation();

  if (pressingKey === e.key) return; // já está processando
  pressingKey = e.key;
  longTriggered = false;

  if (holdTimer) clearTimeout(holdTimer);
  holdTimer = setTimeout(handleLongPress, LONG_HOLD_MS);
}

function onKeyUp(e){
  if (!LONG_HOLD_KEYS.has(e.key)) return;

  // Bloqueia bubbling do keyup também (padronização)
  e.preventDefault();
  e.stopPropagation();

  const hadTimer = !!holdTimer;
  if (holdTimer) { clearTimeout(holdTimer); holdTimer = null; }

  // Toque curto → avançar 1 acorde uma única vez (sem “pulinhos”)
  if (!longTriggered && hadTimer) {
    try { gotoNextChord?.(); } catch(err){ console.warn('Avançar 1 acorde falhou:', err); }
  }

  pressingKey = null;
}

// ===== REGISTRO (limpa duplicatas) =====
if (window._lp_registered) {
  window.removeEventListener('keydown', window._lp_onKeyDown, true);
  window.removeEventListener('keyup',   window._lp_onKeyUp,   true);
}
window._lp_onKeyDown = onKeyDown;
window._lp_onKeyUp   = onKeyUp;
window.addEventListener('keydown', onKeyDown, true);
window.addEventListener('keyup',   onKeyUp,   true);
window._lp_registered = true;

console.log('[LongPress] 3s ativo (sem pulinhos; fila robusta)');
</script>






















<script>



function n2i(n){ return NOTES.indexOf(n); }
function i2n(i){ return NOTES[(i+1200)%12]; } // wrap seguro
function transpose(note, semis){ return i2n(n2i(note)+semis); }
function parseRoot(sym){
  // pega raiz: A, A#, Bb etc (1 ou 2 chars)
  const m = sym.match(/^([A-G](?:#|b)?)/);
  return m ? m[1].replace('Bb','A#').replace('Db','C#').replace('Eb','D#').replace('Gb','F#').replace('Ab','G#') : null;
}
function normalizeSymbol(symRaw){
  // normaliza variações: 7M, º, +, sus4, add9...
  let s = symRaw.replace(/\s+/g,'');
  s = s.replace(/°|º/g,'dim');
  s = s.replace(/maj7|7M/gi,'maj7');
  s = s.replace(/\+/g,'aug');
  // algumas cifras usam x/y com baixo; manteremos após split
  return s;
}
function chordIntervals(symbol){
  // define intervalos (em semitons relativos à raiz)
  // base: major triad; se "m" logo após raiz => minor
  const root = parseRoot(symbol);
  if(!root) return {root:null, set:new Set(), qual:""};
  const after = symbol.slice(root.length);
  // flags
  const isDim = /dim/.test(after);
  const isAug = /aug/.test(after);
  const isMin = /^m(?!aj)/.test(after); // "m" mas não "maj"
  // triads
  let triad;
  if(isDim) triad = [0,3,6];
  else if(isAug) triad = [0,4,8];
  else if(isMin) triad = [0,3,7];
  else triad = [0,4,7];
  // suspensões (sus4 ou "4" isolado tipo A4 → usamos como sus4)
  if(/sus4/.test(after) || /(^|[^0-9])4(?![0-9])/.test(after)){
    triad = [0,5,7]; // substitui a terça
  }
  // extensões/aditivos
  const add = new Set();
  if(/maj7/.test(after)) add.add(11);
  else if(/(^|[^a-zA-Z])7(?![0-9])/.test(after)) add.add(10); // 7ª menor
  if(/(^|[^0-9])6(?![0-9])/.test(after)) add.add(9);
  if(/\(.*9.*\)|(^|[^0-9])9(?![0-9])/.test(after)) add.add(2);
  if(/\(.*11.*\)|(^|[^0-9])11(?![0-9])/.test(after)) add.add(5);
  if(/\(.*13.*\)|(^|[^0-9])13(?![0-9])/.test(after)) add.add(9);
  // monta set final
  const set = new Set(triad.concat([...add]));
  return {root, set, qual:after};
}
function chordNotes(sym){
  const s = normalizeSymbol(sym);
  const [head, bassInv] = s.split('/');
  const {root, set} = chordIntervals(head);
  if(!root || set.size===0) return {root:null, notes:[], bass:null};
  const notes = [...set].map(semi => i2n((n2i(root)+semi)%12));
  // ANTES:
  // const bass = bassInv ? parseRoot(bassInv) : null;

  // DEPOIS: se não há inversão, baixo = tônica
  const bass = bassInv ? parseRoot(bassInv) : root;

  return {root, notes:[...new Set([root, ...notes.sort((a,b)=>n2i(a)-n2i(b))])], bass};
}

const MAJOR_PATTERN = [0,2,4,5,7,9,11];
const MINOR_PATTERN = [0,2,3,5,7,8,10];

function scaleNotesFromKey(tomRaw){
  if(!tomRaw) return [];
  // normaliza (ex.: "C#m", "A", "D", "Gm")
  const t = tomRaw.trim().replace('m','m'); // só pra garantir
  const root = parseRoot(t) || t;
  const isMinor = /m(?!aj)/i.test(t); // "m" mas não "maj"
  const pattern = isMinor ? MINOR_PATTERN : MAJOR_PATTERN;
  return pattern.map(semi => i2n((n2i(root)+semi)%12));
}



/* ===== Layout / Fretboard ===== */
const fbEl = document.getElementById('fretboard');
const legendEl = document.getElementById('legend');
const chordLabel = document.getElementById('chordLabel');
const selCapo  = document.getElementById('capoPos');
const chkStrings = document.getElementById('chkStrings');

function buildFretboard(qtFrets=12){
  fbEl.innerHTML = '<div class="nut"></div>';
  // grid rows: 1 por traste
  fbEl.style.gridTemplateRows = `repeat(${qtFrets}, var(--fretH))`;
  // criar linhas por traste (marcadores/inlays e separador)
  for(let f=1; f<=qtFrets; f++){
    const row = document.createElement('div');
    row.className = 'fretRow';
    row.dataset.fret = f;
    // frets x 6 strings (colunas)
    for(let s=0; s<6; s++){
      const cell = document.createElement('div');
      cell.className = 'string';
      fbEl.appendChild(cell);
    }
    // separador do traste
    const sep = document.createElement('div');
    sep.className = 'fretSep';
    sep.style.gridColumn = `1 / -1`;
    sep.style.gridRow = `${f} / ${f}`;
    fbEl.appendChild(sep);
    // inlays em 3,5,7,9,12,...
    const inlay = document.createElement('div');
    if([3,5,7,9,15,17,19].includes(f)) inlay.className='inlay';
    if(f===12 || f===24){ inlay.className='inlay double'; }
    if(inlay.className){
      inlay.style.gridColumn = `1 / -1`;
      inlay.style.gridRow = `${f} / ${f}`;
      fbEl.appendChild(inlay);
    }
    // num do traste
    const num = document.createElement('div');
    num.className='fretNum';
    num.textContent = f;
    num.style.gridColumn = `1 / -1`;
    num.style.gridRow = `${f} / ${f}`;
    fbEl.appendChild(num);
  }
}




fbEl.addEventListener('click', (e)=>{
  // só reage se clicou no “fundo” (string) e não num marcador
  if (e.target && e.target.classList.contains('string')) {
    // coluna (1..6) ~> stringIdx (0..5)
    const rect = fbEl.getBoundingClientRect();
    const xRel = e.clientX - rect.left;
    const colW = rect.width / 6;
    let col = Math.floor(xRel / colW); // 0..5
    col = Math.min(5, Math.max(0, col));
    // toca corda solta
    playGuitarPluck(col, 0);
  }
});







function noteAt(stringIdx, fret){
  const open = OPEN_STRINGS[stringIdx];
  return i2n(n2i(open) + capo + fret); // <-- soma o capo
}



function clearMarkers(){
  legendEl.innerHTML = '';
  chordLabel.textContent = '—';
  renderAll([], null); // desenha somente a escala (via currentScale)
}




function placeMarker({stringIdx, fret, label, cls}){
  const marker = document.createElement('div');
  marker.className = `marker ${cls}`;
  marker.textContent = label.replace('#','♯');

  // metadados pra áudio e debug
  marker.dataset.string = String(stringIdx);
  marker.dataset.fret   = String(fret);
  marker.dataset.note   = label;

  // posicionamento
  const cellCol = stringIdx+1;
  const fretH = parseFloat(getComputedStyle(fbEl).getPropertyValue('--fretH'));
  const nutH  = parseFloat(getComputedStyle(fbEl).getPropertyValue('--nutH'));
  let topPx;
  if(fret===0){
    topPx = nutH / 2; // corda solta
  }else{
    topPx = (fret-0.5)*fretH + nutH;
  }
  marker.style.left = `calc(${(cellCol-0.5)/6*100}% )`;
  marker.style.top  = `${topPx}px`;

  // >>> SOM AO CLICAR NO MARCADOR <<<
  marker.addEventListener('click', (e)=>{
    // evita que um clique selecione texto por acidente
    e.preventDefault();
    e.stopPropagation();
    playGuitarPluck(stringIdx, fret);
  });

  fbEl.appendChild(marker);
}



function renderAll(chordNotesArr = [], bassNote = null){
  fbEl.querySelectorAll('.marker').forEach(m=>m.remove());

  const qtFrets = TOTAL_FRETS; // fixo 15
  for (let s = 0; s < 6; s++){
    for (let f = 0; f <= qtFrets; f++){
      // <<< REMOVIDO: if (capo > 0 && f === 0) continue;

      const n = noteAt(s, f); // já soma o capo dentro de noteAt
      const inScale = currentScale.includes(n);
      const inChord = chordNotesArr.includes(n);
      const isBass  = (bassNote && n === bassNote);

      if (inScale || inChord || isBass){
        const cls = [
          inScale ? 'is-scale' : '',
          inChord ? 'is-chord' : '',
          isBass  ? 'is-bass'  : ''
        ].filter(Boolean).join(' ');

        placeMarker({ stringIdx: s, fret: f, label: n, cls });
      }
    }
  }
}










</script>


<script>
// ===== ÁUDIO: STRINGS (violinos) — timbre suave, headroom e anti-clip =====
window.audioCtx = window.audioCtx || new (window.AudioContext || window.webkitAudioContext)();
const AC = window.audioCtx || new AudioCtx();
window.audioCtx = AC;
const audioCtx = AC; // <- para este bloco usar SEMPRE o mesmo contexto já criado

// KNOBS (ajuste fino)
let STR_ATTACK  = 0.35; // s  — ataque mais macio
let STR_SUSTAIN = 10.0; // s  — sustenta o acorde
let STR_RELEASE = 4.00; // s  — cauda ao trocar/soltar

// --- Master bus: compressor + soft-clip + EQ (de-aresta) ---
function makeSoftClipCurve(k = 0.6){
  const n = 65536, curve = new Float32Array(n);
  for (let i = 0; i < n; i++){
    const x = i/(n-1)*2 - 1;              // [-1, 1]
    curve[i] = (1+k)*x / (1 + k*Math.abs(x)); // soft clip contínuo
  }
  return curve;
}



// --- SUBSTITUIR APENAS ESTE BLOCO STR_BUS ---

const STR_BUS = (() => {
  const input = audioCtx.createGain(); input.gain.value = 0.9;

  // Compressor -> SoftClip -> HighShelf -> LowPass (tilt)
  const comp = audioCtx.createDynamicsCompressor();
  comp.threshold.value = -26;
  comp.knee.value      = 18;
  comp.ratio.value     = 3.5;
  comp.attack.value    = 0.003;
  comp.release.value   = 0.25;

  const shaper = audioCtx.createWaveShaper();
  // usa sua makeSoftClipCurve(k) se existir; senão, cria curva inline
  shaper.curve = (typeof makeSoftClipCurve === 'function')
    ? makeSoftClipCurve(0.6)
    : (() => {
        const n = 65536, k = 0.6, c = new Float32Array(n);
        for (let i=0;i<n;i++){const x=i/(n-1)*2-1; c[i]=(1+k)*x/(1+k*Math.abs(x));}
        return c;
      })();
  shaper.oversample = '4x';

  const highShelf = audioCtx.createBiquadFilter();
  highShelf.type = 'highshelf';
  highShelf.frequency.value = 3600;
  highShelf.gain.value = -6;

  const tiltLP = audioCtx.createBiquadFilter();
  tiltLP.type = 'lowpass';
  tiltLP.frequency.value = 1800;
  tiltLP.Q.value = 0.5;

  // ===== CHORUS ESTÉREO (L/R com LFOs independentes) =====
  const chorusIn   = audioCtx.createGain();
  const splitter   = audioCtx.createChannelSplitter(2);
  const delayL     = audioCtx.createDelay(); delayL.delayTime.value = 0.018; // ~18ms
  const delayR     = audioCtx.createDelay(); delayR.delayTime.value = 0.021; // ~21ms
  const lfoL       = audioCtx.createOscillator(); lfoL.type='sine'; lfoL.frequency.value = 0.8;
  const lfoR       = audioCtx.createOscillator(); lfoR.type='sine'; lfoR.frequency.value = 0.9;
  const lfoGainL   = audioCtx.createGain(); lfoGainL.gain.value = 0.007;    // ~7ms
  const lfoGainR   = audioCtx.createGain(); lfoGainR.gain.value = 0.007;
  lfoL.connect(lfoGainL); lfoGainL.connect(delayL.delayTime);
  lfoR.connect(lfoGainR); lfoGainR.connect(delayR.delayTime);

  const panL = audioCtx.createStereoPanner(); panL.pan.value = -0.75;
  const panR = audioCtx.createStereoPanner(); panR.pan.value =  +0.75;
  const merger = audioCtx.createChannelMerger(2);

  const chorusWet = audioCtx.createGain(); chorusWet.gain.value = 0.22; // mix do chorus
  const chorusDryTap = audioCtx.createGain(); chorusDryTap.gain.value = 1.0;

  // ===== REVERB (Convolver com IR gerada em tempo real) =====
  const revSend  = audioCtx.createGain(); revSend.gain.value = 0.18; // wet send
  const convolver = audioCtx.createConvolver(); convolver.normalize = true;
  const revOut   = audioCtx.createGain(); revOut.gain.value = 0.75;

  function makeImpulse(seconds=1.2, decay=0.8){
    const rate = audioCtx.sampleRate;
    const len = Math.max(1, Math.floor(seconds * rate));
    const buf = audioCtx.createBuffer(2, len, rate);
    for (let ch=0; ch<2; ch++){
      const data = buf.getChannelData(ch);
      let rnd = Math.random()*2-1;
      for (let i=0; i<len; i++){
        // leve suavização do ruído + decaimento exponencial
        const t = i/len;
        const env = Math.pow(1 - t, 3*decay);
        // simples "pink-ish" noise: média móvel rápida
        const white = Math.random()*2-1;
        rnd = 0.5*rnd + 0.5*white;
        data[i] = rnd * env;
      }
    }
    return buf;
  }
  convolver.buffer = makeImpulse(1.2, 0.8);

  // ===== SAÍDA =====
  const out = audioCtx.createGain(); out.gain.value = 0.9;

  // --- Patch principal ---
  input.connect(comp);
  comp.connect(shaper);
  shaper.connect(highShelf);
  highShelf.connect(tiltLP);

  // split para chorus
  tiltLP.connect(chorusIn);
  tiltLP.connect(chorusDryTap);

  chorusIn.connect(splitter);
  splitter.connect(delayL, 0);
  splitter.connect(delayR, 1);
  delayL.connect(panL); delayR.connect(panR);
  panL.connect(merger, 0, 0);
  panR.connect(merger, 0, 1);
  merger.connect(chorusWet);

  // mix pré-reverb (dry + chorus)
  const preOut = audioCtx.createGain();
  chorusDryTap.connect(preOut);
  chorusWet.connect(preOut);

  // send para reverb
  preOut.connect(revSend);
  revSend.connect(convolver);
  convolver.connect(revOut);

  // mix final: direto + reverb
  preOut.connect(out);
  revOut.connect(out);
  out.connect(audioCtx.destination);

  // liga LFOs do chorus
  //lfoL.start(); lfoR.start();

// liga LFOs do chorus somente após gesto do usuário (evita autoplay block)
let _lfoArmed = false;
function armLFOs() {
  if (_lfoArmed) return;
  _lfoArmed = true;
  if (audioCtx.state === 'suspended') audioCtx.resume();
  try { lfoL.start(); lfoR.start(); } catch(e) {}
}
// 1) qualquer toque/clique
document.addEventListener('pointerdown', armLFOs, { once: true });
// 2) garantia extra: quando tocar acorde
window.armLFOs = armLFOs; // expõe p/ usar em playChord se quiser




  // ===== API =====
  function setBrightnessHz(hz){ tiltLP.frequency.value = hz; } // mais brilho ≤→ maior Hz
  function setAirDb(db){ highShelf.gain.value = db; }          // -dB = menos aresta

  function setChorus({enabled=true, rateHz=0.8, depthMs=7, wet=0.22, width=0.75} = {}){
    lfoL.frequency.value = rateHz;
    lfoR.frequency.value = rateHz * 1.07;
    lfoGainL.gain.value  = Math.max(0, depthMs)/1000;
    lfoGainR.gain.value  = Math.max(0, depthMs)/1000;
    panL.pan.value = -Math.abs(width);
    panR.pan.value =  Math.abs(width);
    chorusWet.gain.value = enabled ? wet : 0.0;
  }

  function setReverb({enabled=true, seconds=1.2, decay=0.8, wet=0.18} = {}){
    // atualiza IR se o tamanho mudou significativamente
    if (!convolver.buffer || Math.abs(convolver.buffer.duration - seconds) > 0.08){
      convolver.buffer = makeImpulse(seconds, decay);
    }
    revSend.gain.value = enabled ? wet : 0.0;   // envia mais/menos pro reverb
    revOut.gain.value  = enabled ? 0.75 : 0.0;  // saída do reverb
  }

  // Defaults agradáveis
  setChorus({enabled:true, rateHz:0.8, depthMs:7,  wet:0.22, width:0.75});
  setReverb({enabled:true, seconds:1.2, decay:0.8, wet:0.18});

const bus = { input, setBrightnessHz, setAirDb, setChorus, setReverb };
window.STR_BUS = bus;  // <-- ADICIONE ESTA LINHA
return bus;
})();

// --- FIM DO BLOCO STR_BUS ---



// Guarda o ganho base do bus na primeira vez
window.BUS_BASE_GAIN = window.BUS_BASE_GAIN ?? (window.STR_BUS?.input?.gain?.value || 0.9);

// Define volume de performance com rampa (segundos)
function setPerformanceVol(f=1, rampSec=0.75){
  try{
    const base = window.BUS_BASE_GAIN || 0.9;
    const AC   = window.audioCtx || new (window.AudioContext||window.webkitAudioContext)();
    const g    = STR_BUS.input.gain;
    const now  = AC.currentTime;
    
    // Force current value to avoid glitches
    const targetVol = base * f;
    
    // Cancel any existing automations
    g.cancelScheduledValues(now);
    
    // Set immediate value and ramp to target
    g.setValueAtTime(g.value, now);
    g.exponentialRampToValueAtTime(Math.max(0.001, targetVol), now + Math.max(0.01, rampSec));
    
    console.log(`Volume ajustado de ${g.value.toFixed(3)} para ${targetVol.toFixed(3)} em ${rampSec}s`);
  }catch(e){ 
    console.warn('setPerformanceVol falhou:', e); 
  }
}










function midiToFreq(m){ return 440 * Math.pow(2, (m - 69) / 12); }

// Pitch-class -> MIDI numa região musical (preferência central)
function findMidiForPC(pc, min=48, max=76, prefer=57){
  let m = prefer - ((prefer % 12 - pc + 12) % 12);
  while (m < min) m += 12;
  while (m > max) m -= 12;
  return m;
}

// Voz de "strings": 2 serras desafinadas de leve + vibrato + LP mais fechado
function makeStringVoice(freq, t0, voiceGain=0.4){
  const osc1 = AC.createOscillator();
  const osc2 = AC.createOscillator();
  osc1.type = 'sawtooth'; osc2.type = 'sawtooth';
  osc1.frequency.setValueAtTime(freq, t0);
  osc2.frequency.setValueAtTime(freq, t0);
  osc2.detune.setValueAtTime(6, t0); // ~6 cents

  // vibrato leve
  const lfo = AC.createOscillator(); lfo.type = 'sine';
  lfo.frequency.setValueAtTime(5.5, t0);
  const lfoGain = AC.createGain();
  lfoGain.gain.setValueAtTime(freq * 0.003, t0);
  lfo.connect(lfoGain);
  lfoGain.connect(osc1.frequency);
  lfoGain.connect(osc2.frequency);

  // mix e filtro para reduzir aspereza das serras
  const mix = AC.createGain(); mix.gain.setValueAtTime(voiceGain, t0);
  const lp  = AC.createBiquadFilter(); lp.type='lowpass';
  lp.frequency.setValueAtTime(1600, t0); // mais fechado que antes
  lp.Q.value = 0.3;

  // envelope (ataque macio + sustain longo)
  const amp = AC.createGain();
  const a = window.STR_ATTACK || 0.40;
  const s = STR_SUSTAIN;
  const r = window.STR_RELEASE || 4.0;
  const sustainLvl = 0.65; // menos sustentação para headroom

  amp.gain.setValueAtTime(0.0001, t0);
  amp.gain.linearRampToValueAtTime(0.80,  t0 + a);      // ataque
  amp.gain.setValueAtTime(sustainLvl,     t0 + a);      // sustain fixo
  amp.gain.setValueAtTime(sustainLvl,     t0 + a + s);  // manter 10s
  amp.gain.exponentialRampToValueAtTime(0.0001, t0 + a + s + r); // release

  // cadeia
  osc1.connect(mix); osc2.connect(mix);
  mix.connect(lp); lp.connect(amp);
  amp.connect(STR_BUS.input); // <<< envia para o master bus

  osc1.start(t0); osc2.start(t0); lfo.start(t0);

  // parada antecipada (quando troca de acorde)
  const stop = (releaseOverride=0.25)=>{
    const now = AC.currentTime;
    amp.gain.cancelScheduledValues(now);
    amp.gain.setValueAtTime(Math.max(amp.gain.value, 0.0001), now);
    amp.gain.exponentialRampToValueAtTime(0.0001, now + releaseOverride);
    const off = releaseOverride + 0.05;
    osc1.stop(now + off); osc2.stop(now + off); lfo.stop(now + off);
  };
  return { stop };
}







function makeVoiceSound(freq, t0, voiceGain = 0.4){
  const osc = audioCtx.createOscillator();
  osc.type = 'triangle';
  osc.frequency.setValueAtTime(freq, t0);
  
  // 3 filtros para simular formantes da voz "AHHH"
  const f1 = audioCtx.createBiquadFilter();
  f1.type = 'bandpass'; f1.frequency.value = 450; f1.Q.value = 3;
  
  const f2 = audioCtx.createBiquadFilter();
  f2.type = 'bandpass'; f2.frequency.value = 750; f2.Q.value = 2;
  
  const f3 = audioCtx.createBiquadFilter();
  f3.type = 'bandpass'; f3.frequency.value = 1200; f3.Q.value = 1.5;
  
  const mix = audioCtx.createGain(); mix.gain.value = voiceGain;
  const smoother = audioCtx.createBiquadFilter();
  smoother.type = 'lowpass';
  smoother.frequency.value = 900;
  smoother.Q.value = 0.5;
  
  const amp = audioCtx.createGain();
  
  // envelope igual ao strings
  const a = window.STR_ATTACK || 0.40;
  const s = STR_SUSTAIN;
  const r = window.STR_RELEASE || 4.0;
  const sustainLvl = 0.65;
  
  amp.gain.setValueAtTime(0.0001, t0);
  amp.gain.linearRampToValueAtTime(0.80, t0 + a);
  amp.gain.setValueAtTime(sustainLvl, t0 + a);
  amp.gain.setValueAtTime(sustainLvl, t0 + a + s);
  amp.gain.exponentialRampToValueAtTime(0.0001, t0 + a + s + r);
  
  // conecta: osc -> 3 filtros paralelos -> mix -> envelope -> STR_BUS
  osc.connect(f1); osc.connect(f2); osc.connect(f3);
  f1.connect(mix); f2.connect(mix); f3.connect(mix);
  mix.connect(smoother);
  smoother.connect(amp);
  amp.connect(STR_BUS.input);
  
  osc.start(t0);
  
  const stop = (releaseOverride = 0.25) => {
    const now = audioCtx.currentTime;
    amp.gain.cancelScheduledValues(now);
    amp.gain.setValueAtTime(Math.max(amp.gain.value, 0.0001), now);
    amp.gain.exponentialRampToValueAtTime(0.0001, now + releaseOverride);
    osc.stop(now + releaseOverride + 0.05);
  };
  
  return { stop };
}













let stopCurrentChord = null;



// Converte {root, notes, bass} -> MIDIs num voicing musical
// Agora com opção de duplicar a tônica 1 oitava abaixo (default: true)
function chooseChordMIDIs(root, notes, bass, { doubleRootLow = true } = {}) {
  const pc = (n) => NOTES.indexOf(n);
  const rootPC = pc(root);

  // intervalos do acorde a partir da tônica (0 = tônica)
  const uniq = [...new Set(notes)];
  const ints = uniq
    .map(n => (pc(n) - rootPC + 12) % 12)
    .sort((a, b) => a - b);

  // tônica “média” (zona de 52..64 MIDI, pivô ~57) como âncora do voicing
  const mRoot = findMidiForPC(rootPC, 52, 64, 57);
  const mids = [mRoot];

  // (novo) tônica 1 oitava abaixo em região grave 36..52 (pivô ~45)
  let mRootLow = null;
  if (doubleRootLow) {
    mRootLow = findMidiForPC(rootPC, 36, 52, 45);
  }

  // demais notas do acorde, evitando colisão e mantendo em tessitura musical
  for (const semi of ints.filter(x => x !== 0)) {
    let m = mRoot + semi;
    if (m > 76) m -= 12;
    if (m < 48) m += 12;
    if (mids.includes(m)) m += (m + 12 <= 80 ? 12 : -12);
    if (!mids.includes(m)) mids.push(m);
  }

  // nota de baixo (inversão), se houver
  let mBass = null;
  if (bass) {
    mBass = findMidiForPC(pc(bass), 36, 52, 45);
    if (!mids.includes(mBass)) mids.unshift(mBass);
  }

  // insere a tônica grave só se ainda não estiver presente (nem igual ao baixo)
  if (doubleRootLow && mRootLow != null) {
    if (!mids.includes(mRootLow) && mRootLow !== mBass) {
      mids.unshift(mRootLow);
    }
  }

  return mids;
}




// Toca acorde como strings: ataque suave + sustain 10s + ganho normalizado
function playChord(root, notes, bass, mode = 'strings'){
  if (audioCtx.state === 'suspended') audioCtx.resume();
  if (typeof stopCurrentChord === 'function') stopCurrentChord(0.12);
  
  const mids = chooseChordMIDIs(root, notes, bass);
  const t0 = audioCtx.currentTime + 0.01;
  const perVoice = 0.55 / Math.sqrt(Math.max(1, mids.length));
  
  let voices;
  if (mode === 'voice') {
    voices = mids.map((m, i) => makeVoiceSound(midiToFreq(m), t0 + i*0.012, perVoice));
  } else {
    voices = mids.map((m, i) => makeStringVoice(midiToFreq(m), t0 + i*0.012, perVoice));
  }
  
  stopCurrentChord = (rel = 0.25) => voices.forEach(v => v.stop(rel));
}



</script>





<script>



function highlightChord(symbol){
  chordLabel.textContent = symbol;
  legendEl.innerHTML = '';

  const {root, notes, bass} = chordNotes(symbol);
  if(!root) return;

  // legenda
  notes.forEach(n=>{
    const pill = document.createElement('span');
    pill.className='pill';
    pill.textContent = n;
    legendEl.appendChild(pill);
  });
  if(bass){
    const pill = document.createElement('span');
    pill.className='pill bass';
    pill.textContent = 'Baixo: ' + bass;
    legendEl.appendChild(pill);
  }

  // desenha escala (azul), acorde (verde) e baixo (anel laranja) em uma passada
  renderAll(notes, bass);
  
  // >>> NOVO: tocar strings se o checkbox estiver marcado
if (chkStrings && chkStrings.checked) {
  const select = document.querySelector('#knobs select');
  const mode = select ? select.value : 'strings';
  playChord(root, notes, bass, mode);
}
  
  
}



/* ===== Parse do XML e UI ===== */
function loadXML(){
  const raw = document.getElementById('musicas-xml')?.textContent?.trim() || '';
  if(!raw) return null;
  const parser = new DOMParser();
  const xml = parser.parseFromString(raw,'text/xml');
  return xml;
}
function getText(el, tag){
  const n = el.getElementsByTagName(tag)[0];
  if(n) return n.textContent.trim();
  return null;
}






function buildMenu(xml, category = currentCategory){
  const ul = document.getElementById('listaMusicas');
  ul.innerHTML = '';

  // MASTER: todas as músicas do XML
  const all = [...xml.getElementsByTagName('musica')];
  songsMaster = all;

  // FILTRO por categoria
  const filtered = all.filter(m => {
    const c = (getText(m,'categ') || '').trim();
    return (category === 'Todas') ? true : (c === category);
  });

	filtered.sort((a, b) => {
	  const A = (getText(a,'titulo') || getText(a,'itulo') || '').trim();
	  const B = (getText(b,'titulo') || getText(b,'itulo') || '').trim();
	  return A.localeCompare(B, 'pt-BR', { sensitivity: 'base' });
	});



  // Esta é a lista exibida no menu (apenas filtradas)
  songsList = filtered;

  // monta itens do menu
  filtered.forEach((m)=>{
    const titulo = getText(m,'titulo') || getText(m,'itulo') || 'Música';
    const li = document.createElement('li');
    li.textContent = titulo;

    // índice "GLOBAL" no vetor master (serve para playlist e navegação)
    const masterIdx = songsMaster.indexOf(m);
    li.dataset.mid = String(masterIdx);

    // Clique com Ctrl/⌘ => alterna na FILA GLOBAL (playlist)
    // Clique simples => abre a música
    li.addEventListener('click', (ev)=>{
      if (ev.ctrlKey || ev.metaKey){
        ev.preventDefault(); ev.stopPropagation();
        toggleQueue(masterIdx); // mantém fila global
        return;
      }
      document.querySelectorAll('#listaMusicas li').forEach(x=>x.classList.remove('active'));
      li.classList.add('active');

      setActiveSongIdx(masterIdx); // usa índice global
      showCifra(m);
      updatePlaylistUI();
    });

    ul.appendChild(li);
  });

  updatePlaylistUI();

  // Seleção inicial: se já havia música ativa e ela está no filtro, mantém.
  // Caso contrário, pega a 1ª do filtro, ou mostra mensagem.
  let startIdx = currentSongIdx;
  const liMatch = ul.querySelector(`li[data-mid="${startIdx}"]`);
  const startLi = liMatch || ul.firstChild;
  if (startLi) startLi.click();
  else {
    ul.innerHTML = '<li class="muted" style="padding:10px 12px">Sem músicas nesta categoria</li>';
  }
}





function buildCategoryUI(xml){
  const wrap = document.getElementById('escolheCategorias');
  if (!wrap) return;

  const cats = getAllCategories(xml);
  // inclui opção "Todas" no topo
  const options = ['Todas', ...cats];

  wrap.innerHTML = '';
  const label = document.createElement('label');
  label.textContent = 'Categoria: ';
  label.style.display = 'block';
  label.style.margin = '8px 12px';

  const sel = document.createElement('select');
  sel.id = 'selCategoria';
  sel.style.background = '#111827';
  sel.style.color = '#e5e7eb';
  sel.style.border = '1px solid #1f2937';
  sel.style.borderRadius = '8px';
  sel.style.padding = '6px 10px';

  options.forEach(c=>{
    const op = document.createElement('option');
    op.value = c;
    op.textContent = c;
    sel.appendChild(op);
  });

  // define a seleção inicial (Holiness, se existir; senão "Todas")
  if (cats.includes('Holiness')) currentCategory = 'Holiness';
  else currentCategory = 'Todas';
  sel.value = currentCategory;

  sel.addEventListener('change', ()=>{
    currentCategory = sel.value;
    const xml2 = loadXML();
    if (xml2) buildMenu(xml2, currentCategory);
  });

  label.appendChild(sel);
  wrap.appendChild(label);
}

function buildFontUI(){
  const wrap = document.getElementById('ajustaFonteTela');
  if (!wrap) return;

  // pega valor salvo ou default 45
  let saved = parseInt(localStorage.getItem('fontSizeLinha') || '45', 10);
  if (isNaN(saved)) saved = 45;

  wrap.innerHTML = '';
  const label = document.createElement('label');
  label.textContent = 'Fonte cifra: ';
  label.style.display = 'block';
  label.style.margin = '8px 12px';

  const sel = document.createElement('select');
  sel.id = 'selFontSize';
  sel.style.background = '#111827';
  sel.style.color = '#e5e7eb';
  sel.style.border = '1px solid #1f2937';
  sel.style.borderRadius = '8px';
  sel.style.padding = '6px 10px';

  for (let i = 15; i <= 75; i++){
    const op = document.createElement('option');
    op.value = i;
    op.textContent = i + ' px';
    sel.appendChild(op);
  }

  sel.value = saved; // seleciona o que estava salvo

  // aplica no CSS
  function apply(size){
    const css = document.querySelector('#dynamicFontSize') || (() => {
      const st = document.createElement('style');
      st.id = 'dynamicFontSize';
      document.head.appendChild(st);
      return st;
    })();
    css.textContent = `#cifraMeio .linha { font-size: ${size}px !important; }`;
  }
  apply(saved);

  sel.addEventListener('change', ()=>{
    const val = parseInt(sel.value, 10);
    localStorage.setItem('fontSizeLinha', val);
    apply(val);
  });

  label.appendChild(sel);
  wrap.appendChild(label);
}


</script>

<script>
// ===== Validação robusta de cifras =====

//AQUI IDENTIFICA AS CIFRAS PARA MONTAR O Acorde
//SEMPRE QUE NÃO LER ALGUM ACORDE, DEVE-SE AJUSTAR AQUI
// ===== SUBSTITUIR APENAS ESTE BLOCO =====
// ===== SUBSTITUIR APENAS ESTE BLOCO =====
// Aceita: D5(9), A9/C#, Em7(9), G5/F#, G7M, A4, Bm7(11), D7M/A, Ebº, E7(b9), A4(7/9), (6/9) etc.
const CHORD_TOKEN_RE = (() => {
  const ROOT = '(?:[A-G](?:#|b)?)'; // nota raiz A..G com #/b

  // Sufixos combináveis (zero ou mais), ex.: m, maj7, 4, 5, 7, 9, 11, 13...
  const SUF  = '(?:m|maj7|M7|7M|maj|dim7|dim|º7|º|°7|°|aug|\\+|sus2|sus4|add9|add11|add13|2|4|5|6|7|9|11|13)';

  // >>> Itens aceitos dentro (e fora) de parênteses:
  // inclui 6 e 7, além de 9/11/13 e alterações comuns
  const ALT_UNIT =
    '(?:'
    + 'b5|#5|5\\+|\\+5|5-|'
    + 'b6|#6|6|'            // 6
    + 'b7|#7|7|'            // 7
    + 'b9|#9|9\\+|\\+9|9-|' // 9 e variações
    + '#11|11\\+|\\+11|'    // 11 e variações
    + 'b13|13\\+|\\+13|13-' // 13 e variações
    + '|9|11|13'
    + ')';

  // Vários ALT_UNIT entre parênteses, separados por / ou , (ex.: (7/9), (9,11))
  const ALT_GROUP = `\\(\\s*${ALT_UNIT}(?:\\s*[/,]\\s*${ALT_UNIT})*\\s*\\)`;

  // Pode aparecer como grupo (...) ou como item solto (ex.: b9)
  const ALT = `(?:${ALT_GROUP}|${ALT_UNIT})*`;

  // Baixo /X opcional
  const BASS = `(?:/${ROOT})?`;

  // Permite qualquer combinação de SUF e ALT em qualquer ordem, depois o baixo
  return new RegExp(`^(?:N\\.C\\.|${ROOT}(?:${SUF}|${ALT})*${BASS})$`);
})();



// remove apenas colchetes externos e pontuação comum; **NÃO remove parênteses**
function isChordToken(tok){
  if (!tok) return false;
  let t = String(tok).trim();

  // Normaliza NBSP (caso venha de HTML)
  t = t.replace(/\u00A0/g, ' ');

  // Se o token veio embrulhado por [ ], tira só esses colchetes externos
  if (t.startsWith('[') && t.endsWith(']')) {
    t = t.slice(1, -1).trim();
  } else {
    // remove colchete isolado se sobrar na borda (sem tocar em parênteses)
    t = t.replace(/^\[/, '').replace(/\]$/, '');
  }

  // tira vírgulas/pontuação comuns nas bordas (sem mexer em parênteses)
  t = t.replace(/^[,.;:!?]+/, '').replace(/[,.;:!?]+$/, '');

  return CHORD_TOKEN_RE.test(t);
}

// Uma linha é "de acordes" se:
//  • todos os tokens forem acordes (ex.: "Em7(9)"), OU
//  • tiver ≥ 2 acordes E ≥ 50% dos tokens forem acordes.
function isChordLine(line){
  const norm = String(line).replace(/\u00A0/g, ' ').trim();
  const tokens = norm.split(/\s+/).filter(Boolean);
  if (!tokens.length) return false;
  const valid = tokens.filter(isChordToken).length;
  if (!valid) return false;
  if (valid === tokens.length) return true;        // 100% acordes (mesmo 1 só)
  return valid >= 2 && (valid / tokens.length) >= 0.5;
}

function wrapChords(text, semis = 0){
  return String(text)
    .replace(/\u00A0/g, ' ')
    .replace(/\r\n?/g,'\n')
    .split('\n')
    .map(line=>{
      // 1) Acordes entre [colchetes]
      let processed = line.replace(/\[([^\]]+)\]/g, (m, inside)=>{
        const sym = inside.trim();
        if (!isChordToken(sym)) return m;
        const disp = semis ? transposeSymbol(sym, semis) : sym;
        return `<span class="chord" data-chord="${disp}" data-chord-original="${sym}">${disp}</span>`;
      });

	// 1.5) Linha de dinâmica: somente traços (>=2) -> marcador de volume
	const only = String(processed).trim();
	if (/^-{2,}$/.test(only)){
	  const n = only.length;
// fator: 50% por traço acima/abaixo de '---' (n=3); clamp 0.25..3.0
const factor = Math.min(3.0, Math.max(0.25, 1 + 0.75*(n - 3)));
	  return `<span class="linha vol-marker" data-vol="${factor}">${only}</span>`;
	}



      // 2) Linha de letra: não marcar tokens soltos
      if (!isChordLine(line)){
        return `<span class="linha">${processed || '&nbsp;'}</span>`;
      }

      // 3) Linha de acordes: marcar somente tokens válidos (com transposição)
      const parts = processed.split(/(\s+)/);
      const marked = parts.map(p=>{
        const t = p.trim();
        if (!t) return p;
        if (!isChordToken(t)) return p;
        const disp = semis ? transposeSymbol(t, semis) : t;
        return p.replace(t, `<span class="chord" data-chord="${disp}" data-chord-original="${t}">${disp}</span>`);
      }).join('');

      return `<span class="linha">${marked || '&nbsp;'}</span>`;
    })
    .join('\n');
}



</script>

<script>



function showCifra(mEl){
  // lê dados
  const cifra  = getText(mEl,'cifra')  || '';
  const tom    = getText(mEl,'tom')    || '';
  const titulo = getText(mEl,'titulo') || getText(mEl,'itulo') || '';
  const pre    = document.getElementById('cifra');

  // guarda "contexto" da música atual
  currentSongTitle   = titulo;
  currentSongOrigKey = tom;

  // orig: raiz e modo (maior/menor)
  const origRoot = parseRoot(tom) || 'C';
  const isMinor  = /m(?!aj)/i.test(tom);

  // alvo: pega do map ou, se não houver, usa o próprio tom original (sem transpor)
  const selKeyEl = document.getElementById('selTransposeKey');
  const targetRoot = (transposeMap[currentSongTitle] || origRoot);

  // reflete no select (para quando troca de música)
  if (selKeyEl) selKeyEl.value = targetRoot;

  // semitons a aplicar na cifra
  const semis = semisBetween(origRoot, targetRoot);

  // escala do tom ALVO (mantendo modo)
  const displayKey = targetRoot + (isMinor ? 'm' : '');
  currentKey   = displayKey;
  currentScale = scaleNotesFromKey(displayKey);

  // escreve cifra (com acordes já transpostos) e cabeçalho do tom
  pre.innerHTML = `# ${titulo}${tom ? (' — Tom: ' + displayKey) : ''}\n\n` + wrapChords(cifra, semis);

  // limpa e pinta só a escala (azul)
  renderAll([], null);

  // coleta e zera seleção
  chordSpans = Array.from(pre.querySelectorAll('.chord'));
  chordIdx = -1;
  
  
  
// Atribui a cada acorde o volume vigente (último marcador acima dele)
let currentVol = 1;
pre.querySelectorAll('.linha, .chord, .vol-marker').forEach(el=>{
  if (el.classList.contains('vol-marker')){
    const v = parseFloat(el.dataset.vol);
    if (!Number.isNaN(v)) currentVol = v;
  }
  if (el.classList.contains('chord')){
    el.dataset.vol = String(currentVol);
  }
});

// ao carregar uma música nova, volta para volume normal antes do 1º acorde
if (typeof setPerformanceVol === 'function') setPerformanceVol(1, 0.01);

  
  
  
  
  
//DEPOIS — tenta por referência; se falhar, localiza pelo título
let idx = songsMaster.indexOf(mEl);
if (idx === -1) {
  const tit = getText(mEl,'titulo') || getText(mEl,'itulo') || '';
  idx = songsMaster.findIndex(x => (getText(x,'titulo') || getText(x,'itulo') || '') === tit);
}
if (idx !== -1) setActiveSongIdx(idx);



  // cliques → seleção/navegação unificada
  pre.querySelectorAll('.chord').forEach((s, i)=>{
    s.addEventListener('click', (ev)=>{
      ev.preventDefault(); ev.stopPropagation();
      setActiveChord(i);
    });
  });
}



/* ===== Eventos ===== */
selCapo.addEventListener('change', ()=>{
  capo = parseInt(selCapo.value, 10) || 0;
  buildFretboard(TOTAL_FRETS);
  //drawCapo();

  const currentSym = chordLabel.textContent && chordLabel.textContent !== '—'
    ? chordLabel.textContent
    : null;

  if(currentSym){
    const {notes, bass} = chordNotes(currentSym);
    renderAll(notes, bass);
  } else {
    renderAll([], null);
  }
});



/*
//HANDLER SIMPLES DE AVANÇAR E RETROCEDER
// ===== Teclado: ←/↓/PageDown = próximo | →/↑/PageUp = anterior
document.addEventListener('keydown', (e)=>{
  if (e.altKey || e.ctrlKey || e.metaKey) return; // ignora atalhos do SO
  if (NEXT_KEYS.includes(e.key)){
    e.preventDefault();
    gotoNextChord();
  } else if (PREV_KEYS.includes(e.key)){
    e.preventDefault();
    gotoPrevChord();
  }
});

*/



const selTransposeKey = document.getElementById('selTransposeKey');
if (selTransposeKey){
  selTransposeKey.addEventListener('change', ()=>{
    if (!currentSongTitle) return;
    const newTarget = selTransposeKey.value; // ex.: "C", "F#", ...
    transposeMap[currentSongTitle] = newTarget;
    saveTransposeMap();
    // re-render da música atual com o novo tom
    // encontra <musica> atual pelo título (ou reaproveite o elemento corrente, se você guardar)
    const xml = loadXML();
    if (!xml) return;
    const all = [...xml.getElementsByTagName('musica')];
    const mEl = all.find(m => (getText(m,'titulo') || getText(m,'itulo') || '') === currentSongTitle) || all[0];
    if (mEl) showCifra(mEl);
  });
}


/* === Atalhos F/M para mostrar/ocultar painéis laterais (cifraMeio fica) === */
(function enablePanelHotkeys(){
  const geral = document.getElementById('geral');

  document.addEventListener('keydown', (e)=>{
    if (e.altKey || e.ctrlKey || e.metaKey) return;
    const tag = (e.target && e.target.tagName || '').toLowerCase();
    if (tag === 'input' || tag === 'select' || tag === 'textarea' || e.isComposing) return;

    const k = e.key;
    if (k === 'm' || k === 'M'){
      e.preventDefault();
      geral.classList.toggle('hide-left');   // só alterna o painel ESQUERDO
    } else if (k === 'f' || k === 'F'){
      e.preventDefault();
      geral.classList.toggle('hide-right');  // só alterna o painel DIREITO
    }
  });
})();


// ===== Mobile: hambúrguer + overlay + gesto lateral =====
(function mobileMenu(){
  const geral   = document.getElementById('geral');
  const overlay = document.getElementById('mobileOverlay') || (()=> {
    const o = document.createElement('div');
    o.className = 'mobile-overlay'; o.id = 'mobileOverlay';
    document.body.appendChild(o);
    return o;
  })();

  // cria botão hambúrguer
  let btn = document.getElementById('menuToggleBtn');
  if (!btn){
    btn = document.createElement('button');
    btn.id = 'menuToggleBtn';
    btn.type = 'button';
    btn.setAttribute('aria-label', 'Alternar menu');
    btn.textContent = '☰';
    document.body.appendChild(btn);
  }

  function isMobile(){ return window.matchMedia('(max-width: 900px)').matches; }
  function ensureHiddenOnMobile(){
    if (isMobile()) geral.classList.add('hide-left'); // padrão: fechado
  }

  // abre/fecha
  function toggleMenu(){ geral.classList.toggle('hide-left'); }
  function closeMenu(){ geral.classList.add('hide-left'); }

  // eventos
  btn.addEventListener('click', toggleMenu);
  overlay.addEventListener('click', closeMenu);

  // gesto: swipe da borda esquerda para abrir
  let x0 = null, y0 = null;
  window.addEventListener('touchstart', (e)=>{
    if (!isMobile()) return;
    const t = e.touches[0];
    x0 = t.clientX; y0 = t.clientY;
  }, {passive:true});

  window.addEventListener('touchmove', (e)=>{
    if (!isMobile() || x0 === null) return;
    const t = e.touches[0];
    const dx = t.clientX - x0, dy = Math.abs(t.clientY - y0);
    // gesto horizontal saindo da borda (<=24px) e movendo > 40px →
    if (x0 <= 24 && dx > 40 && dy < 30){
      geral.classList.remove('hide-left'); // abrir
      x0 = null; // consome o gesto
    }
  }, {passive:true});

  // fecha com "voltar" do Android (histórico) quando aberto
  window.addEventListener('popstate', ()=>{
    if (isMobile() && !geral.classList.contains('hide-left')){
      closeMenu();
      history.pushState(null, ''); // reequilibra histórico
    }
  });

  // ao abrir o menu, empilha um state para permitir fechar com “voltar”
  const obs = new MutationObserver(()=>{
    if (isMobile()){
      const aberto = !geral.classList.contains('hide-left');
      if (aberto) history.pushState(null, '');
    }
  });
  obs.observe(geral, { attributes:true, attributeFilter:['class'] });

  // garante estado inicial correto no carregamento e em resize
  ensureHiddenOnMobile();
  window.addEventListener('resize', ensureHiddenOnMobile);
})();



/* ===== Start ===== */
(function init(){
  buildFretboard(TOTAL_FRETS);
  const xml = loadXML();
  if(!xml){ document.getElementById('listaMusicas').innerHTML = '<li class="muted">Erro ao ler XML</li>'; return; }
  buildCategoryUI(xml);
  buildMenu(xml, currentCategory);
  buildFontUI();
  // buildKnobsUI(); <-- REMOVA esta linha daqui
})();







function drawCapo(){
  // remove anterior
  const old = fbEl.querySelector('.capo');
  if (old) old.remove();
  if (!capo || capo < 1) return;

  const el = document.createElement('div');
  el.className = 'capo';

  const fretH = parseFloat(getComputedStyle(fbEl).getPropertyValue('--fretH'));
  const nutH  = parseFloat(getComputedStyle(fbEl).getPropertyValue('--nutH'));
  // posiciona no “meio” da casa do capo
  const topPx = nutH + (capo - 0.5) * fretH - 5; // 5 = metade da altura (10px)
  el.style.top = `${topPx}px`;

  fbEl.appendChild(el);
}



</script>






<script>


// Apply presets ONLY if there is no saved knob state yet
const _hasKnobState = !!localStorage.getItem('fs_knobs_v1');
if (!_hasKnobState && window.STR_BUS) {
  // Chorus mais sutil
  window.STR_BUS.setChorus({ wet: 0.16, rateHz: 0.7, depthMs: 5, width: 0.6 });
  // Reverb um pouco maior e mais seco
  window.STR_BUS.setReverb({ seconds: 1.4, decay: 0.75, wet: 0.16 });
  // (Mais aveludado geral)
  window.STR_BUS.setBrightnessHz(1500); // corta agudos agressivos
  window.STR_BUS.setAirDb(-8);          // reduz ainda mais o high-shelf
}






// === ÁUDIO (Web Audio) ===
// Reusa/Cria UM único AudioContext global sem redeclarar 'AudioCtx'
//const audioCtx = window.audioCtx || new (window.AudioContext || window.webkitAudioContext)();
//window.audioCtx = audioCtx;


// MIDI das cordas soltas: E2 A2 D3 G3 B3 E4
const OPEN_STRING_MIDI = [40, 45, 50, 55, 59, 64];

function midiFromStringFret(stringIdx, fret){
  return OPEN_STRING_MIDI[stringIdx] + capo + fret;
}

function freqFromMidi(m){
  return 440 * Math.pow(2, (m - 69) / 12);
}

// Pluck simples (oscilador + envelope + lowpass)
function playGuitarPluck(stringIdx, fret){
  // Em alguns navegadores o áudio inicia suspenso até 1ª interação
  if (window.audioCtx.state === 'suspended') window.audioCtx.resume();

  const freq = freqFromMidi(midiFromStringFret(stringIdx, fret));
  const now = window.audioCtx.currentTime;

  const osc  = audioCtx.createOscillator();
  osc.type   = 'triangle';
  osc.frequency.setValueAtTime(freq, now);

  const lp   = audioCtx.createBiquadFilter();
  lp.type    = 'lowpass';
  lp.frequency.setValueAtTime(2000, now);

  const gain = audioCtx.createGain();
  // envelope: ataque curtíssimo, decaimento suave (estilo dedilhado)
  gain.gain.setValueAtTime(0.0001, now);
  gain.gain.exponentialRampToValueAtTime(0.8, now + 0.008);
  gain.gain.exponentialRampToValueAtTime(0.0001, now + 1.2);

  // encadeia e toca
  osc.connect(lp);
  lp.connect(gain);
  gain.connect(window.audioCtx.destination);

  osc.start(now);
  osc.stop(now + 1.25);
}
</script>



<script>
//Knobs

// ===== KNOBS PERSISTENTES (Envelope, Chorus, Reverb, Timbre) =====
(function(){
  const STORE_KEY = 'fs_knobs_v1';

  // valores padrão (ajuste aqui se quiser outros defaults)
  const defaults = {
    // Envelope
    attack: (typeof window.STR_ATTACK === 'number' ? window.STR_ATTACK : 0.35),
    release: (typeof window.STR_RELEASE === 'number' ? window.STR_RELEASE : 4.0),

    // Chorus
    chorusWet: 0.35,
    chorusRate: 5.0,     // Hz
    chorusDepth: 8.0,    // ms
    chorusWidth: 0.9,    // 0..1

    // Reverb
    reverbWet: 0.25,
    reverbSeconds: 2.2,  // tamanho
    reverbDecay: 0.6,

    // Timbre
    brightHz: 1800,      // low-pass tilt
    airDb: -6,            // high-shelf
	
	timbreMode: 'strings'
	
  };

  function loadState(){
    try {
      const raw = localStorage.getItem(STORE_KEY);
      return raw ? {...defaults, ...JSON.parse(raw)} : {...defaults};
    } catch(_){ return {...defaults}; }
  }
  function saveState(s){ localStorage.setItem(STORE_KEY, JSON.stringify(s)); }

  // Aplicadores (chamam seus setters/variáveis)
  function applyEnvelope(s){
    try { window.STR_ATTACK = s.attack; } catch(e){ console.warn('STR_ATTACK não pode ser alterado (const?)'); }
    try { window.STR_RELEASE = s.release; } catch(e){ console.warn('STR_RELEASE não pode ser alterado (const?)'); }
  }
  function applyChorus(s){
    if (window.STR_BUS && typeof window.STR_BUS.setChorus === 'function'){
      window.STR_BUS.setChorus({
        enabled: true,
        rateHz: s.chorusRate,
        depthMs: s.chorusDepth,
        width: s.chorusWidth,
        wet: s.chorusWet
      });
    }
  }
  function applyReverb(s){
    if (window.STR_BUS && typeof window.STR_BUS.setReverb === 'function'){
      window.STR_BUS.setReverb({
        enabled: true,
        seconds: s.reverbSeconds,
        decay: s.reverbDecay,
        wet: s.reverbWet
      });
    }
  }
  
function applyTimbre(s){
  if (window.STR_BUS && typeof window.STR_BUS.setBrightnessHz === 'function') {
    window.STR_BUS.setBrightnessHz(s.brightHz);
  }
  if (window.STR_BUS && typeof window.STR_BUS.setAirDb === 'function') {
    window.STR_BUS.setAirDb(s.airDb);
  }
}
  function applyAll(s){
    console.log('STR_BUS disponível?', !!window.STR_BUS);
    applyEnvelope(s);
    applyChorus(s);
    applyReverb(s);
    applyTimbre(s);
  }

  // fábrica de linha (slider + display digital)
  function addSlider(parent, {id, label, min, max, step, value, format, onInput}){
    const row = document.createElement('div'); row.className = 'knob-row';

    const left = document.createElement('div');
    const lab = document.createElement('label'); lab.htmlFor = id; lab.textContent = label;
    const rng = document.createElement('input');
    rng.type = 'range'; rng.id = id; rng.min = min; rng.max = max; rng.step = step; rng.value = value;

    left.appendChild(lab);
    left.appendChild(rng);

    const dsp = document.createElement('span'); dsp.className = 'digital';
    dsp.textContent = format(value);

    rng.addEventListener('input', ()=>{
      const v = parseFloat(rng.value);
      dsp.textContent = format(v);
      onInput(v);
    });

    row.appendChild(left);
    row.appendChild(dsp);
    parent.appendChild(row);
  }

  // cria um grupo visual
  function makeGroup(title){
    const g = document.createElement('div');
    g.className = 'knob-group';
    const h = document.createElement('h3'); h.textContent = title;
    g.appendChild(h);
    return g;
  }

  // === API pública
  window.buildKnobsUI = function buildKnobsUI(){
    const wrap = document.getElementById('knobs');
    if (!wrap) return;
    const state = loadState();
    wrap.innerHTML = '';

    // ------- ENVELOPE -------
    const gEnv = makeGroup('Envelope');
    addSlider(gEnv, {
      id:'k_attack', label:'Attack (s)', min:0.05, max:2.0, step:0.01, value:state.attack,
      format: v => v.toFixed(2), onInput: v => { console.log('Attack wet alterado para:', v);state.attack = v; saveState(state); applyEnvelope(state); }
    });
    addSlider(gEnv, {
      id:'k_release', label:'Release (s)', min:0.5, max:10, step:0.1, value:state.release,
      format: v => v.toFixed(1), onInput: v => { console.log('Release wet alterado para:', v);state.release = v; saveState(state); applyEnvelope(state); }
    });
    wrap.appendChild(gEnv);

    // ------- CHORUS -------
    const gCho = makeGroup('Chorus');
    addSlider(gCho, {
      id:'k_ch_wet', label:'Wet', min:0, max:1, step:0.01, value:state.chorusWet,
      format: v => v.toFixed(2), onInput: v => { console.log('Wet wet alterado para:', v);state.chorusWet = v; saveState(state); applyChorus(state); }
    });
    addSlider(gCho, {
      id:'k_ch_rate', label:'Rate (Hz)', min:0.1, max:8, step:0.1, value:state.chorusRate,
      format: v => v.toFixed(1), onInput: v => { console.log('Rate wet alterado para:', v);state.chorusRate = v; saveState(state); applyChorus(state); }
    });
    addSlider(gCho, {
      id:'k_ch_depth', label:'Depth (ms)', min:0, max:25, step:0.5, value:state.chorusDepth,
      format: v => v.toFixed(1), onInput: v => { console.log('Depth wet alterado para:', v);state.chorusDepth = v; saveState(state); applyChorus(state); }
    });
    addSlider(gCho, {
      id:'k_ch_width', label:'Width (0–1)', min:0, max:1, step:0.01, value:state.chorusWidth,
      format: v => v.toFixed(2), onInput: v => { console.log('Width wet alterado para:', v);state.chorusWidth = v; saveState(state); applyChorus(state); }
    });
    wrap.appendChild(gCho);

    // ------- REVERB -------
    const gRev = makeGroup('Reverb');
    addSlider(gRev, {
      id:'k_rv_wet', label:'Wet', min:0, max:1, step:0.01, value:state.reverbWet,
      format: v => v.toFixed(2), onInput: v => { state.reverbWet = v; saveState(state); applyReverb(state); }
    });
    addSlider(gRev, {
      id:'k_rv_seconds', label:'Seconds', min:0.3, max:6, step:0.1, value:state.reverbSeconds,
      format: v => v.toFixed(1), onInput: v => { state.reverbSeconds = v; saveState(state); applyReverb(state); }
    });
    addSlider(gRev, {
      id:'k_rv_decay', label:'Decay', min:0.1, max:1.5, step:0.05, value:state.reverbDecay,
      format: v => v.toFixed(2), onInput: v => { state.reverbDecay = v; saveState(state); applyReverb(state); }
    });
    wrap.appendChild(gRev);

    // ------- TIMBRE -------
    const gTim = makeGroup('Timbre');
    addSlider(gTim, {
      id:'k_br_hz', label:'Brilho (Hz)', min:800, max:6000, step:10, value:state.brightHz,
      format: v => Math.round(v)+' Hz', onInput: v => { state.brightHz = v; saveState(state); applyTimbre(state); }
    });
    addSlider(gTim, {
      id:'k_air_db', label:'Ar (dB)', min:-12, max:6, step:0.5, value:state.airDb,
      format: v => (v>0?'+':'')+v.toFixed(1)+' dB', onInput: v => { state.airDb = v; saveState(state); applyTimbre(state); }
    });
    wrap.appendChild(gTim);




// ------- SELETOR DE TIMBRE -------
const gSel = makeGroup('Som');
const selRow = document.createElement('div');
selRow.className = 'knob-row';

const selLabel = document.createElement('label');
selLabel.textContent = 'Timbre:';
const timbreSelect = document.createElement('select');
timbreSelect.innerHTML = `
  <option value="strings">Strings</option>
  <option value="voice">Voz Humana</option>
`;
timbreSelect.style.background = '#111827';
timbreSelect.style.color = '#e5e7eb';
timbreSelect.style.border = '1px solid #1f2937';
timbreSelect.style.borderRadius = '8px';
timbreSelect.style.padding = '6px 10px';

// Carrega valor salvo
timbreSelect.value = state.timbreMode || 'strings';

// Salva quando muda
timbreSelect.addEventListener('change', () => {
  state.timbreMode = timbreSelect.value;
  saveState(state);
});

selRow.appendChild(selLabel);
selRow.appendChild(timbreSelect);
gSel.appendChild(selRow);
wrap.appendChild(gSel);











// ------- RESET BUTTON -------
const resetDiv = document.createElement('div');
resetDiv.className = 'knob-row';
resetDiv.style.marginTop = '20px';
resetDiv.style.textAlign = 'center';

const resetBtn = document.createElement('button');
resetBtn.textContent = 'Reset para Padrão';
resetBtn.style.padding = '8px 16px';
resetBtn.style.backgroundColor = '#dc2626';
resetBtn.style.color = 'white';
resetBtn.style.border = 'none';
resetBtn.style.borderRadius = '6px';
resetBtn.style.cursor = 'pointer';
resetBtn.style.fontSize = '14px';

resetBtn.addEventListener('click', () => {
  // Confirma antes de resetar
  if (confirm('Resetar todos os knobs para valores padrão?')) {
    // Limpa localStorage
    localStorage.removeItem(STORE_KEY);
    
    // Reconstrói a interface com valores padrão
    buildKnobsUI();
    
    console.log('Knobs resetados para configuração padrão');
  }
});

resetDiv.appendChild(resetBtn);
wrap.appendChild(resetDiv);





    // aplica tudo ao carregar
    applyAll(state);
  };
})();

if (typeof buildKnobsUI === 'function') buildKnobsUI();

</script>



<script>

// ===== Mobile: hambÃºrguer + overlay + gesto lateral + BOTÃO DE NAVEGAÇÃO =====
(function mobileMenu(){
  const geral   = document.getElementById('geral');
  const overlay = document.getElementById('mobileOverlay') || (()=> {
    const o = document.createElement('div');
    o.className = 'mobile-overlay'; o.id = 'mobileOverlay';
    document.body.appendChild(o);
    return o;
  })();

  // cria botÃ£o hambÃºrguer
  let btn = document.getElementById('menuToggleBtn');
  if (!btn){
    btn = document.createElement('button');
    btn.id = 'menuToggleBtn';
    btn.type = 'button';
    btn.setAttribute('aria-label', 'Alternar menu');
    btn.textContent = 'â˜°';
    document.body.appendChild(btn);
  }

  function isMobile(){ return window.matchMedia('(max-width: 900px)').matches; }
  function ensureHiddenOnMobile(){
    if (isMobile()) geral.classList.add('hide-left'); // padrÃ£o: fechado
  }

  // abre/fecha
  function toggleMenu(){ geral.classList.toggle('hide-left'); }
  function closeMenu(){ geral.classList.add('hide-left'); }

  // eventos
  btn.addEventListener('click', toggleMenu);
  overlay.addEventListener('click', closeMenu);

  // gesto: swipe da borda esquerda para abrir
  let x0 = null, y0 = null;
  window.addEventListener('touchstart', (e)=>{
    if (!isMobile()) return;
    const t = e.touches[0];
    x0 = t.clientX; y0 = t.clientY;
  }, {passive:true});

  window.addEventListener('touchmove', (e)=>{
    if (!isMobile() || x0 === null) return;
    const t = e.touches[0];
    const dx = t.clientX - x0, dy = Math.abs(t.clientY - y0);
    // gesto horizontal saindo da borda (<=24px) e movendo > 40px â†'
    if (x0 <= 24 && dx > 40 && dy < 30){
      geral.classList.remove('hide-left'); // abrir
      x0 = null; // consome o gesto
    }
  }, {passive:true});

  // fecha com "voltar" do Android (histÃ³rico) quando aberto
  window.addEventListener('popstate', ()=>{
    if (isMobile() && !geral.classList.contains('hide-left')){
      closeMenu();
      history.pushState(null, ''); // reequilibra histÃ³rico
    }
  });

  // ao abrir o menu, empilha um state para permitir fechar com â€œvoltarâ€
  const obs = new MutationObserver(()=>{
    if (isMobile()){
      const aberto = !geral.classList.contains('hide-left');
      if (aberto) history.pushState(null, '');
    }
  });
  obs.observe(geral, { attributes:true, attributeFilter:['class'] });

  // === BOTÃO FLUTUANTE DE NAVEGAÇÃO ===
  let navBtn = document.getElementById('mobileNavBtn');
  
  // Controle do long-press (mesmo comportamento das teclas)
  let navHoldTimer = null;
  let navLongTriggered = false;
  
  function handleNavLongPress() {
    navHoldTimer = null;
    navLongTriggered = true;
    
    // Para o áudio atual
    try {
      if (typeof setPerformanceVol === 'function') setPerformanceVol(0.001, 0.2);
      window.dispatchEvent?.(new CustomEvent('pad:stop'));
    } catch (e) {}
    
    // Vai para primeiro acorde/primeira música (mesmo comportamento do long-press das teclas)
    const firstChord = (typeof window.chordIdx === 'number') ? window.chordIdx === 0 : false;
    const firstSong = (() => {
      if (!Array.isArray(window.playlist) || typeof window.currentSongIdx !== 'number') return false;
      const first = window.playlist[0];
      const firstIdx = (typeof first === 'number') ? first : (first && typeof first.idx === 'number') ? first.idx : null;
      return firstIdx != null && firstIdx === window.currentSongIdx;
    })();
    
    if (!firstChord) {
      try { setActiveChord?.(0); } catch(_){}
      showMobileHint('Voltou ao 1º acorde desta música');
    } else if (firstChord && !firstSong) {
      const ok = goToFirstSong();
      if (!ok) showMobileHint('Tentei ir para a 1ª música… ajuste sua fila');
      else showMobileHint('Foi ao 1º acorde da 1ª música');
    } else {
      showMobileHint('Já está no 1º acorde da 1ª música');
    }
  }
  
  function showMobileHint(msg){
    let el = document.getElementById('mobile-hint');
    if (!el){
      el = document.createElement('div');
      el.id = 'mobile-hint';
      Object.assign(el.style, {
        position:'fixed', bottom:'100px', left:'50%', transform:'translateX(-50%)',
        padding:'8px 12px', background:'rgba(0,0,0,.8)', color:'#fff',
        borderRadius:'10px', fontSize:'14px', zIndex:99999, pointerEvents:'none',
        transition:'opacity .25s', opacity:'0'
      });
      document.body.appendChild(el);
    }
    el.textContent = msg;
    el.style.opacity = '1';
    clearTimeout(el._t);
    el._t = setTimeout(()=>{ el.style.opacity='0'; }, 2000);
  }
  
  if (navBtn) {
    // Touch events para o botão de navegação
    navBtn.addEventListener('touchstart', (e) => {
      if (!isMobile()) return;
      e.preventDefault();
      
      navLongTriggered = false;
      if (navHoldTimer) clearTimeout(navHoldTimer);
      navHoldTimer = setTimeout(handleNavLongPress, 2000);
    }, {passive: false});
    
    navBtn.addEventListener('touchend', (e) => {
      if (!isMobile()) return;
      e.preventDefault();
      
      const hadTimer = !!navHoldTimer;
      if (navHoldTimer) { clearTimeout(navHoldTimer); navHoldTimer = null; }
      
      // Toque curto → avançar 1 acorde
      if (!navLongTriggered && hadTimer) {
        try { 
          gotoNextChord?.(); 
        } catch(err){ 
          console.warn('Avançar 1 acorde falhou:', err); 
        }
      }
    }, {passive: false});
    
    navBtn.addEventListener('touchcancel', (e) => {
      if (navHoldTimer) { clearTimeout(navHoldTimer); navHoldTimer = null; }
    });
  }

  // garante estado inicial correto no carregamento e em resize
  ensureHiddenOnMobile();
  window.addEventListener('resize', ensureHiddenOnMobile);
})();


</script>







</body>
</html>
